<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Разностные схемы для ОДУ колебаний">
<meta name="keywords" content="Разностная схема,Разностная производная,Разностная производная левая,Разностная производная  правая,Разностная производная вторая,Разностная производная центральная,ArgumentParser">

<title>Разностные схемы для ОДУ колебаний</title>


<link href="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_solarized_box/css/solarized_light_code.css" rel="stylesheet" type="text/css" title="light"/>
<script src="https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_styles/style_solarized_box/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<link href="http://thomasf.github.io/solarized-css/solarized-light.min.css" rel="stylesheet">
<style type="text/css">
h1 {color: #b58900;}  /* yellow */
/* h1 {color: #cb4b16;}  orange */
/* h1 {color: #d33682;}  magenta, the original choice of thomasf */
code { padding: 0px; background-color: inherit; }
pre {
  border: 0pt solid #93a1a1;
  box-shadow: none;
}
.alert-text-small   { font-size: 80%;  }
.alert-text-large   { font-size: 130%; }
.alert-text-normal  { font-size: 90%;  }
.alert {
  padding:8px 35px 8px 14px; margin-bottom:18px;
  text-shadow:0 1px 0 rgba(255,255,255,0.5);
  border:1px solid #93a1a1;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  color: #555;
  background-color: #eee8d5;
  background-position: 10px 5px;
  background-repeat: no-repeat;
  background-size: 38px;
  padding-left: 55px;
  width: 75%;
 }
.alert-block {padding-top:14px; padding-bottom:14px}
.alert-block > p, .alert-block > ul {margin-bottom:1em}
.alert li {margin-top: 1em}
.alert-block p+p {margin-top:5px}
.alert-notice { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_notice.png); }
.alert-summary  { background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_summary.png); }
.alert-warning { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_warning.png); }
.alert-question {background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_yellow_question.png); }

div { text-align: justify; text-justify: inter-word; }
</style>


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [('Содержание',
               1,
               'table_of_contents',
               'table_of_contents'),
              (u'\u041a\u043e\u043d\u0435\u0447\u043d\u043e-\u0440\u0430\u0437\u043d\u043e\u0441\u0442\u043d\u0430\u044f \u0434\u0438\u0441\u043a\u0440\u0435\u0442\u0438\u0437\u0430\u0446\u0438\u044f',
               1,
               u'fdm-for-ode:fdd',
               u'fdm-for-ode:fdd'),
              (u'\u0411\u0430\u0437\u043e\u0432\u0430\u044f \u043c\u043e\u0434\u0435\u043b\u044c \u043a\u043e\u043b\u0435\u0431\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430',
               2,
               u'fdm-for-ode:fdd:basic_model',
               u'fdm-for-ode:fdd:basic_model'),
              (u'\u0420\u0430\u0437\u043d\u043e\u0441\u0442\u043d\u0430\u044f \u0441\u0445\u0435\u043c\u0430',
               2,
               u'fdm-for-ode:fdd:fdd',
               u'fdm-for-ode:fdd:fdd'),
              (u'\u0412\u044b\u0447\u0438\u0441\u043b\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c',
               2,
               u'fdm-for-ode:fdd:alg',
               u'fdm-for-ode:fdd:alg'),
              (u'\u0411\u0435\u0437\u044b\u043d\u0434\u0435\u043a\u0441\u043d\u044b\u0435 \u043e\u0431\u043e\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f',
               2,
               u'fdm-for-ode:fdd:index_free',
               u'fdm-for-ode:fdd:index_free'),
              (u'\u041f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u043d\u0430\u044f \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f',
               1,
               u'fdm-for-ode:impl',
               u'fdm-for-ode:impl'),
              (u'\u0424\u0443\u043d\u043a\u0446\u0438\u044f-\u0440\u0435\u0448\u0430\u0442\u0435\u043b\u044c (\u0421\u043e\u043b\u0432\u0435\u0440)',
               2,
               u'fdm-for-ode:impl:solver',
               u'fdm-for-ode:impl:solver'),
              (u"\u0412\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u043d\u043e\u0439 $u'(t)$",
               2,
               u'fdm-for-ode:impl:comp_diff',
               u'fdm-for-ode:impl:comp_diff'),
              (u'\u0412\u0435\u0440\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c\u0430',
               1,
               u'fdm-for-ode:verif',
               u'fdm-for-ode:verif'),
              (u'\u0412\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u044f \u0432 \u0440\u0443\u0447\u043d\u0443\u044e',
               2,
               u'fdm-for-ode:verif:hand',
               u'fdm-for-ode:verif:hand'),
              (u'\u0422\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043d\u0430 \u043f\u0440\u043e\u0441\u0442\u0435\u0439\u0448\u0438\u0445 \u0440\u0435\u0448\u0435\u043d\u0438\u044f\u0445',
               2,
               u'fdm-for-ode:verif:',
               u'fdm-for-ode:verif:'),
              (u'\u0410\u043d\u0430\u043b\u0438\u0437 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u0438 \u0441\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438',
               2,
               u'fdm-for-ode:verif:conv',
               u'fdm-for-ode:verif:conv'),
              (u'\u041e\u0446\u0435\u043d\u043a\u0430 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u0438 \u0441\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438',
               3,
               u'fdm-for-ode:verif:conv:est',
               u'fdm-for-ode:verif:conv:est'),
              (u'\u041f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u043d\u0430\u044f \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f',
               3,
               u'fdm-for-ode:verif:conv:impl',
               u'fdm-for-ode:verif:conv:impl'),
              (u'\u0411\u0435\u0437\u0440\u0430\u0437\u043c\u0435\u0440\u043d\u0430\u044f \u043c\u043e\u0434\u0435\u043b\u044c',
               1,
               u'fdm-for-ode:scaled',
               u'fdm-for-ode:scaled'),
              (u'\u041f\u0440\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u0432\u044b\u0447\u0438\u0441\u043b\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u0430',
               1,
               u'fdm-for-ode:long_time',
               u'fdm-for-ode:long_time'),
              (u'\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0438\u0437\u043c\u0435\u043d\u044f\u044e\u0449\u0438\u0445\u0441\u044f \u0433\u0440\u0430\u0444\u0438\u043a\u043e\u0432',
               2,
               u'fdm-for-ode:long_time:mov_figs',
               u'fdm-for-ode:long_time:mov_figs'),
              (u'\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u0438',
               2,
               u'fdm-for-ode:long_time:anim',
               u'fdm-for-ode:long_time:anim'),
              (u'\u0421\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0435 \u0432\u0438\u0434\u0435\u043e \u0444\u043e\u0440\u043c\u0430\u0442\u044b',
               3,
               u'fdm-for-ode:long_time:anim:std',
               u'fdm-for-ode:long_time:anim:std'),
              (u'\u0423\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u044f \u0438 \u0437\u0430\u0434\u0430\u0447\u0438',
               1,
               u'fdm-for-ode:exercises',
               u'fdm-for-ode:exercises'),
              (u'Упражнение 1: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0440\u044f\u0434\u0430 \u0422\u0435\u0439\u043b\u043e\u0440\u0430 \u0434\u043b\u044f \u0432\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u044f $y^1$',
               2,
               u'fdm-for-ode:exercises:1',
               u'fdm-for-ode:exercises:1'),
              (u'Задача 2: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043b\u0438\u043d\u0435\u0439\u043d\u043e\u0439 \u0438 \u043a\u0432\u0430\u0434\u0440\u0430\u0442\u0438\u0447\u043d\u043e\u0439 \u0444\u0443\u043d\u043a\u0446\u0438\u0439 \u0434\u043b\u044f \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f',
               2,
               u'fdm-for-ode:exercises:pr:1',
               u'fdm-for-ode:exercises:pr:1')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    
<a name="part0002"></a>
<p>
<!-- begin top navigation -->
<table style="width: 100%"><tr><td>
<div style="text-align: left;"><a href="._fdm-for-ode-solarized001.html">&laquo; Previous</a></div>
</td><td>
</td></tr></table>
<!-- end top navigation -->
</p>

<p>
<!-- !split -->

<h1 id="fdm-for-ode:exercises">Упражнения и задачи</h1>

<p>
<!-- --- begin exercise --- -->

<h2 id="fdm-for-ode:exercises:1">Упражнение 1: Использование ряда Тейлора для вычисления \( y^1 \)</h2>

<p>
Альтернативный способ вывода
<a href="._fdm-for-ode-solarized001.html#mjx-eqn-7">(7)</a> для
вычисления \( y^1 \) заключается в использовании следующего
ряда Тейлора:

$$
\begin{equation*}
\tag{11}
	u(t_1) \approx u(0) + \tau u'(0) + \frac{\tau}{2} u''(0) + O(\tau^3)
\end{equation*}
$$

<p>
Используя уравнение <a href="._fdm-for-ode-solarized001.html#mjx-eqn-1">(1)</a> и начальное условие для
производной \( u'(0) = 0 \), покажите, что такой способ
также приведет к <a href="._fdm-for-ode-solarized001.html#mjx-eqn-7">(7)</a>. Более общее условие
для \( u'(0) \) имеет вид \( u'(0) = V \). Получите
формулу для вычисления \( y^1 \) двумя способами.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="fdm-for-ode:exercises:pr:1">Задача 2: Использование линейной и квадратичной функций для тестирования</h2>

<p>
Рассмотрим задачу для ОДУ:

$$
\begin{equation*}
   u'' + \omega^2 u = f(t), \quad u(0) = U,
   \quad u'(0) = V, \quad t \in (0, T].
\end{equation*}
$$


<ol>
<li> Аппроксимируем уравнение разностной схемой \( y_{\bar{t}t}^n + \omega^2 y^n = f^n \).</li>
<li> Вывести уравнение для нахождения приближенного решения \( y^1 \) на первом временном шаге.</li>
<li> Для тестирования реализации алгоритма воспользуемся методом пробных функций. Выберем \( u_e(t) = ct + d \).  Найти \( c \) и \( d \) из начальных условий. Вычислить соответствующую функцию источника \( f \). Покажите, что \( u_e \) является точным решением соответствующей разностной схемы.</li> 
<li> Используйте <code>sympy</code> для выполнения символьных вычислений из пункта 2. Ниже представлен каркас такой программы:</li> 
</ol>

<!-- begin verbatim block  pypro-->
<pre><code># -*- coding: utf-8 -*-

import sympy as sym
V, t, U, omega, tau = sym.symbols('V t U omega tau')  # глобальные символы
f = None  # глобальная переменная для функции источника ОДУ

def ode_source_term(u):
    &quot;&quot;&quot;
    Возвращает функцию источника ОДУ, равную u'' + omega**2*u.
    u --- символьная функция от t.&quot;&quot;&quot;
    return sym.diff(u(t), t, t) + omega**2*u(t)

def residual_discrete_eq(u):
    &quot;&quot;&quot;
    Возвращает невязку разностного уравнения на заданной u.
    &quot;&quot;&quot;
    R = ...
    return sym.simplify(R)

def residual_discrete_eq_step1(u):
    &quot;&quot;&quot;
    Возвращает невязку разностного уравнения на первом шаге 
    на заданной u.
    &quot;&quot;&quot;
    R = ...
    return sym.simplify(R)

def DtDt(u, tau):
	&quot;&quot;&quot;
	Возвращает вторую разностную производную от u.
	u --- символьная функция от t.
    &quot;&quot;&quot;
    return ...

def main(u):
	&quot;&quot;&quot;
	Задавая некоторое решение u как функцию от t, используйте метод
	пробных функций для вычисления функции источника f и проверьте 
	является ли u решением и разностной задачи.
    &quot;&quot;&quot;
    print '=== Проверка точного решения: %s ===' % u
    print &quot;Начальные условия u(0)=%s, u'(0)=%s:&quot; % \
          (u(t).subs(t, 0), sym.diff(u(t), t).subs(t, 0))

    # Метод пробных функций требует подбора f
    global f
    f = sym.simplify(ode_lhs(u))

    # Невязка разностной задачи (должна быть 0)
    print 'residual step1:', residual_discrete_eq_step1(u)
    print 'residual:', residual_discrete_eq(u)

def linear():
    main(lambda t: V*t + U)

if __name__ == '__main__':
    linear()
</code></pre>
<!-- end verbatim block -->

<p>
<!-- Local Variables: -->
<!-- doconce-chapter-nickname: "fdm-for-ode" -->
<!-- doconce-section-nickname: "exercises" -->
<!-- End: -->

<p>
<!-- Local Variables: -->
<!-- doconce-chapter-nickname: "fdm-for-ode" -->
<!-- End: -->
<!-- --- end exercise --- -->

<p>
<!-- begin bottom navigation -->
<table style="width: 100%"><tr><td>
<div style="text-align: left;"><a href="._fdm-for-ode-solarized001.html">&laquo; Previous</a></div>
</td><td>
</td></tr></table>
<!-- end bottom navigation -->
</p>

<!-- ------------------- end of main content --------------- -->


</body>
</html>
    

