<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Разностные схемы для ОДУ колебаний">
<meta name="keywords" content="Разностная схема,Разностная производная,Разностная производная левая,Разностная производная  правая,Разностная производная вторая,Разностная производная центральная,ArgumentParser">

<title>Разностные схемы для ОДУ колебаний</title>

<!-- Bootstrap style: bootswatch_readable -->
<link href="https://netdna.bootstrapcdn.com/bootswatch/3.1.1/readable/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }

/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}

/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:64px;      /* fixed header height for style bootswatch_readable */
  margin:-64px 0 0; /* negative fixed header height */
}
</style>


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [('Содержание',
               1,
               'table_of_contents',
               'table_of_contents'),
              (u'\u041a\u043e\u043d\u0435\u0447\u043d\u043e-\u0440\u0430\u0437\u043d\u043e\u0441\u0442\u043d\u0430\u044f \u0434\u0438\u0441\u043a\u0440\u0435\u0442\u0438\u0437\u0430\u0446\u0438\u044f',
               1,
               u'fdm-for-ode:fdd',
               u'fdm-for-ode:fdd'),
              (u'\u0411\u0430\u0437\u043e\u0432\u0430\u044f \u043c\u043e\u0434\u0435\u043b\u044c \u043a\u043e\u043b\u0435\u0431\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430',
               2,
               u'fdm-for-ode:fdd:basic_model',
               u'fdm-for-ode:fdd:basic_model'),
              (u'\u0420\u0430\u0437\u043d\u043e\u0441\u0442\u043d\u0430\u044f \u0441\u0445\u0435\u043c\u0430',
               2,
               u'fdm-for-ode:fdd:fdd',
               u'fdm-for-ode:fdd:fdd'),
              (u'\u0412\u044b\u0447\u0438\u0441\u043b\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c',
               2,
               u'fdm-for-ode:fdd:alg',
               u'fdm-for-ode:fdd:alg'),
              (u'\u0411\u0435\u0437\u044b\u043d\u0434\u0435\u043a\u0441\u043d\u044b\u0435 \u043e\u0431\u043e\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f',
               2,
               u'fdm-for-ode:fdd:index_free',
               u'fdm-for-ode:fdd:index_free'),
              (u'\u041f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u043d\u0430\u044f \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f',
               1,
               u'fdm-for-ode:impl',
               u'fdm-for-ode:impl'),
              (u'\u0424\u0443\u043d\u043a\u0446\u0438\u044f-\u0440\u0435\u0448\u0430\u0442\u0435\u043b\u044c (\u0421\u043e\u043b\u0432\u0435\u0440)',
               2,
               u'fdm-for-ode:impl:solver',
               u'fdm-for-ode:impl:solver'),
              (u"\u0412\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u043d\u043e\u0439 $u'(t)$",
               2,
               u'fdm-for-ode:impl:comp_diff',
               u'fdm-for-ode:impl:comp_diff'),
              (u'\u0412\u0435\u0440\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c\u0430',
               1,
               u'fdm-for-ode:verif',
               u'fdm-for-ode:verif'),
              (u'\u0412\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u044f \u0432 \u0440\u0443\u0447\u043d\u0443\u044e',
               2,
               u'fdm-for-ode:verif:hand',
               u'fdm-for-ode:verif:hand'),
              (u'\u0422\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043d\u0430 \u043f\u0440\u043e\u0441\u0442\u0435\u0439\u0448\u0438\u0445 \u0440\u0435\u0448\u0435\u043d\u0438\u044f\u0445',
               2,
               u'fdm-for-ode:verif:',
               u'fdm-for-ode:verif:'),
              (u'\u0410\u043d\u0430\u043b\u0438\u0437 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u0438 \u0441\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438',
               2,
               u'fdm-for-ode:verif:conv',
               u'fdm-for-ode:verif:conv'),
              (u'\u041e\u0446\u0435\u043d\u043a\u0430 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u0438 \u0441\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438',
               3,
               u'fdm-for-ode:verif:conv:est',
               u'fdm-for-ode:verif:conv:est'),
              (u'\u041f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u043d\u0430\u044f \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f',
               3,
               u'fdm-for-ode:verif:conv:impl',
               u'fdm-for-ode:verif:conv:impl'),
              (u'\u0411\u0435\u0437\u0440\u0430\u0437\u043c\u0435\u0440\u043d\u0430\u044f \u043c\u043e\u0434\u0435\u043b\u044c',
               1,
               u'fdm-for-ode:scaled',
               u'fdm-for-ode:scaled'),
              (u'\u041f\u0440\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u0432\u044b\u0447\u0438\u0441\u043b\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u0430',
               1,
               u'fdm-for-ode:long_time',
               u'fdm-for-ode:long_time'),
              (u'\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0438\u0437\u043c\u0435\u043d\u044f\u044e\u0449\u0438\u0445\u0441\u044f \u0433\u0440\u0430\u0444\u0438\u043a\u043e\u0432',
               2,
               u'fdm-for-ode:long_time:mov_figs',
               u'fdm-for-ode:long_time:mov_figs'),
              (u'\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u0438',
               2,
               u'fdm-for-ode:long_time:anim',
               u'fdm-for-ode:long_time:anim'),
              (u'\u0421\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0435 \u0432\u0438\u0434\u0435\u043e \u0444\u043e\u0440\u043c\u0430\u0442\u044b',
               3,
               u'fdm-for-ode:long_time:anim:std',
               u'fdm-for-ode:long_time:anim:std'),
              (u'\u041f\u0440\u043e\u0438\u0433\u0440\u044b\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0430\u0431\u043e\u0440\u0430 PNG \u0444\u0430\u0439\u043b\u043e\u0432 \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435',
               3,
               u'fdm-for-ode:long_time:anim:png_play',
               u'fdm-for-ode:long_time:anim:png_play'),
              (u'\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0430\u043d\u0438\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 GIF \u0444\u0430\u0439\u043b\u043e\u0432',
               3,
               u'fdm-for-ode:long_time:anim:gif',
               u'fdm-for-ode:long_time:anim:gif'),
              (u'\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 Bokeh \u0434\u043b\u044f \u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u044f \u0433\u0440\u0430\u0444\u0438\u043a\u043e\u0432',
               2,
               u'fdm-for-ode:long_time:bokeh',
               u'fdm-for-ode:long_time:bokeh'),
              (u'\u0423\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u044f \u0438 \u0437\u0430\u0434\u0430\u0447\u0438',
               1,
               u'fdm-for-ode:exercises',
               u'fdm-for-ode:exercises'),
              (u'Упражнение 1: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0440\u044f\u0434\u0430 \u0422\u0435\u0439\u043b\u043e\u0440\u0430 \u0434\u043b\u044f \u0432\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u044f $y^1$',
               2,
               u'fdm-for-ode:exercises:1',
               u'fdm-for-ode:exercises:1'),
              (u'Задача 2: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043b\u0438\u043d\u0435\u0439\u043d\u043e\u0439 \u0438 \u043a\u0432\u0430\u0434\u0440\u0430\u0442\u0438\u0447\u043d\u043e\u0439 \u0444\u0443\u043d\u043a\u0446\u0438\u0439 \u0434\u043b\u044f \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f',
               2,
               u'fdm-for-ode:exercises:pr:1',
               u'fdm-for-ode:exercises:pr:1')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="fdm-for-ode-readable.html">Разностные схемы для ОДУ колебаний</a>
  </div>

  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable000.html#table_of_contents" style="font-size: 80%;"><b>Содержание</b></a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:fdd" style="font-size: 80%;"><b>Конечно-разностная дискретизация</b></a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:fdd:basic_model" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Базовая модель колебательного процесса</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:fdd:fdd" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Разностная схема</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:fdd:alg" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Вычислительный алгоритм</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:fdd:index_free" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Безындексные обозначения</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:impl" style="font-size: 80%;"><b>Программная реализация</b></a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:impl:solver" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Функция-решатель (Солвер)</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:impl:comp_diff" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Вычисление производной \( u'(t) \)</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:verif" style="font-size: 80%;"><b>Верификация реализации алгоритма</b></a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:verif:hand" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Вычисления в ручную</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:verif:" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Тестирование на простейших решениях</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:verif:conv" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Анализ скорости сходимости</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:verif:conv:est" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Оценка скорости сходимости</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:verif:conv:impl" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Программная реализация</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:scaled" style="font-size: 80%;"><b>Безразмерная модель</b></a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:long_time" style="font-size: 80%;"><b>Проведение вычислительного эксперимента</b></a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:long_time:mov_figs" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Использование изменяющихся графиков</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:long_time:anim" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Создание анимации</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:long_time:anim:std" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Стандартные видео форматы</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:long_time:anim:png_play" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Проигрыватель набора PNG файлов в браузере</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:long_time:anim:gif" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Создание анимированных GIF файлов</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:long_time:bokeh" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Использование Bokeh для сравнения графиков</a></li>
     <!-- navigation toc: --> <li><a href="#fdm-for-ode:exercises" style="font-size: 80%;"><b>Упражнения и задачи</b></a></li>
     <!-- navigation toc: --> <li><a href="#fdm-for-ode:exercises:1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Упражнение 1: Использование ряда Тейлора для вычисления \( y^1 \)</a></li>
     <!-- navigation toc: --> <li><a href="#fdm-for-ode:exercises:pr:1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Задача 2: Использование линейной и квадратичной функций для тестирования</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0002"></a>
<!-- !split -->

<h1 id="fdm-for-ode:exercises" class="anchor">Упражнения и задачи</h1>

<p>
<!-- --- begin exercise --- -->

<h2 id="fdm-for-ode:exercises:1" class="anchor">Упражнение 1: Использование ряда Тейлора для вычисления \( y^1 \)</h2>

<p>
Альтернативный способ вывода
<a href="._fdm-for-ode-readable001.html#mjx-eqn-7">(7)</a> для
вычисления \( y^1 \) заключается в использовании следующего
ряда Тейлора:

$$
\begin{equation*}
\tag{11}
	u(t_1) \approx u(0) + \tau u'(0) + \frac{\tau}{2} u''(0) + O(\tau^3)
\end{equation*}
$$

<p>
Используя уравнение <a href="._fdm-for-ode-readable001.html#mjx-eqn-1">(1)</a> и начальное условие для
производной \( u'(0) = 0 \), покажите, что такой способ
также приведет к <a href="._fdm-for-ode-readable001.html#mjx-eqn-7">(7)</a>. Более общее условие
для \( u'(0) \) имеет вид \( u'(0) = V \). Получите
формулу для вычисления \( y^1 \) двумя способами.

<p>
<!-- --- end exercise --- -->

<p>
<!-- --- begin exercise --- -->

<h2 id="fdm-for-ode:exercises:pr:1" class="anchor">Задача 2: Использование линейной и квадратичной функций для тестирования</h2>

<p>
Рассмотрим задачу для ОДУ:

$$
\begin{equation*}
   u'' + \omega^2 u = f(t), \quad u(0) = U,
   \quad u'(0) = V, \quad t \in (0, T].
\end{equation*}
$$


<ol>
<li> Аппроксимируем уравнение разностной схемой \( y_{\bar{t}t}^n + \omega^2 y^n = f^n \).</li>
<li> Вывести уравнение для нахождения приближенного решения \( y^1 \) на первом временном шаге.</li>
<li> Для тестирования реализации алгоритма воспользуемся методом пробных функций. Выберем \( u_e(t) = ct + d \).  Найти \( c \) и \( d \) из начальных условий. Вычислить соответствующую функцию источника \( f \). Покажите, что \( u_e \) является точным решением соответствующей разностной схемы.</li> 
<li> Используйте <code>sympy</code> для выполнения символьных вычислений из пункта 2. Ниже представлен каркас такой программы:</li> 
</ol>

<p>

<!-- code=python (!bc pypro) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #408080; font-style: italic"># -*- coding: utf-8 -*-</span>

<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">sympy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">sym</span>
V, t, U, omega, tau <span style="color: #666666">=</span> sym<span style="color: #666666">.</span>symbols(<span style="color: #BA2121">&#39;V t U omega tau&#39;</span>)  <span style="color: #408080; font-style: italic"># глобальные символы</span>
f <span style="color: #666666">=</span> <span style="color: #008000">None</span>  <span style="color: #408080; font-style: italic"># глобальная переменная для функции источника ОДУ</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">ode_source_term</span>(u):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    Возвращает функцию источника ОДУ, равную u&#39;&#39; + omega**2*u.</span>
<span style="color: #BA2121; font-style: italic">    u --- символьная функция от t.&quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">return</span> sym<span style="color: #666666">.</span>diff(u(t), t, t) <span style="color: #666666">+</span> omega<span style="color: #666666">**2*</span>u(t)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">residual_discrete_eq</span>(u):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    Возвращает невязку разностного уравнения на заданной u.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    R <span style="color: #666666">=</span> <span style="color: #666666">...</span>
    <span style="color: #008000; font-weight: bold">return</span> sym<span style="color: #666666">.</span>simplify(R)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">residual_discrete_eq_step1</span>(u):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    Возвращает невязку разностного уравнения на первом шаге </span>
<span style="color: #BA2121; font-style: italic">    на заданной u.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    R <span style="color: #666666">=</span> <span style="color: #666666">...</span>
    <span style="color: #008000; font-weight: bold">return</span> sym<span style="color: #666666">.</span>simplify(R)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">DtDt</span>(u, tau):
	<span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">	Возвращает вторую разностную производную от u.</span>
<span style="color: #BA2121; font-style: italic">	u --- символьная функция от t.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">...</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">main</span>(u):
	<span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">	Задавая некоторое решение u как функцию от t, используйте метод</span>
<span style="color: #BA2121; font-style: italic">	пробных функций для вычисления функции источника f и проверьте </span>
<span style="color: #BA2121; font-style: italic">	является ли u решением и разностной задачи.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;=== Проверка точного решения: </span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121"> ===&#39;</span> <span style="color: #666666">%</span> u
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&quot;Начальные условия u(0)=</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">, u&#39;(0)=</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">:&quot;</span> <span style="color: #666666">%</span> \
          (u(t)<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>), sym<span style="color: #666666">.</span>diff(u(t), t)<span style="color: #666666">.</span>subs(t, <span style="color: #666666">0</span>))

    <span style="color: #408080; font-style: italic"># Метод пробных функций требует подбора f</span>
    <span style="color: #008000; font-weight: bold">global</span> f
    f <span style="color: #666666">=</span> sym<span style="color: #666666">.</span>simplify(ode_lhs(u))

    <span style="color: #408080; font-style: italic"># Невязка разностной задачи (должна быть 0)</span>
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;residual step1:&#39;</span>, residual_discrete_eq_step1(u)
    <span style="color: #008000; font-weight: bold">print</span> <span style="color: #BA2121">&#39;residual:&#39;</span>, residual_discrete_eq(u)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">linear</span>():
    main(<span style="color: #008000; font-weight: bold">lambda</span> t: V<span style="color: #666666">*</span>t <span style="color: #666666">+</span> U)

<span style="color: #008000; font-weight: bold">if</span> __name__ <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;__main__&#39;</span>:
    linear()
</pre></div>
<p>
<!-- Local Variables: -->
<!-- doconce-chapter-nickname: "fdm-for-ode" -->
<!-- doconce-section-nickname: "exercises" -->
<!-- End: -->

<p>
<!-- Local Variables: -->
<!-- doconce-chapter-nickname: "fdm-for-ode" -->
<!-- End: -->
<!-- --- end exercise --- -->

<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">
  <li class="previous">
    <a href="._fdm-for-ode-readable001.html">&larr; Prev</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


</body>
</html>
    

