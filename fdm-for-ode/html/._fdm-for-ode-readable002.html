<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Разностные схемы для ОДУ колебаний">
<meta name="keywords" content="Разностная схема,Разностная производная,Разностная производная левая,Разностная производная  правая,Разностная производная вторая,Разностная производная центральная,ArgumentParser,Условие устойчивости">

<title>Разностные схемы для ОДУ колебаний</title>

<!-- Bootstrap style: bootswatch_readable -->
<link href="https://netdna.bootstrapcdn.com/bootswatch/3.1.1/readable/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">
/* Let inline verbatim have the same color as the surroundings */
code { color: inherit; background-color: transparent; }

/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}

/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:64px;      /* fixed header height for style bootswatch_readable */
  margin:-64px 0 0; /* negative fixed header height */
}
</style>


<!-- Tools for embedded Bokeh plots -->
<link rel=stylesheet 
      href=https://cdn.pydata.org/bokeh/release/bokeh-0.12.4.min.css 
      type=text/css />
<script type=text/javascript 
        src=https://cdn.pydata.org/bokeh/release/bokeh-0.12.4.min.js>
</script>
<script type=text/javascript>
  Bokeh.set_log_level("info");
</script>

<style>
.bk-embeded {
    width: 100%;
    margin: auto;
    height: 500px;
    text-align: webkit-left;
}
</style>


</head>


<!-- tocinfo
{'highest level': 1,
 'sections': [('Содержание',
               1,
               'table_of_contents',
               'table_of_contents'),
              (u'\u041a\u043e\u043d\u0435\u0447\u043d\u043e-\u0440\u0430\u0437\u043d\u043e\u0441\u0442\u043d\u0430\u044f \u0434\u0438\u0441\u043a\u0440\u0435\u0442\u0438\u0437\u0430\u0446\u0438\u044f',
               1,
               u'fdm-for-ode:fdd',
               u'fdm-for-ode:fdd'),
              (u'\u0411\u0430\u0437\u043e\u0432\u0430\u044f \u043c\u043e\u0434\u0435\u043b\u044c \u043a\u043e\u043b\u0435\u0431\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430',
               2,
               u'fdm-for-ode:fdd:basic_model',
               u'fdm-for-ode:fdd:basic_model'),
              (u'\u0420\u0430\u0437\u043d\u043e\u0441\u0442\u043d\u0430\u044f \u0441\u0445\u0435\u043c\u0430',
               2,
               u'fdm-for-ode:fdd:fdd',
               u'fdm-for-ode:fdd:fdd'),
              (u'\u0412\u044b\u0447\u0438\u0441\u043b\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c',
               2,
               u'fdm-for-ode:fdd:alg',
               u'fdm-for-ode:fdd:alg'),
              (u'\u0411\u0435\u0437\u044b\u043d\u0434\u0435\u043a\u0441\u043d\u044b\u0435 \u043e\u0431\u043e\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f',
               2,
               u'fdm-for-ode:fdd:index_free',
               u'fdm-for-ode:fdd:index_free'),
              (u'\u041f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u043d\u0430\u044f \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f',
               1,
               u'fdm-for-ode:impl',
               u'fdm-for-ode:impl'),
              (u'\u0424\u0443\u043d\u043a\u0446\u0438\u044f-\u0440\u0435\u0448\u0430\u0442\u0435\u043b\u044c (\u0421\u043e\u043b\u0432\u0435\u0440)',
               2,
               u'fdm-for-ode:impl:solver',
               u'fdm-for-ode:impl:solver'),
              (u"\u0412\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u0435 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u043d\u043e\u0439 $u'(t)$",
               2,
               u'fdm-for-ode:impl:comp_diff',
               u'fdm-for-ode:impl:comp_diff'),
              (u'\u0412\u0435\u0440\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c\u0430',
               1,
               u'fdm-for-ode:verif',
               u'fdm-for-ode:verif'),
              (u'\u0412\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u044f \u0432 \u0440\u0443\u0447\u043d\u0443\u044e',
               2,
               u'fdm-for-ode:verif:hand',
               u'fdm-for-ode:verif:hand'),
              (u'\u0422\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043d\u0430 \u043f\u0440\u043e\u0441\u0442\u0435\u0439\u0448\u0438\u0445 \u0440\u0435\u0448\u0435\u043d\u0438\u044f\u0445',
               2,
               u'fdm-for-ode:verif:',
               u'fdm-for-ode:verif:'),
              (u'\u0410\u043d\u0430\u043b\u0438\u0437 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u0438 \u0441\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438',
               2,
               u'fdm-for-ode:verif:conv',
               u'fdm-for-ode:verif:conv'),
              (u'\u041e\u0446\u0435\u043d\u043a\u0430 \u0441\u043a\u043e\u0440\u043e\u0441\u0442\u0438 \u0441\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438',
               3,
               u'fdm-for-ode:verif:conv:est',
               u'fdm-for-ode:verif:conv:est'),
              (u'\u041f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u043d\u0430\u044f \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f',
               3,
               u'fdm-for-ode:verif:conv:impl',
               u'fdm-for-ode:verif:conv:impl'),
              (u'\u0411\u0435\u0437\u0440\u0430\u0437\u043c\u0435\u0440\u043d\u0430\u044f \u043c\u043e\u0434\u0435\u043b\u044c',
               1,
               u'fdm-for-ode:scaled',
               u'fdm-for-ode:scaled'),
              (u'\u041f\u0440\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u0432\u044b\u0447\u0438\u0441\u043b\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u0430',
               1,
               u'fdm-for-ode:long_time',
               u'fdm-for-ode:long_time'),
              (u'\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0438\u0437\u043c\u0435\u043d\u044f\u044e\u0449\u0438\u0445\u0441\u044f \u0433\u0440\u0430\u0444\u0438\u043a\u043e\u0432',
               2,
               u'fdm-for-ode:long_time:mov_figs',
               u'fdm-for-ode:long_time:mov_figs'),
              (u'\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0430\u043d\u0438\u043c\u0430\u0446\u0438\u0438',
               2,
               u'fdm-for-ode:long_time:anim',
               u'fdm-for-ode:long_time:anim'),
              (u'\u0421\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u0435 \u0432\u0438\u0434\u0435\u043e \u0444\u043e\u0440\u043c\u0430\u0442\u044b',
               3,
               u'fdm-for-ode:long_time:anim:std',
               u'fdm-for-ode:long_time:anim:std'),
              (u'\u041f\u0440\u043e\u0438\u0433\u0440\u044b\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0430\u0431\u043e\u0440\u0430 PNG \u0444\u0430\u0439\u043b\u043e\u0432 \u0432 \u0431\u0440\u0430\u0443\u0437\u0435\u0440\u0435',
               3,
               u'fdm-for-ode:long_time:anim:png_play',
               u'fdm-for-ode:long_time:anim:png_play'),
              (u'\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0430\u043d\u0438\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 GIF \u0444\u0430\u0439\u043b\u043e\u0432',
               3,
               u'fdm-for-ode:long_time:anim:gif',
               u'fdm-for-ode:long_time:anim:gif'),
              (u'\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 Bokeh \u0434\u043b\u044f \u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u044f \u0433\u0440\u0430\u0444\u0438\u043a\u043e\u0432',
               2,
               u'fdm-for-ode:long_time:bokeh',
               u'fdm-for-ode:long_time:bokeh'),
              (u'\u041f\u0440\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0430\u043d\u0430\u043b\u0438\u0437 \u0440\u0435\u0448\u0435\u043d\u0438\u044f',
               2,
               u'fdm-for-ode:long_time:empirical',
               u'fdm-for-ode:long_time:empirical'),
              (u'\u0410\u043d\u0430\u043b\u0438\u0437 \u043a\u043e\u043d\u0435\u0447\u043d\u043e-\u0440\u0430\u0437\u043d\u043e\u0441\u0442\u043d\u043e\u0439 \u0441\u0445\u0435\u043c\u044b',
               1,
               u'fdm-for-ode:analysis',
               u'fdm-for-ode:analysis'),
              (u'\u0412\u044b\u0432\u043e\u0434 \u0440\u0435\u0448\u0435\u043d\u0438\u044f \u043a\u043e\u043d\u0435\u0447\u043d\u043e-\u0440\u0430\u0437\u043d\u043e\u0441\u0442\u043d\u043e\u0439 \u0441\u0445\u0435\u043c\u044b',
               2,
               u'fdm-for-ode:analysis:deriv',
               u'fdm-for-ode:analysis:deriv'),
              (u'\u0422\u043e\u0447\u043d\u043e\u0435 \u0434\u0438\u0441\u043a\u0440\u0435\u0442\u043d\u043e\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u0435',
               2,
               u'fdm-for-ode:analysis:ex:disc',
               u'fdm-for-ode:analysis:ex:disc'),
              (u'\u0421\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u044c',
               2,
               u'fdm-for-ode:analysis:conv',
               u'fdm-for-ode:analysis:conv'),
              (u'\u0413\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u0430\u044f \u043f\u043e\u0433\u0440\u0435\u0448\u043d\u043e\u0441\u0442\u044c',
               2,
               u'fdm-for-ode:analysis:glob_error',
               u'fdm-for-ode:analysis:glob_error'),
              (u'\u0423\u0441\u0442\u043e\u0439\u0447\u0438\u0432\u043e\u0441\u0442\u044c',
               2,
               u'fdm-for-ode:analysis:stab',
               u'fdm-for-ode:analysis:stab'),
              (u'\u041e \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u0438 \u043f\u0440\u0438 \u0433\u0440\u0430\u043d\u0438\u0446\u0435 \u0443\u0441\u0442\u043e\u0439\u0447\u0438\u0432\u043e\u0441\u0442\u0438',
               2,
               u'fdm-for-ode:analysis:stan_bound',
               u'fdm-for-ode:analysis:stan_bound'),
              (u'\u041e\u0431\u043e\u0431\u0449\u0435\u043d\u0438\u044f: \u0437\u0430\u0442\u0443\u0445\u0430\u043d\u0438\u0435, \u043d\u0435\u043b\u0438\u043d\u0435\u0439\u043d\u044b\u0435 \u0441\u0442\u0440\u0443\u043d\u044b \u0438 \u0432\u043d\u0435\u0448\u043d\u0438\u0435 \u0432\u043e\u0437\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f',
               1,
               u'fdm-for-ode:gen',
               u'fdm-for-ode:gen'),
              (u'\u0420\u0430\u0437\u043d\u043e\u0441\u0442\u043d\u0430\u044f \u0441\u0445\u0435\u043c\u0430 \u0434\u043b\u044f \u043b\u0438\u043d\u0435\u0439\u043d\u043e\u0433\u043e \u0437\u0430\u0442\u0443\u0445\u0430\u043d\u0438\u044f',
               2,
               u'fdm-for-ode:gen:lin_damp',
               u'fdm-for-ode:gen:lin_damp'),
              (u'\u0420\u0430\u0437\u043d\u043e\u0441\u0442\u043d\u0430\u044f \u0441\u0445\u0435\u043c\u0430 \u0434\u043b\u044f \u043a\u0432\u0430\u0434\u0440\u0430\u0442\u0438\u0447\u043d\u043e\u0433\u043e \u0437\u0430\u0442\u0443\u0445\u0430\u043d\u0438\u044f',
               2,
               u'fdm-for-ode:gen:quad_damp',
               u'fdm-for-ode:gen:quad_damp'),
              (u'\u041f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u043d\u0430\u044f \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f',
               2,
               u'fdm-for-ode:gen:impl',
               u'fdm-for-ode:gen:impl'),
              (u'\u0412\u0435\u0440\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c\u0430',
               2,
               u'fdm-for-ode:gen:verif',
               u'fdm-for-ode:gen:verif'),
              (u'\u041f\u043e\u0441\u0442\u043e\u044f\u043d\u043d\u043e\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u0435',
               3,
               u'fdm-for-ode:gen:verif:const_sol',
               u'fdm-for-ode:gen:verif:const_sol'),
              (u'\u041b\u0438\u043d\u0435\u0439\u043d\u0430\u044f \u0444\u0443\u043d\u043a\u0446\u0438\u044f \u043a\u0430\u043a \u0440\u0435\u0448\u0435\u043d\u0438\u0435',
               3,
               u'fdm-for-ode:gen:verif:lin_sol',
               u'fdm-for-ode:gen:verif:lin_sol'),
              (u'\u041a\u0432\u0430\u0434\u0440\u0430\u0442\u0438\u0447\u043d\u0430\u044f \u0444\u0443\u043d\u043a\u0446\u0438\u044f \u043a\u0430\u043a \u0440\u0435\u0448\u0435\u043d\u0438\u0435',
               3,
               u'fdm-for-ode:gen:verif:quad_sol',
               u'fdm-for-ode:gen:verif:quad_sol'),
              (u'\u0412\u0438\u0437\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f',
               2,
               u'fdm-for-ode:gen:vis',
               u'fdm-for-ode:gen:vis'),
              (u'\u0418\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u043a\u043e\u043c\u0430\u043d\u0434\u043d\u043e\u0439 \u0441\u0442\u0440\u043e\u043a\u0438',
               2,
               u'fdm-for-ode:gen:user_int',
               u'fdm-for-ode:gen:user_int'),
              (u'\u0423\u043f\u0440\u0430\u0436\u043d\u0435\u043d\u0438\u044f \u0438 \u0437\u0430\u0434\u0430\u0447\u0438',
               1,
               u'fdm-for-ode:exercises',
               u'fdm-for-ode:exercises'),
              (u'Упражнение 1: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0440\u044f\u0434\u0430 \u0422\u0435\u0439\u043b\u043e\u0440\u0430 \u0434\u043b\u044f \u0432\u044b\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u044f $y^1$',
               2,
               u'fdm-for-ode:exercises:1',
               u'fdm-for-ode:exercises:1'),
              (u'Упражнение 2: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u0442\u043e\u0447\u043d\u043e\u0433\u043e \u0434\u0438\u0441\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u0440\u0435\u0448\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f',
               2,
               u'fdm-for-ode:exercises:2',
               u'fdm-for-ode:exercises:2'),
              (u'Упражнение 3: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043b\u0438\u043d\u0435\u0439\u043d\u043e\u0439 \u0438 \u043a\u0432\u0430\u0434\u0440\u0430\u0442\u0438\u0447\u043d\u043e\u0439 \u0444\u0443\u043d\u043a\u0446\u0438\u0439 \u0434\u043b\u044f \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f',
               2,
               u'fdm-for-ode:exercises:3',
               u'fdm-for-ode:exercises:3'),
              (u'Упражнение 4: \u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043b\u0438\u043d\u0435\u0439\u043d\u044b\u0439 \u0440\u043e\u0441\u0442 \u0444\u0430\u0437\u044b \u0441\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0435\u043c',
               2,
               u'fdm-for-ode:exercises:4',
               u'fdm-for-ode:exercises:4'),
              (u'Упражнение 5: \u0423\u043b\u0443\u0447\u0448\u0438\u0442\u044c \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u044c \u0440\u0435\u0433\u0443\u043b\u044f\u0440\u0438\u0437\u0430\u0446\u0438\u0435\u0439 \u0447\u0430\u0441\u0442\u043e\u0442\u044b',
               2,
               u'fdm-for-ode:exercises:5',
               u'fdm-for-ode:exercises:5'),
              (u'Упражнение 6: \u0412\u0438\u0437\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0430\u043f\u043f\u0440\u043e\u043a\u0441\u0438\u043c\u0430\u0446\u0438\u0438 \u0440\u0430\u0437\u043d\u043e\u0441\u0442\u043d\u044b\u0445 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u043d\u044b\u0445 \u0434\u043b\u044f \u043a\u043e\u0441\u0438\u043d\u0443\u0441\u0430',
               2,
               u'fdm-for-ode:exercises:6',
               u'fdm-for-ode:exercises:6'),
              (u'Упражнение 7: \u041c\u0438\u043d\u0438\u043c\u0438\u0437\u0430\u0446\u0438\u044f \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u043f\u0430\u043c\u044f\u0442\u0438',
               2,
               u'fdm-for-ode:exercises:7',
               u'fdm-for-ode:exercises:7'),
              (u'Задача 8: \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043b\u0438\u043d\u0435\u0439\u043d\u043e\u0439 \u0438 \u043a\u0432\u0430\u0434\u0440\u0430\u0442\u0438\u0447\u043d\u043e\u0439 \u0444\u0443\u043d\u043a\u0446\u0438\u0439 \u0434\u043b\u044f \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f',
               2,
               u'fdm-for-ode:exercises:pr:1',
               u'fdm-for-ode:exercises:pr:1')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="fdm-for-ode-readable.html">Разностные схемы для ОДУ колебаний</a>
  </div>

  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable000.html#table_of_contents" style="font-size: 80%;"><b>Содержание</b></a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:fdd" style="font-size: 80%;"><b>Конечно-разностная дискретизация</b></a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:fdd:basic_model" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Базовая модель колебательного процесса</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:fdd:fdd" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Разностная схема</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:fdd:alg" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Вычислительный алгоритм</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:fdd:index_free" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Безындексные обозначения</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:impl" style="font-size: 80%;"><b>Программная реализация</b></a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:impl:solver" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Функция-решатель (Солвер)</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:impl:comp_diff" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Вычисление производной \( u'(t) \)</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:verif" style="font-size: 80%;"><b>Верификация реализации алгоритма</b></a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:verif:hand" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Вычисления в ручную</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:verif:" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Тестирование на простейших решениях</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:verif:conv" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Анализ скорости сходимости</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:verif:conv:est" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Оценка скорости сходимости</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:verif:conv:impl" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Программная реализация</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:scaled" style="font-size: 80%;"><b>Безразмерная модель</b></a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:long_time" style="font-size: 80%;"><b>Проведение вычислительного эксперимента</b></a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:long_time:mov_figs" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Использование изменяющихся графиков</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:long_time:anim" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Создание анимации</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:long_time:anim:std" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Стандартные видео форматы</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:long_time:anim:png_play" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Проигрыватель набора PNG файлов в браузере</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:long_time:anim:gif" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Создание анимированных GIF файлов</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:long_time:bokeh" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Использование Bokeh для сравнения графиков</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:long_time:empirical" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Практический анализ решения</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:analysis" style="font-size: 80%;"><b>Анализ конечно-разностной схемы</b></a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:analysis:deriv" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Вывод решения конечно-разностной схемы</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:analysis:ex:disc" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Точное дискретное решение</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:analysis:conv" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Сходимость</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:analysis:glob_error" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Глобальная погрешность</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:analysis:stab" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Устойчивость</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable001.html#fdm-for-ode:analysis:stan_bound" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;О точности при границе устойчивости</a></li>
     <!-- navigation toc: --> <li><a href="#fdm-for-ode:gen" style="font-size: 80%;"><b>Обобщения: затухание, нелинейные струны и внешние воздействия</b></a></li>
     <!-- navigation toc: --> <li><a href="#fdm-for-ode:gen:lin_damp" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Разностная схема для линейного затухания</a></li>
     <!-- navigation toc: --> <li><a href="#fdm-for-ode:gen:quad_damp" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Разностная схема для квадратичного затухания</a></li>
     <!-- navigation toc: --> <li><a href="#fdm-for-ode:gen:impl" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Программная реализация</a></li>
     <!-- navigation toc: --> <li><a href="#fdm-for-ode:gen:verif" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Верификация реализации алгоритма</a></li>
     <!-- navigation toc: --> <li><a href="#fdm-for-ode:gen:verif:const_sol" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Постоянное решение</a></li>
     <!-- navigation toc: --> <li><a href="#fdm-for-ode:gen:verif:lin_sol" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Линейная функция как решение</a></li>
     <!-- navigation toc: --> <li><a href="#fdm-for-ode:gen:verif:quad_sol" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Квадратичная функция как решение</a></li>
     <!-- navigation toc: --> <li><a href="#fdm-for-ode:gen:vis" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Визуализация</a></li>
     <!-- navigation toc: --> <li><a href="#fdm-for-ode:gen:user_int" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Интерфейс командной строки</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable003.html#fdm-for-ode:exercises" style="font-size: 80%;"><b>Упражнения и задачи</b></a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable003.html#fdm-for-ode:exercises:1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Упражнение 1: Использование ряда Тейлора для вычисления \( y^1 \)</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable003.html#fdm-for-ode:exercises:2" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Упражнение 2: Использование точного дискретного решения для тестирования</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable003.html#fdm-for-ode:exercises:3" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Упражнение 3: Использование линейной и квадратичной функций для тестирования</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable003.html#fdm-for-ode:exercises:4" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Упражнение 4: Показать линейный рост фазы со временем</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable003.html#fdm-for-ode:exercises:5" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Упражнение 5: Улучшить точность регуляризацией частоты</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable003.html#fdm-for-ode:exercises:6" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Упражнение 6: Визуализация аппроксимации разностных производных для косинуса</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable003.html#fdm-for-ode:exercises:7" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Упражнение 7: Минимизация использования памяти</a></li>
     <!-- navigation toc: --> <li><a href="._fdm-for-ode-readable003.html#fdm-for-ode:exercises:pr:1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Задача 8: Использование линейной и квадратичной функций для тестирования</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0002"></a>
<!-- !split -->

<h1 id="fdm-for-ode:gen" class="anchor">Обобщения: затухание, нелинейные струны и внешние воздействия</h1>

<p>
Рассмотрим обобщение задачи, рассмотренной в разделе
<a href="._fdm-for-ode-readable001.html#fdm-for-ode:fdd">Конечно-разностная дискретизация</a>, учитывающее возможные затухания \( f(u') \),
нелинейную пружину (или сопротивление) \( s(u) \) и некоторое внешнее
воздействие \( F(t) \): 

$$
\begin{align}
\tag{17}
   m u'' + f(u') + s(u) = F(t), \quad t \in (0, T], \\
\tag{18}
   u(0) = U,  \quad u'(0) = V. 
\end{align}
$$

<p>
Здесь \( m \), \( f(u') \), \( s(u) \), \( F(t) \), \( U \), \( V \) и \( T \) --- входные 
параметры.

<p>
Будем рассматривать два основных типа затуханий (силы трения):
линейное \( f(u') = b u' \) и квадратичное \( f(u') = bu'|u'| \). Пружинные
системы часто характеризуются линейным затуханием, 
при этом сопротивление воздуха описывается квадратичным
затуханием. Сила сжатие пружины часто линейны: \( s(u) = cu \),
однако бывают и нелинейными, наиболее известный пример --- силы
тяжести, действующие на маятник, которые описываются нелинейным
слагаемым \( s(u) \sim \sin(u) \).

<h2 id="fdm-for-ode:gen:lin_damp" class="anchor">Разностная схема для линейного затухания</h2>

<p>
Для приближенного решения уравнения
<a href="#mjx-eqn-17">(17)</a>--<a href="#mjx-eqn-18">(18)</a> в
случае линейного затухания будем использовать следующую разностную
схему: 

$$
\begin{align}
\tag{19}
   m y_{\bar{t}t}^n + b y_{\mathring{t}}^n + s(y^n) = F^n, \quad
   n = 1, 2, \ldots, N-1, \\
\tag{20}
   y^0 = U, \quad y_{\mathring{t}}^0 =
   \frac{y^1 - y^{-1}}{2\tau} = V.
\end{align}
$$

<p>
Перепишем задачу <a href="#mjx-eqn-19">(19)</a> &ndash;
<a href="#mjx-eqn-20">(20)</a>в индексной форме: 

$$
\begin{align}
\tag{21}
   m\frac{y^{n+1} - 2y^n +y^{n-1}}{\tau^2} + b\frac{y^{n+1} -
   y^{n-1}}{2\tau} + s(y^n) = F^n, \quad
   n = 1, 2, \ldots, N - 1, \\
\tag{22}
   y^0 = U, \quad \frac{y^1 - y^{-1}}{2\tau} = V.
\end{align}
$$

<p>
Решая разностное уравнение <a href="#mjx-eqn-21">(21)</a>
относительно неизвестной \( y^{n+1} \), получим следующую рекуррентную
формулу: 

$$
\begin{equation}
\tag{23}
   y^{n+1} = \frac{2m y^n + (0.5\tau - m)y^{n-1} + \tau^2(F^n -
   s(y^n))}{m + 0.5b\tau}, \quad n = 1, 2, \ldots, N-1.
\end{equation}
$$

<p>
При \( n=0 \) с учетом второго начального условия имеем

$$
\begin{equation}
\tag{24}
   y^1 = y^0 + \tau V + \frac{\tau^2}{2m} (F^0 - s(y^0) - b V).
\end{equation}
$$

<h2 id="fdm-for-ode:gen:quad_damp" class="anchor">Разностная схема для квадратичного затухания</h2>

<p>
Пусть \( f(u') = b u'|u'| \). Аппроксимацию \( f(u') \) выполним,
основываясь на использовании геометрического среднего:

$$
   (w^2)^n \approx w^{n-1/2}w^{n+1/2},
$$

<p>
где \( w \) --- некоторая сеточная функция. Погрешность при
использовании геометрического среднего имеет порядок
\( O(\tau^2) \), такой же как и при аппроксимации второй
производной. При \( w = u' \) имеем

$$
   (u'|u'|)^n \approx u'(t_{n+1/2}) |u'(t_{n-1/2})|.
$$

<p>
Для аппроксимации \( u' \) в точках \( t_{n\pm 1} \) воспользуемся
направленными разностями, которые имеют второй порядок аппроксимации
относительно полуцелых точек:

$$
   u'(t_{n+1/2}) \approx \frac{y^{n+1} - y^{n}}{\tau} = y_t^n, \quad
   u'(t_{n-1/2}) \approx \frac{y^{n} - y^{n-1}}{\tau} = y_{\bar{t}}^n.
$$

<p>
Таким образом, получим разностное уравнение

$$
\begin{equation}
\tag{25}
   m y_{\bar{t}t}^n + by_t^n y_{\bar{t}}^n + s(y^n) = F^n, \quad n =
   1, 2, \ldots, N - 1,
\end{equation}
$$

<p>
которая является линейной относительно \( y^{n+1} \):

$$
\begin{equation}
\tag{26}
   y^{n+1} = \frac{2m y^n - m y^{n-1} + by^n |y^n - y^{n-1}| +
   \tau^2(F^n - s(y^n))}{m + b|y^{n} - y^{n-1}|}.
\end{equation}
$$

<p>
При использовании аппроксимации второго начального условия из
<a href="#mjx-eqn-20">(20)</a> мы получим сложное
нелинейное выражение для \( y^1 \). Однако, можно построить аппроксимацию,
линейную относительно \( y^1 \). Для \( t = 0 \) имеем
\( u'(0)|u'(0)| = b V|V| \). Используя это выражение в уравнении
<a href="#mjx-eqn-25">(25)</a> и значение \( u(0) = U \) при аппроксимации
уравнения <a href="#mjx-eqn-17">(17)</a>, записанного при \( t = 0 \), получим 

$$
   m y_{\bar{t}t}^1 + b V|V| + s(U) = F^0.
$$

<p>
Отсюда, учитывая второе начальное условие из
<a href="#mjx-eqn-20">(20)</a>, получим выражение для
вычисления \( y^1 \) 

$$
\begin{equation}
\tag{27}
   y^1 = y^0 + \tau V + \frac{\tau^2}{2m} (F^0 - m V|V| - s(U)).
\end{equation}
$$

<h2 id="fdm-for-ode:gen:impl" class="anchor">Программная реализация</h2>

<p>
Алгоритмы для линейного и квадратичного затуханий, построенные в
предыдущих разделах, аналогичны алгоритму для незатухающей
модели. Отличие только в формулах для \( y^1 \) и \( y^{n+1} \).

<p>
Таким образом, для приближенного решения задачи необходимо выполнить
следующие шаги:

<ol>
<li> \( y^0 = U \);</li>
<li> вычисляем \( y^1 \), используя <a href="#mjx-eqn-24">(24)</a> для линейного затухания или <a href="#mjx-eqn-27">(27)</a> для квадратичного затухания;</li>
<li> для \( n = 1, 2, \ldots, N-1 \):

<ol type="a"></li>
  <li> вычисляем \( y^{n+1} \), используя <a href="#mjx-eqn-23">(23)</a> для линейного затухания или <a href="#mjx-eqn-26">(26)</a> для квадратичного затухания.</li> 
</ol>

</ol>

Соответствующая функция <code>solver</code> представлена ниже:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">solver</span>(U, V, m, b, s, F, tau, T, damping<span style="color: #666666">=</span><span style="color: #BA2121">&#39;linear&#39;</span>):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;</span>
<span style="color: #BA2121; font-style: italic">    Решает задачу m*u&#39;&#39; + f(u&#39;) + s(u) = F(t) for t in (0,T],</span>
<span style="color: #BA2121; font-style: italic">    u(0)=U и u&#39;(0)=V,</span>
<span style="color: #BA2121; font-style: italic">    конечно-разностной схемой с шагом tau.</span>
<span style="color: #BA2121; font-style: italic">    Если затухание &#39;liniear&#39;, то f(u&#39;)=b*u, если затухание &#39;quadratic&#39;, </span>
<span style="color: #BA2121; font-style: italic">    то f(u&#39;)=b*u&#39;*abs(u&#39;).</span>
<span style="color: #BA2121; font-style: italic">    F(t) и s(u) --- функции Python.</span>
<span style="color: #BA2121; font-style: italic">    &quot;&quot;&quot;</span>
    tau <span style="color: #666666">=</span> <span style="color: #008000">float</span>(tau); b <span style="color: #666666">=</span> <span style="color: #008000">float</span>(b); m <span style="color: #666666">=</span> <span style="color: #008000">float</span>(m) <span style="color: #408080; font-style: italic"># avoid integer div.</span>
    N <span style="color: #666666">=</span> <span style="color: #008000">int</span>(<span style="color: #008000">round</span>(T<span style="color: #666666">/</span>tau))
    u <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros(N<span style="color: #666666">+1</span>)
    t <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0</span>, N<span style="color: #666666">*</span>tau, N<span style="color: #666666">+1</span>)

    u[<span style="color: #666666">0</span>] <span style="color: #666666">=</span> U
    <span style="color: #008000; font-weight: bold">if</span> damping <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;linear&#39;</span>:
        u[<span style="color: #666666">1</span>] <span style="color: #666666">=</span> u[<span style="color: #666666">0</span>] <span style="color: #666666">+</span> tau<span style="color: #666666">*</span>V <span style="color: #666666">+</span> tau<span style="color: #666666">**2/</span>(<span style="color: #666666">2*</span>m)<span style="color: #666666">*</span>(<span style="color: #666666">-</span>b<span style="color: #666666">*</span>V <span style="color: #666666">-</span> s(u[<span style="color: #666666">0</span>]) <span style="color: #666666">+</span> F(t[<span style="color: #666666">0</span>]))
    <span style="color: #008000; font-weight: bold">elif</span> damping <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;quadratic&#39;</span>:
        u[<span style="color: #666666">1</span>] <span style="color: #666666">=</span> u[<span style="color: #666666">0</span>] <span style="color: #666666">+</span> tau<span style="color: #666666">*</span>V <span style="color: #666666">+</span> \ 
               tau<span style="color: #666666">**2/</span>(<span style="color: #666666">2*</span>m)<span style="color: #666666">*</span>(<span style="color: #666666">-</span>b<span style="color: #666666">*</span>V<span style="color: #666666">*</span><span style="color: #008000">abs</span>(V) <span style="color: #666666">-</span> s(u[<span style="color: #666666">0</span>]) <span style="color: #666666">+</span> F(t[<span style="color: #666666">0</span>]))

    <span style="color: #008000; font-weight: bold">for</span> n <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(<span style="color: #666666">1</span>, N):
        <span style="color: #008000; font-weight: bold">if</span> damping <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;linear&#39;</span>:
            u[n<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> (<span style="color: #666666">2*</span>m<span style="color: #666666">*</span>u[n] <span style="color: #666666">+</span> (b<span style="color: #666666">*</span>tau<span style="color: #666666">/2</span> <span style="color: #666666">-</span> m)<span style="color: #666666">*</span>u[n<span style="color: #666666">-1</span>] <span style="color: #666666">+</span>
                      tau<span style="color: #666666">**2*</span>(F(t[n]) <span style="color: #666666">-</span> s(u[n])))<span style="color: #666666">/</span>(m <span style="color: #666666">+</span> b<span style="color: #666666">*</span>tau<span style="color: #666666">/2</span>)
        <span style="color: #008000; font-weight: bold">elif</span> damping <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;quadratic&#39;</span>:
            u[n<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> (<span style="color: #666666">2*</span>m<span style="color: #666666">*</span>u[n] <span style="color: #666666">-</span> m<span style="color: #666666">*</span>u[n<span style="color: #666666">-1</span>] <span style="color: #666666">+</span> b<span style="color: #666666">*</span>u[n]<span style="color: #666666">*</span><span style="color: #008000">abs</span>(u[n] <span style="color: #666666">-</span> u[n<span style="color: #666666">-1</span>])
                      <span style="color: #666666">+</span> tau<span style="color: #666666">**2*</span>(F(t[n]) <span style="color: #666666">-</span> s(u[n])))<span style="color: #666666">/</span>\ 
                      (m <span style="color: #666666">+</span> b<span style="color: #666666">*</span><span style="color: #008000">abs</span>(u[n] <span style="color: #666666">-</span> u[n<span style="color: #666666">-1</span>]))
    <span style="color: #008000; font-weight: bold">return</span> u, t
</pre></div>

<h2 id="fdm-for-ode:gen:verif" class="anchor">Верификация реализации алгоритма</h2>

<h3 id="fdm-for-ode:gen:verif:const_sol" class="anchor">Постоянное решение</h3>

<p>
Для отладки и начальной верификации часто полезно использовать
постоянное решение. Выбор \( u_e(t) = U \) дает
\( V=0 \). Подставляя в уравнение, получим \( F(t) = s(U) \) при
любом выборе функции \( f \). Так как разностная производная от
константы равна нулю, то постоянное решение удовлетворяет также
разностному уравнению. Следовательно, константа должна
воспроизводиться с машинной точностью. Этот тест реализован в функции

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">test_constant</span>():
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Тестирование постоянного решения.&quot;&quot;&quot;</span>
    u_exact <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> t: U
    U <span style="color: #666666">=</span> <span style="color: #666666">1.2</span>; V <span style="color: #666666">=</span> <span style="color: #666666">0</span>; m <span style="color: #666666">=</span> <span style="color: #666666">2</span>; b <span style="color: #666666">=</span> <span style="color: #666666">0.9</span>
    omega <span style="color: #666666">=</span> <span style="color: #666666">1.5</span>
    s <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> u: omega<span style="color: #666666">**2*</span>u
    F <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">lambda</span> t: omega<span style="color: #666666">**2*</span>u_exact(t)
    tau <span style="color: #666666">=</span> <span style="color: #666666">0.2</span>
    T <span style="color: #666666">=</span> <span style="color: #666666">2</span>
    u, t <span style="color: #666666">=</span> solver(U, V, m, b, s, F, tau, T, <span style="color: #BA2121">&#39;linear&#39;</span>)
    difference <span style="color: #666666">=</span> np<span style="color: #666666">.</span>abs(u_exact(t) <span style="color: #666666">-</span> u)<span style="color: #666666">.</span>max()
    tol <span style="color: #666666">=</span> <span style="color: #666666">1E-13</span>
    <span style="color: #008000; font-weight: bold">assert</span> difference <span style="color: #666666">&lt;</span> tol

    u, t <span style="color: #666666">=</span> solver(U, V, m, b, s, F, tau, T, <span style="color: #BA2121">&#39;quadratic&#39;</span>)
    difference <span style="color: #666666">=</span> np<span style="color: #666666">.</span>abs(u_exact(t) <span style="color: #666666">-</span> u)<span style="color: #666666">.</span>max()
    <span style="color: #008000; font-weight: bold">assert</span> difference <span style="color: #666666">&lt;</span> tol
</pre></div>

<h3 id="fdm-for-ode:gen:verif:lin_sol" class="anchor">Линейная функция как решение</h3>

<p>
Теперь в качестве тестового решения выберем линейную функцию:
\( u_e(t) = ct + d \). Начальное условие \( u(0) = U \) дает
\( d = U \), а из второго начального условия \( u'(0) = V \)
получим, что \( c = V \). Подставляя \( u_e(t) = Vt + U \) в
уравнение с линейным затуханием, имеем

$$
   0 + bV + s(Vt + U) = F(t),
$$

<p>
а для квадратичного затухания:

$$
   0 + bV|V| + s(Vt + U) = F(t).
$$

<p>
Так как все разностные аппроксимации используемые для \( u' \) точны
для линейных функций, то линейная функция \( u_e \) также является
решением разностной задачи.

<h3 id="fdm-for-ode:gen:verif:quad_sol" class="anchor">Квадратичная функция как решение</h3>

<p>
Функция \( u_e(t) = bt^2 + Vt + U \) с произвольной постоянной
\( b \) удовлетворяет начальным данным и уравнению с соответствующим
выбором \( F(t) \). Такая функция является также решением
разностного уравнения с линейным затуханием. Однако, полином второй
степени от \( t \) не удовлетворяет разностному уравнению в случае
квадратичного затухания.

<p>
Выполните упражнение <a href="._fdm-for-ode-readable003.html#fdm-for-ode:exercises:3">Упражнение 3: Использование линейной и квадратичной функций для тестирования</a>.

<h2 id="fdm-for-ode:gen:vis" class="anchor">Визуализация</h2>

<p>
Функции для визуализации будут существенно отличаться от случая
незатухающего решения, так как мы не знаем точного решения. Кроме
того, у нас нет тех параметров, которые мы могли оценить в случае
затухающих колебаний (периода колебаний, угловой частоты и
т.п.). Поэтому пользователь должен задавать значение \( T \) и
ширину окна.

<p>
Сценарий <a href="src-fdm-for-ode/vib.py" target="_self">vib.py</a> содержит несколько функций для
визуализации решения.

<h2 id="fdm-for-ode:gen:user_int" class="anchor">Интерфейс командной строки</h2>

<p>
Функция <code>main</code> также существенно отличается от сценария,
используемого для незатухающих колебаний, так как мы должны задавать
дополнительные данные \( s(u) \) и \( F(t) \). Кроме того, нужно
задавать \( T \) и ширину окна (вместо количества периодов). Для
того чтобы понять можем мы строить один график для всего
временного интервала или отображать только некоторую последнюю часть
временного интервала, можно воспользоваться функцией
<code>plot_empricial_freq_and_amplitude</code> для оценки количества локальных
максимумов. Это количество сейчас возвращается функцией и используется
в функции <code>main</code>.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">main</span>():
    <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">argparse</span>
    parser <span style="color: #666666">=</span> argparse<span style="color: #666666">.</span>ArgumentParser()
    parser<span style="color: #666666">.</span>add_argument(<span style="color: #BA2121">&#39;--U&#39;</span>, <span style="color: #008000">type</span><span style="color: #666666">=</span><span style="color: #008000">float</span>, default<span style="color: #666666">=1.0</span>)
    parser<span style="color: #666666">.</span>add_argument(<span style="color: #BA2121">&#39;--V&#39;</span>, <span style="color: #008000">type</span><span style="color: #666666">=</span><span style="color: #008000">float</span>, default<span style="color: #666666">=0.0</span>)
    parser<span style="color: #666666">.</span>add_argument(<span style="color: #BA2121">&#39;--m&#39;</span>, <span style="color: #008000">type</span><span style="color: #666666">=</span><span style="color: #008000">float</span>, default<span style="color: #666666">=1.0</span>)
    parser<span style="color: #666666">.</span>add_argument(<span style="color: #BA2121">&#39;--b&#39;</span>, <span style="color: #008000">type</span><span style="color: #666666">=</span><span style="color: #008000">float</span>, default<span style="color: #666666">=0.0</span>)
    parser<span style="color: #666666">.</span>add_argument(<span style="color: #BA2121">&#39;--s&#39;</span>, <span style="color: #008000">type</span><span style="color: #666666">=</span><span style="color: #008000">str</span>, default<span style="color: #666666">=</span><span style="color: #BA2121">&#39;u&#39;</span>)
    parser<span style="color: #666666">.</span>add_argument(<span style="color: #BA2121">&#39;--F&#39;</span>, <span style="color: #008000">type</span><span style="color: #666666">=</span><span style="color: #008000">str</span>, default<span style="color: #666666">=</span><span style="color: #BA2121">&#39;0&#39;</span>)
    parser<span style="color: #666666">.</span>add_argument(<span style="color: #BA2121">&#39;--tau&#39;</span>, <span style="color: #008000">type</span><span style="color: #666666">=</span><span style="color: #008000">float</span>, default<span style="color: #666666">=0.05</span>)
    parser<span style="color: #666666">.</span>add_argument(<span style="color: #BA2121">&#39;--T&#39;</span>, <span style="color: #008000">type</span><span style="color: #666666">=</span><span style="color: #008000">float</span>, default<span style="color: #666666">=10</span>)
    parser<span style="color: #666666">.</span>add_argument(<span style="color: #BA2121">&#39;--window_width&#39;</span>, <span style="color: #008000">type</span><span style="color: #666666">=</span><span style="color: #008000">float</span>, default<span style="color: #666666">=30.</span>,
                        help<span style="color: #666666">=</span><span style="color: #BA2121">&#39;Number of periods in a window&#39;</span>)
    parser<span style="color: #666666">.</span>add_argument(<span style="color: #BA2121">&#39;--damping&#39;</span>, <span style="color: #008000">type</span><span style="color: #666666">=</span><span style="color: #008000">str</span>, default<span style="color: #666666">=</span><span style="color: #BA2121">&#39;linear&#39;</span>)
    parser<span style="color: #666666">.</span>add_argument(<span style="color: #BA2121">&#39;--savefig&#39;</span>, action<span style="color: #666666">=</span><span style="color: #BA2121">&#39;store_true&#39;</span>)
    parser<span style="color: #666666">.</span>add_argument(<span style="color: #BA2121">&#39;--SCITOOLS_easyviz_backend&#39;</span>, default<span style="color: #666666">=</span><span style="color: #BA2121">&#39;matplotlib&#39;</span>)
    a <span style="color: #666666">=</span> parser<span style="color: #666666">.</span>parse_args()
    <span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">scitools.std</span> <span style="color: #008000; font-weight: bold">import</span> StringFunction
    s <span style="color: #666666">=</span> StringFunction(a<span style="color: #666666">.</span>s, independent_variable<span style="color: #666666">=</span><span style="color: #BA2121">&#39;u&#39;</span>)
    F <span style="color: #666666">=</span> StringFunction(a<span style="color: #666666">.</span>F, independent_variable<span style="color: #666666">=</span><span style="color: #BA2121">&#39;t&#39;</span>)
    U, V, m, b, tau, T, window_width, savefig, damping <span style="color: #666666">=</span> \ 
       a<span style="color: #666666">.</span>U, a<span style="color: #666666">.</span>V, a<span style="color: #666666">.</span>m, a<span style="color: #666666">.</span>b, a<span style="color: #666666">.</span>tau, a<span style="color: #666666">.</span>T, a<span style="color: #666666">.</span>window_width, a<span style="color: #666666">.</span>savefig, \ 
       a<span style="color: #666666">.</span>damping

    u, t <span style="color: #666666">=</span> solver(U, V, m, b, s, F, tau, T, damping)
    num_periods <span style="color: #666666">=</span> plot_empirical_freq_and_amplitude(u, t)
    num_periods <span style="color: #666666">=</span> <span style="color: #666666">4</span>
    tit <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;tau = </span><span style="color: #BB6688; font-weight: bold">%g</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> tau
    <span style="color: #008000; font-weight: bold">if</span> num_periods <span style="color: #666666">&lt;=</span> <span style="color: #666666">40</span>:
        plt<span style="color: #666666">.</span>figure()
        visualize(u, t, title<span style="color: #666666">=</span>tit)
    <span style="color: #008000; font-weight: bold">else</span>:
        visualize_front(u, t, window_width, savefig)
        visualize_front_ascii(u, t)
    plt<span style="color: #666666">.</span>show()
</pre></div>
<p>
Сценарий <a href="src-fdm-for-ode/vib.py" target="_self">vib.py</a> содержит представленный
выше фрагмент кода и решает модельную задачу
<a href="#mjx-eqn-17">(17)</a>--<a href="#mjx-eqn-18">(18)</a>. качестве
примера использования 
<a href="src-fdm-for-ode/vib.py" target="_self">vib.py</a> 
рассмотрим случай, когда \( I = 1 \), \( V = 0 \), \( m = 1 \),
\( s(u) = \sin(u) \), \( F(t) = 3\cos(4t) \), \( \tau=0.05 \) и
\( T = 140 \). Соответствующий вызов сценария будет выглядеть
следующим образом:

<p>

<!-- code=bash (!bc shcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>Terminal&gt; python vib.py --s <span style="color: #BA2121">&#39;sin(u)&#39;</span> --F <span style="color: #BA2121">&#39;3*cos(4*t)&#39;</span> --T <span style="color: #666666">140</span>
</pre></div>
<p>
<!-- Local Variables: -->
<!-- doconce-chapter-nickname: "fdm-for-ode" -->
<!-- doconce-section-nickname: "gen" -->
<!-- End: -->
<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">
  <li class="previous">
    <a href="._fdm-for-ode-readable001.html">&larr; Prev</a>
  </li>
  <li class="next">
    <a href="._fdm-for-ode-readable003.html">Next &rarr;</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


</body>
</html>
    

