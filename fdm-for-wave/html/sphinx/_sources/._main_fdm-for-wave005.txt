.. !split

.. _fdm-for-wave:exercises2:

Упражнения          (2)
=======================

.. --- begin exercise ---

.. _fdm-for-wave:exercises2:1:

Exercise 6: Нахождение аналитического решения волнового уравнения с затуханием
------------------------------------------------------------------------------

Рассмотрим волновое уравнение с затуханием
:ref:`(44) <Eq:fdm-for-wave:damping:eq:vibr>`. Цель упражнения --- найти точное
решение задачи с затуханием. Отправная точка --- стоячая волна из
:ref:`fdm-for-wave:exercises:1`. Необходимо включить множитель затухания
:math:`e^{-ct}`, а также синусоидальной и косинусоидальные компоненты по
времени:

.. math::
        
        u_e(x,t) =  e^{-\beta t}
        \sin kx \left( A\cos\omega t + B\sin\omega t\right).
        

Найти :math:`k`, используя граничные условия :math:`u(0,t) = u(l,t) = 0`. Затем
используйте уравнение для нахождения ограничений на :math:`\beta`, :math:`\omega`,
:math:`A` и :math:`B`. Сформулируйте полную начально-краевую задачу и ее решение.
Filename: ``damped_waves``.

.. --- end exercise ---

.. --- begin exercise ---

.. _fdm-for-wave:exercises2:2:

Problem 7: Анализ симметричных граничных условий
------------------------------------------------

Рассмотрим простую волну-"площадку", где :math:`\Omega = [-l, l]` и

.. math::
        
        I(x) = \begin{cases}
        1, & x \in [-\delta, \delta],\\ 
        0, \textrm{иначе},
        \end{cases}
        

для некоторого числа :math:`0 < \delta < l`. Второе начальное условие ---
:math:`\frac{\partial u(x,0)}{\partial t} = 0`. Предположим также, что отсутствует правая часть
:math:`f`. В качестве граничных условий выберем однородные условия
Дирихле. Решение данной задачи симметрично относительно :math:`x = 0`. Это
означает, что мы можем проводить моделирование только на половине
области :math:`[0,l]`.

**1)** Показать почему симметричным граничным условием будет :math:`\frac{\partial u}{\partial x}
= 0` при :math:`x = 0`.

**2)** Выполнить расчет задачи для волнового уравнения на отрезке
:math:`[-l,l]`. После этого, используйте симметричность решения и выполните
расчет в половине области :math:`[0,l]`, используя симметричное граничное
условие при :math:`x = 0`. Сравните два решения и удостоверьтесь в том, что
они совпадают.

**3)** Докажите симметричность решения, сформулировав начально-краевую
задачу и показав, что если :math:`u(x,t)` --- решение задачи, то и :math:`u(-x,t)`
также является решением этой задачи.

.. --- begin hint in exercise ---

**Hint.**
Симметричность функции относительно :math:`x_0 = 0` означает, что :math:`f(x_0+h)
= f(x_0 - h)`.

.. --- end hint in exercise ---

Filename: ``waved1d_symmetric``.

.. --- end exercise ---

.. --- begin exercise ---

.. _fdm-for-wave:exercises2:3:

Exercise 8: Имульс через слоистую среду
---------------------------------------

Используйте функцию ``pulse`` из
`wave1d_dn_vc.py <src-fdm-for-wave/wave1d_dn_vc.py>`__ для того, чтобы
исследовать распространение импульса, чей начальный пик расположен в
:math:`x=0`, через две среды с разными скоростями распространения
волн. Скорость распространения волны в левой области положить равной
:math:`1`, а в правой области --- :math:`s_f`. Показать, что происходит для
разных импульсов при :math:`N_x = 40, 80, 160` и :math:`s_f = 2, 4`. Моделирование
проводить до :math:`T = 2`.
Filename: ``pulse1d.py``.

.. --- end exercise ---

.. --- begin exercise ---

.. _fdm-for-wave:exercises2:4:

Exercise 9: Объяснение почему возникают численные шумы
------------------------------------------------------

Эксперименты из :ref:`fdm-for-wave:exercises2:3` показывают существенные
численные шумы (осцилляции) в виде нифизичных колебаний, особенно для
:math:`s_f = 4` и импульса площадки (``plug``) или ``half-cosinehat``
импульса. Шумы менее видны для Гауссового импульса. Выполните варианты
расчетов для импульсов ``plug`` и ``half-cosinehat`` при :math:`s_f = 1`,
:math:`\gamma = 0.9, 0.25` и :math:`N_x = 40, 80, 160`. Используйте отношение
численной дисперсии для обоснования результатов.
Filename: ``pulse1d_analysis``.

.. --- end exercise ---

.. --- begin exercise ---

.. _fdm-for-wave:exercises2:5:

Exercise 10: Исследование гармонического среднего в одномерной модели
---------------------------------------------------------------------

Гармонические средние часто используются, когда скорость
распространения волны негладкая или разрывная. Даст ли меньшие шумы
использование гармонического среднего при аппроксимации коэффициента
уравнения для :math:`s_f=4` в :ref:`fdm-for-wave:exercises2:4`?
Filename: ``pulse1d_harmonic.py``.

.. --- end exercise ---

.. --- begin exercise ---

.. _fdm-for-wave:exercises2:6:

Problem 11: Реализация условий открытых границ
----------------------------------------------

Для того, чтобы дать возможность волне покинуть вычислительную область
и перемещаться без искажений через границу :math:`x=l`, в одномерной модели
можно наложить следующее условие, называемое *условием излучения* или
*условием открытой границы*:

.. _Eq:fdm-for-wave:exercises2:eq:right_open_bound:

.. math::

    \tag{52}
    \frac{\partial u}{\partial t} + c \frac{\partial u}{\partial x} = 0.
        

Параметр :math:`c` --- скорость распространения волны.

Показать, что 
:ref:`(52) <Eq:fdm-for-wave:exercises2:eq:right_open_bound>` допускает решение :math:`u =
g_R(x - ct)` (волна, бегущая вправо), но не :math:`u = g_L(x + ct)` (волна,
бегущая влево).

Соответствующее условие открытой границы при :math:`x=0` имеет вид

.. _Eq:fdm-for-wave:exercises2:eq:left_open_bound:

.. math::

    \tag{53}
    \frac{\partial u}{\partial t} - c \frac{\partial u}{\partial x} = 0.
        

**1)** Естественная идея аппроксимации граничного условия 
:ref:`(52) <Eq:fdm-for-wave:exercises2:eq:right_open_bound>` в конечном узле с
индексом :math:`i = N` заключается в использовании центральных разностных
производных по пространственной и временной перемменной:

.. _Eq:fdm-for-wave:exercises2:eq:right_open_bound_fds:

.. math::

    \tag{54}
    y_{\mathring{t},N}^n + c y_{\mathring{x},N}^n = 0. 
        

Избавиться от фиктивного значения :math:`y_{N+1}^n`, используя аппроксимацию
уравнения в этой же точке.

Уравнение для :math:`y_i^1` также нарушается, мы можем использовать условие
:math:`u_N^1=0`, так как волна еще не достигла правой границы.

**2)** Более удобная реализация условия открытой границы при :math:`x = l`
может основываться на явной дискретизации

.. _Eq:fdm-for-wave:exercises2:eq:right_open_bound_fds_exp:

.. math::

    \tag{55}
    y_{t,N}^n + c y_{\bar{x},N}^n = 0.
        

Из этого уравнения можно найти :math:`y_N^{n+1}` и его как условие
Дирихле. Однако, в этом случае аппроксимация будет иметь первый
порядок.

Реализовать эту схему для волнового уравнения :math:`\frac{\partial^2 u}{\partial t^2} = c^2
\frac{\partial^2 u}{\partial x^2}` на отрезке :math:`[0,l]` с граничным условием :math:`\frac{\partial u}{\partial x} = 0`
при :math:`x = 0`, условием 
:ref:`(52) <Eq:fdm-for-wave:exercises2:eq:right_open_bound>` при :math:`x = l`, и начальным
возмущением в центре отрезка, например, профиль-площадка вида

.. math::
        
        	u(x,0) = \begin{cases}
        	1, & l/2-\ell \leq x \leq l/2+\ell,\\ 
        	0, &\textrm{в противном случае}.
        	\end{cases}
        

Обратите внимание на то, что начальный профиль распадается на две
площадки, волна, бегущая влево, отражается от границы :math:`x = 0`, и обе
волны уходят за границу :math:`x = l`, оставляя в итоге решение :math:`u = 0`
на :math:`[0, l]`. Используйте число Куранта равное единице, что позволит
получить точное решение. Создать анимированный график.

**3)** Добавить возможность задание либо условия :math:`\frac{\partial u}{\partial x} = 0`, либо
условия открытой границы при :math:`x=0`. Последнее условие аппроксимировать
как

.. math::
        
        	y_{t,0}^n - c y_{x,i}^n = 0,
        

дающее возможность явного вычисления :math:`y_0^{n+1}`.

Реализацию можно протестировать на функции Гаусса как начальном
условии:

.. math::
        
        	g(x; m, s) = \frac{1}{\sqrt{2\pi} s}e^{-\frac{(x-m)^2}{2s^2}}.
        

Выполнить два теста:
1. Возмущение в центре области, :math:`I(x) = g(x; l/2, s)` и открытой левой

границей.
1. Возмущение на левом конце области, :math:`I(x) = g(x; 0, s)` и условием

симметрии :math:`\frac{\partial u}{\partial x} = 0` на левой границе.

Создать юнит-тесты для обоих случаев, проверяющие, что решение равно
нулю после того, как волна покинет область.

.. --- begin hint in exercise ---

**Hint.**
Модифицируйте солвер из `wave1d_n.py <src-fdm-for-wave/wave1d_n.py>`__.

.. --- end hint in exercise ---

Filename: ``wave1d_open_bc.py``.

.. Local Variables:

.. doconce-chapter-nickname: "fdm-for-wave"

.. doconce-section-nickname: "exercises2"

.. End:

.. Local Variables:

.. doconce-chapter-nickname: "fdm-for-wave"

.. End:

.. --- end exercise ---
