<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="Машинное обучение с использованием библиотек Python">

<title>Машинное обучение с использованием библиотек Python</title>

<!-- Bootstrap style: bootswatch_flatly -->
<link href="https://netdna.bootstrapcdn.com/bootswatch/3.1.1/flatly/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">

/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}

/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:60px;      /* fixed header height for style bootswatch_flatly */
  margin:-60px 0 0; /* negative fixed header height */
}

body { font-size:20px; }
</style>




<!-- Tools for embedded Bokeh plots -->
<link rel=stylesheet 
      href=https://cdn.pydata.org/bokeh/release/bokeh-0.12.4.min.css 
      type=text/css />
<script type=text/javascript 
        src=https://cdn.pydata.org/bokeh/release/bokeh-0.12.4.min.js>
</script>
<script type=text/javascript>
  Bokeh.set_log_level("info");
</script>

<style>
.bk-embeded {
    width: 100%;
    margin: auto;
    height: 500px;
    text-align: webkit-left;
}
</style>


</head>


<!-- tocinfo
{'highest level': 1,
 'sections': [('Содержание',
               1,
               'table_of_contents',
               'table_of_contents'),
              ('Основные определения и постановки задач машинного обучения',
               1,
               'ml:intro',
               'ml:intro'),
              ('Примеры задач машинного обучения',
               2,
               'ml:intro:examples',
               'ml:intro:examples'),
              ('Линейная регрессия',
               2,
               'ml:linear-regression',
               'ml:linear-regression'),
              ('Загрузка данных',
               2,
               'ml:linear-regression:load',
               'ml:linear-regression:load'),
              ('Первая модель',
               2,
               'ml:linear-regression:1st',
               'ml:linear-regression:1st'),
              ('Работа с категориальными признаками',
               2,
               'ml:linear-regression:categ',
               'ml:linear-regression:categ'),
              ('Предобработка данных', 1, 'ml:features', 'ml:features'),
              ('Работа с текстовыми данными',
               2,
               'ml:features:text-work',
               'ml:features:text-work'),
              ('Bag-of-words',
               3,
               'ml:features:bag-of-words',
               'ml:features:bag-of-words'),
              ('TF-IDF', 3, 'ml:features:tf-idf', 'ml:features:tf-idf'),
              ('Стемминг', 3, 'ml:features:stemming', 'ml:features:stemming'),
              ('Лематизация', 3, 'ml:features:lemma', 'ml:features:lemma'),
              ('Трансформация признаков и целевой переменной',
               2,
               'ml:features:trans',
               'ml:features:trans'),
              ('Логарифмирование', 3, 'ml:features:log', 'ml:features:log'),
              ('Бинаризация',
               2,
               'ml:features:binarize',
               'ml:features:binarize'),
              ('Транзакционные данные',
               2,
               'ml:features:transactions',
               'ml:features:transactions'),
              ('Простые модели классификации', 1, 'ml:class', 'ml:class'),
              ('Матрица ошибок', 2, 'ml:class:conf-matr', 'ml:class:conf-matr'),
              ('Линейная классификация',
               2,
               'ml:class:linear-class',
               'ml:class:linear-class'),
              ('Логистическая регрессия',
               3,
               'ml:class:linear-class:logistic',
               'ml:class:linear-class:logistic'),
              ('Задание', 1, 'ml:task', 'ml:task'),
              ('Задание по базе wine', 2, 'ml:task:1', 'ml:task:1')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="ml-flatly.html">Машинное обучение с использованием библиотек Python</a>
  </div>

  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._ml-flatly000.html#table_of_contents" style="font-size: 80%;"><b>Содержание</b></a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly001.html#ml:intro" style="font-size: 80%;"><b>Основные определения и постановки задач машинного обучения</b></a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly001.html#ml:intro:examples" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Примеры задач машинного обучения</a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly002.html#ml:linear-regression" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Линейная регрессия</a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly002.html#ml:linear-regression:load" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Загрузка данных</a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly002.html#ml:linear-regression:1st" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Первая модель</a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly002.html#ml:linear-regression:categ" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Работа с категориальными признаками</a></li>
     <!-- navigation toc: --> <li><a href="#ml:features" style="font-size: 80%;"><b>Предобработка данных</b></a></li>
     <!-- navigation toc: --> <li><a href="#ml:features:text-work" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Работа с текстовыми данными</a></li>
     <!-- navigation toc: --> <li><a href="#ml:features:bag-of-words" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Bag-of-words</a></li>
     <!-- navigation toc: --> <li><a href="#ml:features:tf-idf" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TF-IDF</a></li>
     <!-- navigation toc: --> <li><a href="#ml:features:stemming" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Стемминг</a></li>
     <!-- navigation toc: --> <li><a href="#ml:features:lemma" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Лематизация</a></li>
     <!-- navigation toc: --> <li><a href="#ml:features:trans" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Трансформация признаков и целевой переменной</a></li>
     <!-- navigation toc: --> <li><a href="#ml:features:log" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Логарифмирование</a></li>
     <!-- navigation toc: --> <li><a href="#ml:features:binarize" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Бинаризация</a></li>
     <!-- navigation toc: --> <li><a href="#ml:features:transactions" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Транзакционные данные</a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly004.html#ml:class" style="font-size: 80%;"><b>Простые модели классификации</b></a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly004.html#ml:class:conf-matr" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Матрица ошибок</a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly004.html#ml:class:linear-class" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Линейная классификация</a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly004.html#ml:class:linear-class:logistic" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Логистическая регрессия</a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly005.html#ml:task" style="font-size: 80%;"><b>Задание</b></a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly005.html#ml:task:1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Задание по базе wine</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0003"></a>
<!-- !split -->

<h1 id="ml:features" class="anchor">&#1055;&#1088;&#1077;&#1076;&#1086;&#1073;&#1088;&#1072;&#1073;&#1086;&#1090;&#1082;&#1072; &#1076;&#1072;&#1085;&#1085;&#1099;&#1093;</h1>

<p>
&#1053;&#1072;&#1095;&#1085;&#1077;&#1084; &#1089; &#1087;&#1086;&#1076;&#1082;&#1083;&#1102;&#1095;&#1077;&#1085;&#1080;&#1103; &#1085;&#1077;&#1086;&#1073;&#1093;&#1086;&#1076;&#1080;&#1084;&#1099;&#1093; &#1073;&#1080;&#1073;&#1083;&#1080;&#1086;&#1090;&#1077;&#1082; &#1080; &#1084;&#1086;&#1076;&#1091;&#1083;&#1077;&#1081;:
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">pandas</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">pd</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">seaborn</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">sns</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">tqdm</span> <span style="color: #008000; font-weight: bold">import</span> tqdm
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.datasets</span> <span style="color: #008000; font-weight: bold">import</span> fetch_20newsgroups

<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.model_selection</span> <span style="color: #008000; font-weight: bold">import</span> train_test_split
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.linear_model</span> <span style="color: #008000; font-weight: bold">import</span> Ridge
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.metrics</span> <span style="color: #008000; font-weight: bold">import</span> mean_squared_error
</pre></div>

<h2 id="ml:features:text-work" class="anchor">&#1056;&#1072;&#1073;&#1086;&#1090;&#1072; &#1089; &#1090;&#1077;&#1082;&#1089;&#1090;&#1086;&#1074;&#1099;&#1084;&#1080; &#1076;&#1072;&#1085;&#1085;&#1099;&#1084;&#1080;</h2>

<p>
&#1050;&#1072;&#1082; &#1087;&#1088;&#1072;&#1074;&#1080;&#1083;&#1086;, &#1084;&#1086;&#1076;&#1077;&#1083;&#1080; &#1084;&#1072;&#1096;&#1080;&#1085;&#1085;&#1086;&#1075;&#1086; &#1086;&#1073;&#1091;&#1095;&#1077;&#1085;&#1080;&#1103; &#1076;&#1077;&#1081;&#1089;&#1090;&#1074;&#1091;&#1102;&#1090; &#1074; &#1087;&#1088;&#1077;&#1076;&#1087;&#1086;&#1083;&#1086;&#1078;&#1077;&#1085;&#1080;&#1080;, &#1095;&#1090;&#1086;
&#1084;&#1072;&#1090;&#1088;&#1080;&#1094;&#1072; &#171;&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;-&#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#187; &#1103;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103; &#1074;&#1077;&#1097;&#1077;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1086;&#1079;&#1085;&#1072;&#1095;&#1085;&#1086;&#1081;, &#1087;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091; &#1087;&#1088;&#1080;
&#1088;&#1072;&#1073;&#1086;&#1090;&#1077; &#1089; &#1090;&#1077;&#1082;&#1089;&#1090;&#1072;&#1084;&#1080; &#1089;&#1087;&#1077;&#1088;&#1074;&#1072; &#1076;&#1083;&#1103; &#1082;&#1072;&#1078;&#1076;&#1086;&#1075;&#1086; &#1080;&#1079; &#1085;&#1080;&#1093; &#1085;&#1077;&#1086;&#1073;&#1093;&#1086;&#1076;&#1080;&#1084;&#1086; &#1089;&#1086;&#1089;&#1090;&#1072;&#1074;&#1080;&#1090;&#1100; &#1077;&#1075;&#1086;
&#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1086;&#1074;&#1086;&#1077; &#1086;&#1087;&#1080;&#1089;&#1072;&#1085;&#1080;&#1077;. &#1044;&#1083;&#1103; &#1101;&#1090;&#1086;&#1075;&#1086; &#1096;&#1080;&#1088;&#1086;&#1082;&#1086; &#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1102;&#1090;&#1089;&#1103; &#1090;&#1077;&#1093;&#1085;&#1080;&#1082;&#1080;
&#1074;&#1077;&#1082;&#1090;&#1086;&#1088;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;, tf-idf &#1080; &#1087;&#1088;.

<p>
<!-- &#1056;&#1072;&#1089;&#1089;&#1084;&#1086;&#1090;&#1088;&#1080;&#1084; &#1080;&#1093; &#1085;&#1072; &#1087;&#1088;&#1080;&#1084;&#1077;&#1088;&#1077; -->
<!-- "&#1076;&#1072;&#1090;&#1072;&#1089;&#1077;&#1090;&#1072;": "src-features/banki_responses.json.bz2" -->
<!-- &#1086;&#1090;&#1079;&#1099;&#1074;&#1086;&#1074; &#1086; &#1073;&#1072;&#1085;&#1082;&#1072;&#1093;. -->

<p>
&#1057;&#1087;&#1077;&#1088;&#1074;&#1072; &#1079;&#1072;&#1075;&#1088;&#1091;&#1079;&#1080;&#1084; &#1076;&#1072;&#1085;&#1085;&#1099;&#1077;:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>data <span style="color: #666666">=</span> fetch_20newsgroups(subset<span style="color: #666666">=</span><span style="color: #BA2121">&#39;all&#39;</span>, categories<span style="color: #666666">=</span>[<span style="color: #BA2121">&#39;comp.graphics&#39;</span>, <span style="color: #BA2121">&#39;sci.med&#39;</span>])
</pre></div>
<p>
&#1044;&#1072;&#1085;&#1085;&#1099;&#1077; &#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1072;&#1090; &#1090;&#1077;&#1082;&#1089;&#1090;&#1099; &#1085;&#1086;&#1074;&#1086;&#1089;&#1090;&#1077;&#1081;, &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077; &#1085;&#1072;&#1076;&#1086; &#1082;&#1083;&#1072;&#1089;&#1089;&#1080;&#1092;&#1080;&#1094;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100; &#1085;&#1072; &#1088;&#1072;&#1079;&#1076;&#1077;&#1083;&#1099;.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>data[<span style="color: #BA2121">&#39;target_names&#39;</span>]
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>texts <span style="color: #666666">=</span> data[<span style="color: #BA2121">&#39;data&#39;</span>]
target <span style="color: #666666">=</span> data[<span style="color: #BA2121">&#39;target&#39;</span>]
</pre></div>
<p>
&#1053;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>texts[<span style="color: #666666">0</span>]
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>data[<span style="color: #BA2121">&#39;target_names&#39;</span>][target[<span style="color: #666666">0</span>]]
</pre></div>

<h3 id="ml:features:bag-of-words" class="anchor">Bag-of-words</h3>

<p>
&#1057;&#1072;&#1084;&#1099;&#1081; &#1086;&#1095;&#1077;&#1074;&#1080;&#1076;&#1085;&#1099;&#1081; &#1089;&#1087;&#1086;&#1089;&#1086;&#1073; &#1092;&#1086;&#1088;&#1084;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1086;&#1074;&#1086;&#1075;&#1086; &#1086;&#1087;&#1080;&#1089;&#1072;&#1085;&#1080;&#1103; &#1090;&#1077;&#1082;&#1089;&#1090;&#1086;&#1074; &#8212;
&#1074;&#1077;&#1082;&#1090;&#1086;&#1088;&#1080;&#1079;&#1072;&#1094;&#1080;&#1103;. &#1055;&#1088;&#1086;&#1089;&#1090;&#1086;&#1081; &#1089;&#1087;&#1086;&#1089;&#1086;&#1073; &#1079;&#1072;&#1082;&#1083;&#1102;&#1095;&#1072;&#1077;&#1090;&#1089;&#1103; &#1074; &#1087;&#1086;&#1076;&#1089;&#1095;&#1105;&#1090;&#1077;, &#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1086; &#1088;&#1072;&#1079; &#1074;&#1089;&#1090;&#1088;&#1077;&#1090;&#1080;&#1083;&#1086;&#1089;&#1100; &#1082;&#1072;&#1078;&#1076;&#1086;&#1077; &#1089;&#1083;&#1086;&#1074;&#1086;
&#1074; &#1090;&#1077;&#1082;&#1089;&#1090;&#1077;. &#1055;&#1086;&#1083;&#1091;&#1095;&#1072;&#1077;&#1084; &#1074;&#1077;&#1082;&#1090;&#1086;&#1088; &#1076;&#1083;&#1080;&#1085;&#1086;&#1081; &#1074; &#1082;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086; &#1091;&#1085;&#1080;&#1082;&#1072;&#1083;&#1100;&#1085;&#1099;&#1093; &#1089;&#1083;&#1086;&#1074;, &#1074;&#1089;&#1090;&#1088;&#1077;&#1095;&#1072;&#1102;&#1097;&#1080;&#1093;&#1089;&#1103; &#1074;&#1086;
&#1074;&#1089;&#1077;&#1093; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1072;&#1093; &#1074;&#1099;&#1073;&#1086;&#1088;&#1082;&#1080;. &#1042; &#1090;&#1072;&#1082;&#1086;&#1084; &#1074;&#1077;&#1082;&#1090;&#1086;&#1088;&#1077; &#1084;&#1085;&#1086;&#1075;&#1086; &#1085;&#1091;&#1083;&#1077;&#1081;, &#1087;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091; &#1077;&#1075;&#1086; &#1091;&#1076;&#1086;&#1073;&#1085;&#1077;&#1077; &#1093;&#1088;&#1072;&#1085;&#1080;&#1090;&#1100;
&#1074; &#1088;&#1072;&#1079;&#1088;&#1077;&#1078;&#1077;&#1085;&#1085;&#1086;&#1084; &#1074;&#1080;&#1076;&#1077;.

<p>
&#1055;&#1091;&#1089;&#1090;&#1100; &#1091; &#1085;&#1072;&#1089; &#1080;&#1084;&#1077;&#1077;&#1090;&#1089;&#1103; &#1082;&#1086;&#1083;&#1083;&#1077;&#1082;&#1094;&#1080;&#1103; &#1090;&#1077;&#1082;&#1089;&#1090;&#1086;&#1074; \( D = \{d_i\}_{i=1}^l \)
&#1080; &#1089;&#1083;&#1086;&#1074;&#1072;&#1088;&#1100; &#1074;&#1089;&#1077;&#1093; &#1089;&#1083;&#1086;&#1074;, &#1074;&#1089;&#1090;&#1088;&#1077;&#1095;&#1072;&#1102;&#1097;&#1080;&#1093;&#1089;&#1103; &#1074; &#1074;&#1099;&#1073;&#1086;&#1088;&#1082;&#1077; \( V = \{v_j\}_{j=1}^d. \) &#1042;
&#1101;&#1090;&#1086;&#1084; &#1089;&#1083;&#1091;&#1095;&#1072;&#1077; &#1085;&#1077;&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081; &#1090;&#1077;&#1082;&#1089;&#1090; \( d_i \) &#1086;&#1087;&#1080;&#1089;&#1099;&#1074;&#1072;&#1077;&#1090;&#1089;&#1103; &#1074;&#1077;&#1082;&#1090;&#1086;&#1088;&#1086;&#1084;
\( (x_{ij})_{j=1}^d, \) &#1075;&#1076;&#1077;
$$
x_{ij} = \sum_{v \in d_i} [v = v_j].
$$

<p>
&#1058;&#1072;&#1082;&#1080;&#1084; &#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1084;, &#1090;&#1077;&#1082;&#1089;&#1090; \( d_i \) &#1086;&#1087;&#1080;&#1089;&#1099;&#1074;&#1072;&#1077;&#1090;&#1089;&#1103; &#1074;&#1077;&#1082;&#1090;&#1086;&#1088;&#1086;&#1084; &#1082;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1072; &#1074;&#1093;&#1086;&#1078;&#1076;&#1077;&#1085;&#1080;&#1081;
&#1082;&#1072;&#1078;&#1076;&#1086;&#1075;&#1086; &#1089;&#1083;&#1086;&#1074;&#1072; &#1080;&#1079; &#1089;&#1083;&#1086;&#1074;&#1072;&#1088;&#1103; &#1074; &#1076;&#1072;&#1085;&#1085;&#1099;&#1081; &#1090;&#1077;&#1082;&#1089;&#1090;.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.feature_extraction.text</span> <span style="color: #008000; font-weight: bold">import</span> CountVectorizer

vectorizer <span style="color: #666666">=</span> CountVectorizer(encoding<span style="color: #666666">=</span><span style="color: #BA2121">&#39;utf8&#39;</span>, min_df<span style="color: #666666">=1</span>)
_ <span style="color: #666666">=</span> vectorizer<span style="color: #666666">.</span>fit(texts)
</pre></div>
<p>
&#1056;&#1077;&#1079;&#1091;&#1083;&#1100;&#1090;&#1072;&#1090;&#1086;&#1084; &#1103;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103; &#1088;&#1072;&#1079;&#1088;&#1077;&#1078;&#1077;&#1085;&#1085;&#1072;&#1103; &#1084;&#1072;&#1090;&#1088;&#1080;&#1094;&#1072;.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>vectorizer<span style="color: #666666">.</span>transform(texts[:<span style="color: #666666">1</span>])
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000">print</span>(vectorizer<span style="color: #666666">.</span>transform(texts[:<span style="color: #666666">1</span>])<span style="color: #666666">.</span>indptr)
<span style="color: #008000">print</span>(vectorizer<span style="color: #666666">.</span>transform(texts[:<span style="color: #666666">1</span>])<span style="color: #666666">.</span>indices)
<span style="color: #008000">print</span>(vectorizer<span style="color: #666666">.</span>transform(texts[:<span style="color: #666666">1</span>])<span style="color: #666666">.</span>data)
</pre></div>
<p>
&#1058;&#1072;&#1082;&#1086;&#1081; &#1089;&#1087;&#1086;&#1089;&#1086;&#1073; &#1087;&#1088;&#1077;&#1076;&#1089;&#1090;&#1072;&#1074;&#1083;&#1077;&#1085;&#1080;&#1103; &#1090;&#1077;&#1082;&#1089;&#1090;&#1086;&#1074; &#1085;&#1072;&#1079;&#1099;&#1074;&#1072;&#1102;&#1090; <em>&#1084;&#1077;&#1096;&#1082;&#1086;&#1084; &#1089;&#1083;&#1086;&#1074;</em> (bag-of-words).

<h3 id="ml:features:tf-idf" class="anchor">TF-IDF</h3>

<p>
&#1054;&#1095;&#1077;&#1074;&#1080;&#1076;&#1085;&#1086;, &#1095;&#1090;&#1086; &#1085;&#1077; &#1074;&#1089;&#1077; &#1089;&#1083;&#1086;&#1074;&#1072; &#1087;&#1086;&#1083;&#1077;&#1079;&#1085;&#1099; &#1074; &#1079;&#1072;&#1076;&#1072;&#1095;&#1077; &#1087;&#1088;&#1086;&#1075;&#1085;&#1086;&#1079;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103;. &#1053;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;, &#1084;&#1072;&#1083;&#1086;
&#1080;&#1085;&#1092;&#1086;&#1088;&#1084;&#1072;&#1094;&#1080;&#1080; &#1085;&#1077;&#1089;&#1091;&#1090; &#1089;&#1083;&#1086;&#1074;&#1072;, &#1074;&#1089;&#1090;&#1088;&#1077;&#1095;&#1072;&#1102;&#1097;&#1080;&#1077;&#1089;&#1103; &#1074;&#1086; &#1074;&#1089;&#1077;&#1093; &#1090;&#1077;&#1082;&#1089;&#1090;&#1072;&#1093;. &#1069;&#1090;&#1086; &#1084;&#1086;&#1075;&#1091;&#1090; &#1073;&#1099;&#1090;&#1100;
&#1082;&#1072;&#1082; &#1089;&#1090;&#1086;&#1087;-&#1089;&#1083;&#1086;&#1074;&#1072;, &#1090;&#1072;&#1082; &#1080; &#1089;&#1083;&#1086;&#1074;&#1072;, &#1089;&#1074;&#1086;&#1081;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1099;&#1077; &#1074;&#1089;&#1077;&#1084; &#1090;&#1077;&#1082;&#1089;&#1090;&#1072;&#1084; &#1074;&#1099;&#1073;&#1086;&#1088;&#1082;&#1080; (&#1074;
&#1090;&#1077;&#1082;&#1089;&#1090;&#1072;&#1093; &#1087;&#1088;&#1086; &#1072;&#1074;&#1090;&#1086;&#1084;&#1086;&#1073;&#1080;&#1083;&#1080; &#1091;&#1087;&#1086;&#1090;&#1088;&#1077;&#1073;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103; &#1089;&#1083;&#1086;&#1074;&#1086; &#171;&#1072;&#1074;&#1090;&#1086;&#1084;&#1086;&#1073;&#1080;&#1083;&#1100;&#187;). &#1069;&#1090;&#1091; &#1087;&#1088;&#1086;&#1073;&#1083;&#1077;&#1084;&#1091;
&#1088;&#1077;&#1096;&#1072;&#1077;&#1090; TF-IDF (*T*erm *F*requency&#8211;*I*nverse *D*ocument *F*requency)
&#1087;&#1088;&#1077;&#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1074;&#1072;&#1085;&#1080;&#1077; &#1090;&#1077;&#1082;&#1089;&#1090;&#1072;.

<p>
&#1056;&#1072;&#1089;&#1089;&#1084;&#1086;&#1090;&#1088;&#1080;&#1084; &#1082;&#1086;&#1083;&#1083;&#1077;&#1082;&#1094;&#1080;&#1102; &#1090;&#1077;&#1082;&#1089;&#1090;&#1086;&#1074; \( D \).  &#1044;&#1083;&#1103; &#1082;&#1072;&#1078;&#1076;&#1086;&#1075;&#1086; &#1091;&#1085;&#1080;&#1082;&#1072;&#1083;&#1100;&#1085;&#1086;&#1075;&#1086; &#1089;&#1083;&#1086;&#1074;&#1072; \( t \)
&#1080;&#1079; &#1076;&#1086;&#1082;&#1091;&#1084;&#1077;&#1085;&#1090;&#1072; \( d \in D \) &#1074;&#1099;&#1095;&#1080;&#1089;&#1083;&#1080;&#1084; &#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1080;&#1077; &#1074;&#1077;&#1083;&#1080;&#1095;&#1080;&#1085;&#1099;:  

<ul>
<li> TD (Term Frequency) &#8211; &#1082;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086; &#1074;&#1093;&#1086;&#1078;&#1076;&#1077;&#1085;&#1080;&#1081; &#1089;&#1083;&#1086;&#1074;&#1072; &#1074; &#1086;&#1090;&#1085;&#1086;&#1096;&#1077;&#1085;&#1080;&#1080; &#1082; &#1086;&#1073;&#1097;&#1077;&#1084;&#1091; &#1095;&#1080;&#1089;&#1083;&#1091; &#1089;&#1083;&#1086;&#1074; &#1074; &#1090;&#1077;&#1082;&#1089;&#1090;&#1077;:</li>
</ul>

$$
\textrm{tf}(t, d) = \frac{n_{td}}{\sum_{t \in d} n_{td}},
$$

&#1075;&#1076;&#1077; \( n_{td} \) &#8212; &#1082;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086; &#1074;&#1093;&#1086;&#1078;&#1076;&#1077;&#1085;&#1080;&#1081; &#1089;&#1083;&#1086;&#1074;&#1072; \( t \) &#1074; &#1090;&#1077;&#1082;&#1089;&#1090; \( d \).

<ul>
<li> IDF (Inverse Document Frequency):</li>
</ul>

$$
\textrm{idf}(t, D) = \log \frac{\left| D \right|}{\left| \{d\in D: t \in d\} \right|},
$$

&#1075;&#1076;&#1077; \( \left| \{d\in D: t \in d\} \right| \) &#8211; &#1082;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086; &#1090;&#1077;&#1082;&#1089;&#1090;&#1086;&#1074; &#1074; &#1082;&#1086;&#1083;&#1083;&#1077;&#1082;&#1094;&#1080;&#1080;, &#1089;&#1086;&#1076;&#1077;&#1088;&#1078;&#1072;&#1097;&#1080;&#1093; &#1089;&#1083;&#1086;&#1074;&#1086; \( t \).

<p>
&#1058;&#1086;&#1075;&#1076;&#1072; &#1076;&#1083;&#1103; &#1082;&#1072;&#1078;&#1076;&#1086;&#1081; &#1087;&#1072;&#1088;&#1099; (&#1089;&#1083;&#1086;&#1074;&#1086;, &#1090;&#1077;&#1082;&#1089;&#1090;) \( (t, d) \) &#1074;&#1099;&#1095;&#1080;&#1089;&#1083;&#1080;&#1084; &#1074;&#1077;&#1083;&#1080;&#1095;&#1080;&#1085;&#1091;:
$$
\textrm{tf-idf}(t,d, D) = \text{tf}(t, d)\cdot \text{idf}(t, D).
$$

<p>
&#1054;&#1090;&#1084;&#1077;&#1090;&#1080;&#1084;, &#1095;&#1090;&#1086; &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077; \( \text{tf}(t, d) \) &#1082;&#1086;&#1088;&#1088;&#1077;&#1082;&#1090;&#1080;&#1088;&#1091;&#1077;&#1090;&#1089;&#1103; &#1076;&#1083;&#1103; &#1095;&#1072;&#1089;&#1090;&#1086;
&#1074;&#1089;&#1090;&#1088;&#1077;&#1095;&#1072;&#1102;&#1097;&#1080;&#1093;&#1089;&#1103; &#1086;&#1073;&#1097;&#1077;&#1091;&#1087;&#1086;&#1090;&#1088;&#1077;&#1073;&#1080;&#1084;&#1099;&#1093; &#1089;&#1083;&#1086;&#1074; &#1087;&#1088;&#1080; &#1087;&#1086;&#1084;&#1086;&#1097;&#1080; &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1103;
\( \textrm{idf}(t, D) \).

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.feature_extraction.text</span> <span style="color: #008000; font-weight: bold">import</span> TfidfVectorizer

vectorizer <span style="color: #666666">=</span> TfidfVectorizer(encoding<span style="color: #666666">=</span><span style="color: #BA2121">&#39;utf8&#39;</span>, min_df<span style="color: #666666">=1</span>)
_ <span style="color: #666666">=</span> vectorizer<span style="color: #666666">.</span>fit(texts)
</pre></div>
<p>
&#1053;&#1072; &#1074;&#1099;&#1093;&#1086;&#1076;&#1077; &#1087;&#1086;&#1083;&#1091;&#1095;&#1072;&#1077;&#1084; &#1088;&#1072;&#1079;&#1088;&#1077;&#1078;&#1077;&#1085;&#1085;&#1091;&#1102; &#1084;&#1072;&#1090;&#1088;&#1080;&#1094;&#1091;.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>vectorizer<span style="color: #666666">.</span>transform(texts[:<span style="color: #666666">1</span>])
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000">print</span>(vectorizer<span style="color: #666666">.</span>transform(texts[:<span style="color: #666666">1</span>])<span style="color: #666666">.</span>indptr)
<span style="color: #008000">print</span>(vectorizer<span style="color: #666666">.</span>transform(texts[:<span style="color: #666666">1</span>])<span style="color: #666666">.</span>indices)
<span style="color: #008000">print</span>(vectorizer<span style="color: #666666">.</span>transform(texts[:<span style="color: #666666">1</span>])<span style="color: #666666">.</span>data)
</pre></div>
<p>
&#1047;&#1072;&#1084;&#1077;&#1090;&#1080;&#1084;, &#1095;&#1090;&#1086; &#1086;&#1073;&#1072; &#1084;&#1077;&#1090;&#1086;&#1076;&#1072; &#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1102;&#1090; &#1074;&#1077;&#1082;&#1090;&#1086;&#1088; &#1076;&#1083;&#1080;&#1085;&#1099; 32548 (&#1088;&#1072;&#1079;&#1084;&#1077;&#1088; &#1085;&#1072;&#1096;&#1077;&#1075;&#1086; &#1089;&#1083;&#1086;&#1074;&#1072;&#1088;&#1103;).

<p>
&#1047;&#1072;&#1084;&#1077;&#1090;&#1080;&#1084;, &#1095;&#1090;&#1086; &#1086;&#1076;&#1085;&#1086; &#1080; &#1090;&#1086; &#1078;&#1077; &#1089;&#1083;&#1086;&#1074;&#1086; &#1084;&#1086;&#1078;&#1077;&#1090; &#1074;&#1089;&#1090;&#1088;&#1077;&#1095;&#1072;&#1090;&#1100;&#1089;&#1103; &#1074; &#1088;&#1072;&#1079;&#1083;&#1080;&#1095;&#1085;&#1099;&#1093; &#1092;&#1086;&#1088;&#1084;&#1072;&#1093;
(&#1085;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;, &#171;&#1089;&#1086;&#1090;&#1088;&#1091;&#1076;&#1085;&#1080;&#1082;&#187; &#1080; &#171;&#1089;&#1086;&#1090;&#1088;&#1091;&#1076;&#1085;&#1080;&#1082;&#1072;&#187;), &#1085;&#1086; &#1086;&#1087;&#1080;&#1089;&#1072;&#1085;&#1085;&#1099;&#1077; &#1074;&#1099;&#1096;&#1077; &#1084;&#1077;&#1090;&#1086;&#1076;&#1099;
&#1080;&#1085;&#1090;&#1077;&#1088;&#1087;&#1088;&#1077;&#1090;&#1080;&#1088;&#1091;&#1102;&#1090; &#1080;&#1093; &#1082;&#1072;&#1082; &#1088;&#1072;&#1079;&#1083;&#1080;&#1095;&#1085;&#1099;&#1077; &#1089;&#1083;&#1086;&#1074;&#1072;, &#1095;&#1090;&#1086; &#1076;&#1077;&#1083;&#1072;&#1077;&#1090; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1086;&#1074;&#1086;&#1077; &#1086;&#1087;&#1080;&#1089;&#1072;&#1085;&#1080;&#1077;
&#1080;&#1079;&#1073;&#1099;&#1090;&#1086;&#1095;&#1085;&#1099;&#1084;. &#1059;&#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1090;&#1100; &#1101;&#1090;&#1091; &#1087;&#1088;&#1086;&#1073;&#1083;&#1077;&#1084;&#1091; &#1084;&#1086;&#1078;&#1085;&#1086; &#1087;&#1088;&#1080; &#1087;&#1086;&#1084;&#1086;&#1097;&#1080; <b>&#1083;&#1077;&#1084;&#1084;&#1072;&#1090;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;</b> &#1080;
<b>&#1089;&#1090;&#1077;&#1084;&#1084;&#1080;&#1085;&#1075;&#1072;</b>.

<h3 id="ml:features:stemming" class="anchor">&#1057;&#1090;&#1077;&#1084;&#1084;&#1080;&#1085;&#1075;</h3>

<p>
<em>&#1057;&#1090;&#1077;&#1084;&#1084;&#1080;&#1085;&#1075;</em> &#8212; &#1101;&#1090;&#1086; &#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089; &#1085;&#1072;&#1093;&#1086;&#1078;&#1076;&#1077;&#1085;&#1080;&#1103; &#1086;&#1089;&#1085;&#1086;&#1074;&#1099; &#1089;&#1083;&#1086;&#1074;&#1072;. &#1042; &#1088;&#1077;&#1079;&#1091;&#1083;&#1100;&#1090;&#1072;&#1090;&#1077; &#1087;&#1088;&#1080;&#1084;&#1077;&#1085;&#1077;&#1085;&#1080;&#1103;
&#1076;&#1072;&#1085;&#1085;&#1086;&#1081; &#1087;&#1088;&#1086;&#1094;&#1077;&#1076;&#1091;&#1088;&#1099; &#1086;&#1076;&#1085;&#1086;&#1082;&#1086;&#1088;&#1077;&#1085;&#1085;&#1099;&#1077; &#1089;&#1083;&#1086;&#1074;&#1072;, &#1082;&#1072;&#1082; &#1087;&#1088;&#1072;&#1074;&#1080;&#1083;&#1086;, &#1087;&#1088;&#1077;&#1086;&#1073;&#1088;&#1072;&#1079;&#1091;&#1102;&#1090;&#1089;&#1103; &#1082; &#1086;&#1076;&#1080;&#1085;&#1072;&#1082;&#1086;&#1074;&#1086;&#1084;&#1091;
&#1074;&#1080;&#1076;&#1091;.

<p>
<p class='env-table'><em>&#1058;&#1072;&#1073;&#1083;&#1080;&#1094;&#1072; 1. &#1055;&#1088;&#1080;&#1084;&#1077;&#1088;&#1099; &#1089;&#1090;&#1077;&#1084;&#1084;&#1080;&#1085;&#1075;&#1072;</em>

<p>

<div class="row">
  <div class="col-xs-12">
    <table class="table table-striped table-hover table-condensed">
<thead>
<tr><td align="left"><b>                 &#1057;&#1083;&#1086;&#1074;&#1086;                  </b></td> <td align="left"><b>    &#1054;&#1089;&#1085;&#1086;&#1074;&#1072;   </b></td> </tr>
</thead>
<tbody>
<tr><td align="left">   &#1074;&#1072;&#1075;&#1086;&#1085;                                       </td> <td align="left">   &#1074;&#1072;&#1075;&#1086;&#1085;                  </td> </tr>
<tr><td align="left">   &#1074;&#1072;&#1075;&#1086;&#1085;&#1072;                                </td> <td align="left">   &#1074;&#1072;&#1075;&#1086;&#1085;                  </td> </tr>
<tr><td align="left">   &#1074;&#1072;&#1075;&#1086;&#1085;&#1077;                                </td> <td align="left">   &#1074;&#1072;&#1075;&#1086;&#1085;                  </td> </tr>
<tr><td align="left">   &#1074;&#1072;&#1075;&#1086;&#1085;&#1086;&#1074;                         </td> <td align="left">   &#1074;&#1072;&#1075;&#1086;&#1085;                  </td> </tr>
<tr><td align="left">   &#1074;&#1072;&#1075;&#1086;&#1085;&#1086;&#1084;                         </td> <td align="left">   &#1074;&#1072;&#1075;&#1086;&#1085;                  </td> </tr>
<tr><td align="left">   &#1074;&#1072;&#1075;&#1086;&#1085;&#1099;                                </td> <td align="left">   &#1074;&#1072;&#1075;&#1086;&#1085;                  </td> </tr>
<tr><td align="left">   &#1074;&#1072;&#1078;&#1085;&#1072;&#1103;                                </td> <td align="left">   &#1074;&#1072;&#1078;&#1085;                         </td> </tr>
<tr><td align="left">   &#1074;&#1072;&#1078;&#1085;&#1077;&#1077;                                </td> <td align="left">   &#1074;&#1072;&#1078;&#1085;                         </td> </tr>
<tr><td align="left">   &#1074;&#1072;&#1078;&#1085;&#1077;&#1081;&#1096;&#1080;&#1077;           </td> <td align="left">   &#1074;&#1072;&#1078;&#1085;                         </td> </tr>
<tr><td align="left">   &#1074;&#1072;&#1078;&#1085;&#1077;&#1081;&#1096;&#1080;&#1084;&#1080;    </td> <td align="left">   &#1074;&#1072;&#1078;&#1085;                         </td> </tr>
<tr><td align="left">   &#1074;&#1072;&#1078;&#1085;&#1080;&#1095;&#1072;&#1083;                  </td> <td align="left">   &#1074;&#1072;&#1078;&#1085;&#1080;&#1095;&#1072;    </td> </tr>
<tr><td align="left">   &#1074;&#1072;&#1078;&#1085;&#1086;                                       </td> <td align="left">   &#1074;&#1072;&#1078;&#1085;                         </td> </tr>
</tbody>
    </table>
  </div> <!-- col-xs-12 -->
</div> <!-- cell row -->
</p>

<p>
<a href="http://snowball.tartarus.org/" target="_self">Snowball</a> &#8212; &#1092;&#1088;&#1101;&#1081;&#1084;&#1074;&#1086;&#1088;&#1082; &#1076;&#1083;&#1103; &#1085;&#1072;&#1087;&#1080;&#1089;&#1072;&#1085;&#1080;&#1103;
&#1072;&#1083;&#1075;&#1086;&#1088;&#1080;&#1090;&#1084;&#1086;&#1074; &#1089;&#1090;&#1077;&#1084;&#1084;&#1080;&#1085;&#1075;&#1072; (&#1073;&#1080;&#1073;&#1083;&#1080;&#1086;&#1090;&#1077;&#1082;&#1072; <code>nltk</code>). &#1040;&#1083;&#1075;&#1086;&#1088;&#1080;&#1090;&#1084;&#1099; &#1089;&#1090;&#1077;&#1084;&#1084;&#1080;&#1085;&#1075;&#1072; &#1086;&#1090;&#1083;&#1080;&#1095;&#1072;&#1102;&#1090;&#1089;&#1103; &#1076;&#1083;&#1103; &#1088;&#1072;&#1079;&#1085;&#1099;&#1093; &#1103;&#1079;&#1099;&#1082;&#1086;&#1074;
&#1080; &#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1102;&#1090; &#1079;&#1085;&#1072;&#1085;&#1080;&#1103; &#1086; &#1082;&#1086;&#1085;&#1082;&#1088;&#1077;&#1090;&#1085;&#1086;&#1084; &#1103;&#1079;&#1099;&#1082;&#1077; &#8212; &#1089;&#1087;&#1080;&#1089;&#1082;&#1080; &#1086;&#1082;&#1086;&#1085;&#1095;&#1072;&#1085;&#1080;&#1081; &#1076;&#1083;&#1103; &#1088;&#1072;&#1079;&#1085;&#1099;&#1093;
&#1095;&#1080;&#1089;&#1090;&#1077;&#1081; &#1088;&#1077;&#1095;&#1080;, &#1088;&#1072;&#1079;&#1085;&#1099;&#1093; &#1089;&#1082;&#1083;&#1086;&#1085;&#1077;&#1085;&#1080;&#1081; &#1080; &#1090;.&#1076;. &#1055;&#1088;&#1080;&#1084;&#1077;&#1088; &#1072;&#1083;&#1075;&#1086;&#1088;&#1080;&#1090;&#1084;&#1072; &#1076;&#1083;&#1103; &#1088;&#1091;&#1089;&#1089;&#1082;&#1086;&#1075;&#1086;
&#1103;&#1079;&#1099;&#1082;&#1072; &#8211; <a href="http://snowballstem.org/algorithms/russian/stemmer.html" target="_self">Russian stemming</a>.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">nltk</span>
stemmer <span style="color: #666666">=</span> nltk<span style="color: #666666">.</span>stem<span style="color: #666666">.</span>snowball<span style="color: #666666">.</span>RussianStemmer()
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000">print</span>(stemmer<span style="color: #666666">.</span>stem(<span style="color: #BA2121">u&#39;машинное&#39;</span>), stemmer<span style="color: #666666">.</span>stem(<span style="color: #BA2121">u&#39;обучение&#39;</span>))
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>stemmer <span style="color: #666666">=</span> nltk<span style="color: #666666">.</span>stem<span style="color: #666666">.</span>snowball<span style="color: #666666">.</span>EnglishStemmer()

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">stem_text</span>(text, stemmer):
    tokens <span style="color: #666666">=</span> text<span style="color: #666666">.</span>split()
    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">&#39; &#39;</span><span style="color: #666666">.</span>join(<span style="color: #008000">map</span>(<span style="color: #008000; font-weight: bold">lambda</span> w: stemmer<span style="color: #666666">.</span>stem(w), tokens))

stemmed_texts <span style="color: #666666">=</span> []
<span style="color: #008000; font-weight: bold">for</span> t <span style="color: #AA22FF; font-weight: bold">in</span> tqdm(texts[:<span style="color: #666666">1000</span>]):
    stemmed_texts<span style="color: #666666">.</span>append(stem_text(t, stemmer))
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000">print</span>(texts[<span style="color: #666666">0</span>])
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000">print</span>(stemmed_texts[<span style="color: #666666">0</span>])
</pre></div>
<p>
&#1050;&#1072;&#1082; &#1074;&#1080;&#1076;&#1080;&#1084;, &#1089;&#1090;&#1077;&#1084;&#1084;&#1077;&#1088; &#1088;&#1072;&#1073;&#1086;&#1090;&#1072;&#1077;&#1090; &#1085;&#1077; &#1086;&#1095;&#1077;&#1085;&#1100; &#1073;&#1099;&#1089;&#1090;&#1088;&#1086; &#1080; &#1079;&#1072;&#1087;&#1091;&#1089;&#1082;&#1072;&#1090;&#1100; &#1077;&#1075;&#1086; &#1076;&#1083;&#1103; &#1074;&#1089;&#1077;&#1081;
&#1074;&#1099;&#1073;&#1086;&#1088;&#1082;&#1080; &#1076;&#1086;&#1089;&#1090;&#1072;&#1090;&#1086;&#1095;&#1085;&#1086; &#1085;&#1072;&#1082;&#1083;&#1072;&#1076;&#1085;&#1086;.

<h3 id="ml:features:lemma" class="anchor">&#1051;&#1077;&#1084;&#1072;&#1090;&#1080;&#1079;&#1072;&#1094;&#1080;&#1103;</h3>

<p>
<em>&#1051;&#1077;&#1084;&#1084;&#1072;&#1090;&#1080;&#1079;&#1072;&#1094;&#1080;&#1103;</em> &#8212; &#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089; &#1087;&#1088;&#1080;&#1074;&#1077;&#1076;&#1077;&#1085;&#1080;&#1103; &#1089;&#1083;&#1086;&#1074;&#1072; &#1082; &#1077;&#1075;&#1086; &#1085;&#1086;&#1088;&#1084;&#1072;&#1083;&#1100;&#1085;&#1086;&#1081; &#1092;&#1086;&#1088;&#1084;&#1077; (&#1083;&#1077;&#1084;&#1084;&#1077;):

<ul>
<li> &#1076;&#1083;&#1103; &#1089;&#1091;&#1097;&#1077;&#1089;&#1090;&#1074;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1099;&#1093; &#8212; &#1080;&#1084;&#1077;&#1085;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1099;&#1081; &#1087;&#1072;&#1076;&#1077;&#1078;, &#1077;&#1076;&#1080;&#1085;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1086;&#1077; &#1095;&#1080;&#1089;&#1083;&#1086;;</li>
<li> &#1076;&#1083;&#1103; &#1087;&#1088;&#1080;&#1083;&#1072;&#1075;&#1072;&#1090;&#1077;&#1083;&#1100;&#1085;&#1099;&#1093; &#8212; &#1080;&#1084;&#1077;&#1085;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1099;&#1081; &#1087;&#1072;&#1076;&#1077;&#1078;, &#1077;&#1076;&#1080;&#1085;&#1089;&#1090;&#1074;&#1077;&#1085;&#1085;&#1086;&#1077; &#1095;&#1080;&#1089;&#1083;&#1086;, &#1084;&#1091;&#1078;&#1089;&#1082;&#1086;&#1081; &#1088;&#1086;&#1076;;</li>
<li> &#1076;&#1083;&#1103; &#1075;&#1083;&#1072;&#1075;&#1086;&#1083;&#1086;&#1074;, &#1087;&#1088;&#1080;&#1095;&#1072;&#1089;&#1090;&#1080;&#1081;, &#1076;&#1077;&#1077;&#1087;&#1088;&#1080;&#1095;&#1072;&#1089;&#1090;&#1080;&#1081; &#8212; &#1075;&#1083;&#1072;&#1075;&#1086;&#1083; &#1074; &#1080;&#1085;&#1092;&#1080;&#1085;&#1080;&#1090;&#1080;&#1074;&#1077;.</li>
</ul>

&#1051;&#1077;&#1084;&#1084;&#1072;&#1090;&#1080;&#1079;&#1072;&#1094;&#1080;&#1103; &#8212; &#1087;&#1088;&#1086;&#1094;&#1077;&#1089;&#1089; &#1073;&#1086;&#1083;&#1077;&#1077; &#1089;&#1083;&#1086;&#1078;&#1085;&#1099;&#1081; &#1087;&#1086; &#1089;&#1088;&#1072;&#1074;&#1085;&#1077;&#1085;&#1080;&#1102; &#1089;&#1086; &#1089;&#1090;&#1077;&#1084;&#1084;&#1080;&#1085;&#1075;&#1086;&#1084;. &#1057;&#1090;&#1077;&#1084;&#1084;&#1077;&#1088;
&#1087;&#1088;&#1086;&#1089;&#1090;&#1086; &#171;&#1088;&#1077;&#1078;&#1077;&#1090;&#187; &#1089;&#1083;&#1086;&#1074;&#1086; &#1076;&#1086; &#1086;&#1089;&#1085;&#1086;&#1074;&#1099;.

<p>
&#1053;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;, &#1076;&#1083;&#1103; &#1088;&#1091;&#1089;&#1089;&#1082;&#1086;&#1075;&#1086; &#1103;&#1079;&#1099;&#1082;&#1072; &#1077;&#1089;&#1090;&#1100; &#1073;&#1080;&#1073;&#1083;&#1080;&#1086;&#1090;&#1077;&#1082;&#1072; <code>pymorphy2</code>.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">pymorphy2</span>
morph <span style="color: #666666">=</span> pymorphy2<span style="color: #666666">.</span>MorphAnalyzer()
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>morph<span style="color: #666666">.</span>parse(<span style="color: #BA2121">&#39;играющих&#39;</span>)[<span style="color: #666666">0</span>]
</pre></div>
<p>
&#1057;&#1088;&#1072;&#1074;&#1085;&#1080;&#1084; &#1088;&#1072;&#1073;&#1086;&#1090;&#1091; &#1089;&#1090;&#1077;&#1084;&#1084;&#1077;&#1088;&#1072; &#1080; &#1083;&#1077;&#1084;&#1084;&#1072;&#1090;&#1080;&#1079;&#1072;&#1090;&#1086;&#1088;&#1072; &#1085;&#1072; &#1087;&#1088;&#1080;&#1084;&#1077;&#1088;&#1077;:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>stemmer <span style="color: #666666">=</span> nltk<span style="color: #666666">.</span>stem<span style="color: #666666">.</span>snowball<span style="color: #666666">.</span>RussianStemmer()
<span style="color: #008000">print</span>(stemmer<span style="color: #666666">.</span>stem(<span style="color: #BA2121">&#39;играющих&#39;</span>))
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000">print</span>(morph<span style="color: #666666">.</span>parse(<span style="color: #BA2121">&#39;играющих&#39;</span>)[<span style="color: #666666">0</span>]<span style="color: #666666">.</span>normal_form)
</pre></div>

<h2 id="ml:features:trans" class="anchor">&#1058;&#1088;&#1072;&#1085;&#1089;&#1092;&#1086;&#1088;&#1084;&#1072;&#1094;&#1080;&#1103; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1086;&#1074; &#1080; &#1094;&#1077;&#1083;&#1077;&#1074;&#1086;&#1081; &#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1086;&#1081;</h2>

<p>
&#1056;&#1072;&#1079;&#1073;&#1077;&#1088;&#1105;&#1084;&#1089;&#1103;, &#1082;&#1072;&#1082; &#1084;&#1086;&#1078;&#1077;&#1090; &#1074;&#1083;&#1080;&#1103;&#1090;&#1100; &#1090;&#1088;&#1072;&#1085;&#1089;&#1092;&#1086;&#1088;&#1084;&#1072;&#1094;&#1080;&#1103; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1086;&#1074; &#1080;&#1083;&#1080; &#1094;&#1077;&#1083;&#1077;&#1074;&#1086;&#1081;
&#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1086;&#1081; &#1085;&#1072; &#1082;&#1072;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086; &#1084;&#1086;&#1076;&#1077;&#1083;&#1080;.

<h3 id="ml:features:log" class="anchor">&#1051;&#1086;&#1075;&#1072;&#1088;&#1080;&#1092;&#1084;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1077;</h3>

<p>
&#1042;&#1086;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1077;&#1090;&#1089;&#1103; &#1076;&#1072;&#1090;&#1072;&#1089;&#1077;&#1090;&#1086;&#1084; &#1089; &#1094;&#1077;&#1085;&#1072;&#1084;&#1080; &#1085;&#1072; &#1076;&#1086;&#1084;&#1072;, &#1089; &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1084; &#1084;&#1099; &#1091;&#1078;&#1077;
&#1089;&#1090;&#1072;&#1083;&#1082;&#1080;&#1074;&#1072;&#1083;&#1080;&#1089;&#1100; &#1088;&#1072;&#1085;&#1077;&#1077;
(<a href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques/overview" target="_self">House Prices: Advanced Regression Techniques</a>).

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>data <span style="color: #666666">=</span> pd<span style="color: #666666">.</span>read_csv(<span style="color: #BA2121">&#39;train.csv&#39;</span>)

data <span style="color: #666666">=</span> data<span style="color: #666666">.</span>drop(columns<span style="color: #666666">=</span>[<span style="color: #BA2121">&quot;Id&quot;</span>])
y <span style="color: #666666">=</span> data[<span style="color: #BA2121">&quot;SalePrice&quot;</span>]
X <span style="color: #666666">=</span> data<span style="color: #666666">.</span>drop(columns<span style="color: #666666">=</span>[<span style="color: #BA2121">&quot;SalePrice&quot;</span>])
</pre></div>
<p>
&#1055;&#1086;&#1089;&#1084;&#1086;&#1090;&#1088;&#1080;&#1084; &#1085;&#1072; &#1088;&#1072;&#1089;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1080;&#1077; &#1094;&#1077;&#1083;&#1077;&#1074;&#1086;&#1081; &#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1086;&#1081;

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>plt<span style="color: #666666">.</span>figure(figsize<span style="color: #666666">=</span>(<span style="color: #666666">12</span>, <span style="color: #666666">5</span>))

plt<span style="color: #666666">.</span>subplot(<span style="color: #666666">1</span>, <span style="color: #666666">2</span>, <span style="color: #666666">1</span>)
sns<span style="color: #666666">.</span>distplot(y, label<span style="color: #666666">=</span><span style="color: #BA2121">&#39;target&#39;</span>)
plt<span style="color: #666666">.</span>title(<span style="color: #BA2121">&#39;target&#39;</span>)

plt<span style="color: #666666">.</span>subplot(<span style="color: #666666">1</span>, <span style="color: #666666">2</span>, <span style="color: #666666">2</span>)
sns<span style="color: #666666">.</span>distplot(data<span style="color: #666666">.</span>GrLivArea, label<span style="color: #666666">=</span><span style="color: #BA2121">&#39;area&#39;</span>)
plt<span style="color: #666666">.</span>title(<span style="color: #BA2121">&#39;area&#39;</span>)
plt<span style="color: #666666">.</span>show()
</pre></div>
<p>
&#1042;&#1080;&#1076;&#1080;&#1084;, &#1095;&#1090;&#1086; &#1088;&#1072;&#1089;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1080;&#1103; &#1085;&#1077;&#1089;&#1080;&#1084;&#1084;&#1077;&#1090;&#1088;&#1080;&#1095;&#1085;&#1099;&#1077; &#1089; &#1090;&#1103;&#1078;&#1105;&#1083;&#1099;&#1084;&#1080; &#1087;&#1088;&#1072;&#1074;&#1099;&#1084;&#1080; &#1093;&#1074;&#1086;&#1089;&#1090;&#1072;&#1084;&#1080;.

<p>
&#1054;&#1089;&#1090;&#1072;&#1074;&#1080;&#1084; &#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1095;&#1080;&#1089;&#1083;&#1086;&#1074;&#1099;&#1077; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1080;, &#1087;&#1088;&#1086;&#1087;&#1091;&#1089;&#1082;&#1080; &#1079;&#1072;&#1084;&#1077;&#1085;&#1080;&#1084; &#1089;&#1088;&#1077;&#1076;&#1085;&#1080;&#1084; &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;&#1084;.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>X_train, X_test, y_train, y_test <span style="color: #666666">=</span> train_test_split(
    X, y, test_size<span style="color: #666666">=0.3</span>, random_state<span style="color: #666666">=10</span>)

numeric_data <span style="color: #666666">=</span> X_train<span style="color: #666666">.</span>select_dtypes([np<span style="color: #666666">.</span>number])
numeric_data_mean <span style="color: #666666">=</span> numeric_data<span style="color: #666666">.</span>mean()
numeric_features <span style="color: #666666">=</span> numeric_data<span style="color: #666666">.</span>columns

X_train <span style="color: #666666">=</span> X_train<span style="color: #666666">.</span>fillna(numeric_data_mean)[numeric_features]
X_test <span style="color: #666666">=</span> X_test<span style="color: #666666">.</span>fillna(numeric_data_mean)[numeric_features]
</pre></div>
<p>
&#1045;&#1089;&#1083;&#1080; &#1088;&#1072;&#1079;&#1073;&#1080;&#1088;&#1072;&#1090;&#1100; &#1083;&#1080;&#1085;&#1077;&#1081;&#1085;&#1091;&#1102; &#1088;&#1077;&#1075;&#1088;&#1077;&#1089;&#1089;&#1080;&#1103; &#1089;
&#1074;&#1077;&#1088;&#1086;&#1103;&#1090;&#1085;&#1086;&#1089;&#1090;&#1085;&#1086;&#1081; &#1090;&#1086;&#1095;&#1082;&#1080; &#1079;&#1088;&#1077;&#1085;&#1080;&#1103;, &#1090;&#1086; &#1084;&#1086;&#1078;&#1085;&#1086; &#1087;&#1086;&#1083;&#1091;&#1095;&#1080;&#1090;&#1100;, &#1095;&#1090;&#1086; &#1096;&#1091;&#1084; &#1076;&#1086;&#1083;&#1078;&#1077;&#1085; &#1073;&#1099;&#1090;&#1100;
&#1088;&#1072;&#1089;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1105;&#1085; &#1085;&#1086;&#1088;&#1084;&#1072;&#1083;&#1100;&#1085;&#1086;. &#1055;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091; &#1083;&#1091;&#1095;&#1096;&#1077;, &#1082;&#1086;&#1075;&#1076;&#1072; &#1094;&#1077;&#1083;&#1077;&#1074;&#1072;&#1103; &#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1072;&#1103;
&#1088;&#1072;&#1089;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1072; &#1090;&#1072;&#1082;&#1078;&#1077; &#1085;&#1086;&#1088;&#1084;&#1072;&#1083;&#1100;&#1085;&#1086;.

<p>
&#1045;&#1089;&#1083;&#1080; &#1087;&#1088;&#1086;&#1083;&#1086;&#1075;&#1072;&#1088;&#1080;&#1092;&#1084;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100; &#1094;&#1077;&#1083;&#1077;&#1074;&#1091;&#1102; &#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1091;&#1102;, &#1090;&#1086; &#1077;&#1105; &#1088;&#1072;&#1089;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1080;&#1077; &#1089;&#1090;&#1072;&#1085;&#1077;&#1090;
&#1073;&#1086;&#1083;&#1100;&#1096;&#1077; &#1087;&#1086;&#1093;&#1086;&#1078;&#1077; &#1085;&#1072; &#1085;&#1086;&#1088;&#1084;&#1072;&#1083;&#1100;&#1085;&#1086;&#1077;:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>sns<span style="color: #666666">.</span>distplot(np<span style="color: #666666">.</span>log(y<span style="color: #666666">+1</span>), label<span style="color: #666666">=</span><span style="color: #BA2121">&#39;target&#39;</span>)
plt<span style="color: #666666">.</span>show()
</pre></div>
<p>
&#1057;&#1088;&#1072;&#1074;&#1085;&#1080;&#1084; &#1082;&#1072;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086; &#1083;&#1080;&#1085;&#1077;&#1081;&#1085;&#1086;&#1081; &#1088;&#1077;&#1075;&#1088;&#1077;&#1089;&#1089;&#1080;&#1080; &#1074; &#1076;&#1074;&#1091;&#1093; &#1089;&#1083;&#1091;&#1095;&#1072;&#1103;&#1093;:

<ul>
<li> &#1062;&#1077;&#1083;&#1077;&#1074;&#1072;&#1103; &#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1072;&#1103; &#1073;&#1077;&#1079; &#1080;&#1079;&#1084;&#1077;&#1085;&#1077;&#1085;&#1080;&#1081;.</li>
<li> &#1062;&#1077;&#1083;&#1077;&#1074;&#1072;&#1103; &#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1072;&#1103; &#1087;&#1088;&#1086;&#1083;&#1086;&#1075;&#1072;&#1088;&#1080;&#1092;&#1084;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1072;.</li>
</ul>

<div class="panel panel-warning">
  <div class="panel-heading">
  <h3 class="panel-title">Предупреждение</h3>
  </div>
<div class="panel-body">
<p> <!-- subsequent paragraphs come in larger fonts, so start with a paragraph -->
&#1053;&#1077; &#1079;&#1072;&#1073;&#1091;&#1076;&#1077;&#1084; &#1074;&#1086; &#1074;&#1090;&#1086;&#1088;&#1086;&#1084; &#1089;&#1083;&#1091;&#1095;&#1072;&#1077; &#1074;&#1079;&#1103;&#1090;&#1100; &#1101;&#1082;&#1089;&#1087;&#1086;&#1085;&#1077;&#1085;&#1090;&#1091; &#1086;&#1090; &#1087;&#1088;&#1077;&#1076;&#1089;&#1082;&#1072;&#1079;&#1072;&#1085;&#1080;&#1081;!
</div>
</div>


<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>model <span style="color: #666666">=</span> Ridge()
model<span style="color: #666666">.</span>fit(X_train, y_train)
y_pred <span style="color: #666666">=</span> model<span style="color: #666666">.</span>predict(X_test)

<span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Test RMSE = </span><span style="color: #BB6688; font-weight: bold">%.4f</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> mean_squared_error(y_test, y_pred) <span style="color: #666666">**</span> <span style="color: #666666">0.5</span>)
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>model <span style="color: #666666">=</span> Ridge()
model<span style="color: #666666">.</span>fit(X_train, np<span style="color: #666666">.</span>log(y_train<span style="color: #666666">+1</span>))
y_pred <span style="color: #666666">=</span> np<span style="color: #666666">.</span>exp(model<span style="color: #666666">.</span>predict(X_test))<span style="color: #666666">-1</span>

<span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Test RMSE = </span><span style="color: #BB6688; font-weight: bold">%.4f</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> mean_squared_error(y_test, y_pred) <span style="color: #666666">**</span> <span style="color: #666666">0.5</span>)
</pre></div>
<p>
&#1055;&#1086;&#1087;&#1088;&#1086;&#1073;&#1091;&#1077;&#1084; &#1072;&#1085;&#1072;&#1083;&#1086;&#1075;&#1080;&#1095;&#1085;&#1086; &#1083;&#1086;&#1075;&#1072;&#1088;&#1080;&#1092;&#1084;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100; &#1086;&#1076;&#1080;&#1085; &#1080;&#1079; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1086;&#1074;, &#1080;&#1084;&#1077;&#1102;&#1097;&#1080;&#1093; &#1090;&#1072;&#1082;&#1078;&#1077;
&#1089;&#1084;&#1077;&#1097;&#1105;&#1085;&#1085;&#1086;&#1077; &#1088;&#1072;&#1089;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1080;&#1077; (&#1101;&#1090;&#1086;&#1090; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082; &#1073;&#1099;&#1083; &#1074;&#1090;&#1086;&#1088;&#1099;&#1084; &#1087;&#1086; &#1074;&#1072;&#1078;&#1085;&#1086;&#1089;&#1090;&#1080;!)

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>X_train<span style="color: #666666">.</span>GrLivArea <span style="color: #666666">=</span> np<span style="color: #666666">.</span>log(X_train<span style="color: #666666">.</span>GrLivArea <span style="color: #666666">+</span> <span style="color: #666666">1</span>)
X_test<span style="color: #666666">.</span>GrLivArea <span style="color: #666666">=</span> np<span style="color: #666666">.</span>log(X_test<span style="color: #666666">.</span>GrLivArea <span style="color: #666666">+</span> <span style="color: #666666">1</span>)
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>model <span style="color: #666666">=</span> Ridge()
model<span style="color: #666666">.</span>fit(X_train[numeric_features], y_train)
y_pred <span style="color: #666666">=</span> model<span style="color: #666666">.</span>predict(X_test[numeric_features])

<span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Test RMSE = </span><span style="color: #BB6688; font-weight: bold">%.4f</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> mean_squared_error(y_test, y_pred) <span style="color: #666666">**</span> <span style="color: #666666">0.5</span>)
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>model <span style="color: #666666">=</span> Ridge()
model<span style="color: #666666">.</span>fit(X_train[numeric_features], np<span style="color: #666666">.</span>log(y_train<span style="color: #666666">+1</span>))
y_pred <span style="color: #666666">=</span> np<span style="color: #666666">.</span>exp(model<span style="color: #666666">.</span>predict(X_test[numeric_features]))<span style="color: #666666">-1</span>

<span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Test RMSE = </span><span style="color: #BB6688; font-weight: bold">%.4f</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> mean_squared_error(y_test, y_pred) <span style="color: #666666">**</span> <span style="color: #666666">0.5</span>)
</pre></div>
<p>
&#1050;&#1072;&#1082; &#1074;&#1080;&#1076;&#1080;&#1084;, &#1087;&#1088;&#1077;&#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1074;&#1072;&#1085;&#1080;&#1077; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1086;&#1074; &#1074;&#1083;&#1080;&#1103;&#1077;&#1090; &#1089;&#1083;&#1072;&#1073;&#1077;&#1077;. &#1055;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1086;&#1074; &#1084;&#1085;&#1086;&#1075;&#1086;, &#1072;
&#1074;&#1082;&#1083;&#1072;&#1076; &#1088;&#1072;&#1079;&#1084;&#1099;&#1074;&#1072;&#1077;&#1090;&#1089;&#1103; &#1087;&#1086; &#1074;&#1089;&#1077;&#1084;. &#1050; &#1090;&#1086;&#1084;&#1091; &#1078;&#1077;, &#1087;&#1088;&#1086;&#1074;&#1077;&#1088;&#1103;&#1090;&#1100; &#1088;&#1072;&#1089;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1080;&#1077;
&#1084;&#1085;&#1086;&#1078;&#1077;&#1089;&#1090;&#1074;&#1072; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1086;&#1074; &#1090;&#1077;&#1093;&#1085;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080; &#1089;&#1083;&#1086;&#1078;&#1085;&#1077;&#1077;, &#1095;&#1077;&#1084; &#1086;&#1076;&#1085;&#1086;&#1081; &#1094;&#1077;&#1083;&#1077;&#1074;&#1086;&#1081; &#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1086;&#1081;.

<h2 id="ml:features:binarize" class="anchor">&#1041;&#1080;&#1085;&#1072;&#1088;&#1080;&#1079;&#1072;&#1094;&#1080;&#1103;</h2>

<p>
&#1052;&#1099; &#1091;&#1078;&#1077; &#1089;&#1084;&#1086;&#1090;&#1088;&#1077;&#1083;&#1080;, &#1082;&#1072;&#1082; &#1087;&#1086;&#1083;&#1080;&#1085;&#1086;&#1084;&#1080;&#1072;&#1083;&#1100;&#1085;&#1099;&#1077; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1080; &#1084;&#1086;&#1075;&#1091;&#1090; &#1087;&#1086;&#1084;&#1086;&#1095;&#1100; &#1087;&#1088;&#1080;
&#1074;&#1086;&#1089;&#1089;&#1090;&#1072;&#1085;&#1086;&#1074;&#1083;&#1077;&#1085;&#1080;&#1080; &#1085;&#1077;&#1083;&#1080;&#1085;&#1077;&#1081;&#1085;&#1086;&#1081; &#1079;&#1072;&#1074;&#1080;&#1089;&#1080;&#1084;&#1086;&#1089;&#1090;&#1080; &#1083;&#1080;&#1085;&#1077;&#1081;&#1085;&#1086;&#1081; &#1084;&#1086;&#1076;&#1077;&#1083;&#1100;&#1102;. &#1040;&#1083;&#1100;&#1090;&#1077;&#1088;&#1085;&#1072;&#1090;&#1080;&#1074;&#1085;&#1099;&#1081;
&#1087;&#1086;&#1076;&#1093;&#1086;&#1076; &#1079;&#1072;&#1082;&#1083;&#1102;&#1095;&#1072;&#1077;&#1090;&#1089;&#1103; &#1074; &#1073;&#1080;&#1085;&#1072;&#1088;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1086;&#1074;. &#1052;&#1099; &#1088;&#1072;&#1079;&#1073;&#1080;&#1074;&#1072;&#1077;&#1084; &#1086;&#1089;&#1100; &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1081;
&#1086;&#1076;&#1085;&#1086;&#1075;&#1086; &#1080;&#1079; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1086;&#1074; &#1085;&#1072; &#1082;&#1091;&#1089;&#1082;&#1080; (&#1073;&#1080;&#1085;&#1099;) &#1080; &#1076;&#1086;&#1073;&#1072;&#1074;&#1083;&#1103;&#1077;&#1084; &#1076;&#1083;&#1103; &#1082;&#1072;&#1078;&#1076;&#1086;&#1075;&#1086; &#1082;&#1091;&#1089;&#1082;&#1072;-&#1073;&#1080;&#1085;&#1072;
&#1085;&#1086;&#1074;&#1099;&#1081; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;-&#1080;&#1085;&#1076;&#1080;&#1082;&#1072;&#1090;&#1086;&#1088; &#1087;&#1086;&#1087;&#1072;&#1076;&#1077;&#1085;&#1080;&#1103; &#1074; &#1101;&#1090;&#1086;&#1090; &#1073;&#1080;&#1085;.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.linear_model</span> <span style="color: #008000; font-weight: bold">import</span> LinearRegression

np<span style="color: #666666">.</span>random<span style="color: #666666">.</span>seed(<span style="color: #666666">36</span>)
X <span style="color: #666666">=</span> np<span style="color: #666666">.</span>random<span style="color: #666666">.</span>uniform(<span style="color: #666666">0</span>, <span style="color: #666666">1</span>, size<span style="color: #666666">=100</span>)
y <span style="color: #666666">=</span> np<span style="color: #666666">.</span>cos(<span style="color: #666666">1.5</span> <span style="color: #666666">*</span> np<span style="color: #666666">.</span>pi <span style="color: #666666">*</span> X) <span style="color: #666666">+</span> np<span style="color: #666666">.</span>random<span style="color: #666666">.</span>normal(scale<span style="color: #666666">=0.1</span>, size<span style="color: #666666">=</span>X<span style="color: #666666">.</span>shape)
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>plt<span style="color: #666666">.</span>scatter(X, y)
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>X <span style="color: #666666">=</span> X<span style="color: #666666">.</span>reshape((<span style="color: #666666">-1</span>, <span style="color: #666666">1</span>))
thresholds <span style="color: #666666">=</span> np<span style="color: #666666">.</span>arange(<span style="color: #666666">0.2</span>, <span style="color: #666666">1.1</span>, <span style="color: #666666">0.2</span>)<span style="color: #666666">.</span>reshape((<span style="color: #666666">1</span>, <span style="color: #666666">-1</span>))

X_expand <span style="color: #666666">=</span> np<span style="color: #666666">.</span>hstack((
    X,
    ((X <span style="color: #666666">&gt;</span> thresholds[:, :<span style="color: #666666">-1</span>]) <span style="color: #666666">&amp;</span> (X <span style="color: #666666">&lt;=</span> thresholds[:, <span style="color: #666666">1</span>:]))<span style="color: #666666">.</span>astype(<span style="color: #008000">int</span>)))
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.model_selection</span> <span style="color: #008000; font-weight: bold">import</span> KFold
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.model_selection</span> <span style="color: #008000; font-weight: bold">import</span> cross_val_score
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">-</span>np<span style="color: #666666">.</span>mean(cross_val_score(
    LinearRegression(), X, y, cv<span style="color: #666666">=</span>KFold(n_splits<span style="color: #666666">=3</span>, random_state<span style="color: #666666">=123</span>),
    scoring<span style="color: #666666">=</span><span style="color: #BA2121">&#39;neg_mean_squared_error&#39;</span>))
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #666666">-</span>np<span style="color: #666666">.</span>mean(cross_val_score(
    LinearRegression(), X_expand, y, cv<span style="color: #666666">=</span>KFold(n_splits<span style="color: #666666">=3</span>, random_state<span style="color: #666666">=123</span>),
    scoring<span style="color: #666666">=</span><span style="color: #BA2121">&#39;neg_mean_squared_error&#39;</span>))
</pre></div>
<p>
&#1058;&#1072;&#1082; &#1083;&#1080;&#1085;&#1077;&#1081;&#1085;&#1072;&#1103; &#1084;&#1086;&#1076;&#1077;&#1083;&#1100; &#1084;&#1086;&#1078;&#1077;&#1090; &#1083;&#1091;&#1095;&#1096;&#1077; &#1074;&#1086;&#1089;&#1089;&#1090;&#1072;&#1085;&#1072;&#1074;&#1083;&#1080;&#1074;&#1072;&#1090;&#1100; &#1085;&#1077;&#1083;&#1080;&#1085;&#1077;&#1081;&#1085;&#1099;&#1077; &#1079;&#1072;&#1074;&#1080;&#1089;&#1080;&#1084;&#1086;&#1089;&#1090;&#1080;.

<h2 id="ml:features:transactions" class="anchor">&#1058;&#1088;&#1072;&#1085;&#1079;&#1072;&#1082;&#1094;&#1080;&#1086;&#1085;&#1085;&#1099;&#1077; &#1076;&#1072;&#1085;&#1085;&#1099;&#1077;</h2>

<p>
&#1053;&#1072;&#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1086;&#1082; &#1087;&#1086;&#1089;&#1084;&#1086;&#1090;&#1088;&#1080;&#1084;, &#1082;&#1072;&#1082; &#1084;&#1086;&#1078;&#1085;&#1086; &#1080;&#1079;&#1074;&#1083;&#1077;&#1082;&#1072;&#1090;&#1100; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1080; &#1080;&#1079; &#1090;&#1088;&#1072;&#1085;&#1079;&#1072;&#1082;&#1094;&#1080;&#1086;&#1085;&#1085;&#1099;&#1093; &#1076;&#1072;&#1085;&#1085;&#1099;&#1093;.

<p>
&#1058;&#1088;&#1072;&#1085;&#1079;&#1072;&#1082;&#1094;&#1080;&#1086;&#1085;&#1085;&#1099;&#1077; &#1076;&#1072;&#1085;&#1085;&#1099;&#1077; &#1093;&#1072;&#1088;&#1072;&#1082;&#1090;&#1077;&#1088;&#1080;&#1079;&#1091;&#1102;&#1090;&#1089;&#1103; &#1090;&#1077;&#1084;, &#1095;&#1090;&#1086; &#1077;&#1089;&#1090;&#1100; &#1084;&#1085;&#1086;&#1075;&#1086; &#1089;&#1090;&#1088;&#1086;&#1082;,
&#1093;&#1072;&#1088;&#1072;&#1082;&#1090;&#1077;&#1088;&#1080;&#1079;&#1091;&#1102;&#1097;&#1080;&#1093;&#1089;&#1103; &#1084;&#1086;&#1084;&#1077;&#1085;&#1090;&#1086;&#1074; &#1074;&#1088;&#1077;&#1084;&#1077;&#1085;&#1080; &#1080; &#1085;&#1077;&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1084; &#1095;&#1080;&#1089;&#1083;&#1086;&#1084; (&#1089;&#1091;&#1084;&#1084;&#1086;&#1081; &#1076;&#1077;&#1085;&#1077;&#1075;,
&#1085;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;). &#1055;&#1088;&#1080; &#1101;&#1090;&#1086;&#1084; &#1077;&#1089;&#1083;&#1080; &#1101;&#1090;&#1086; &#1073;&#1072;&#1085;&#1082;, &#1090;&#1086; &#1082;&#1072;&#1078;&#1076;&#1086;&#1084;&#1091; &#1095;&#1077;&#1083;&#1086;&#1074;&#1077;&#1082;&#1091; &#1087;&#1088;&#1080;&#1085;&#1072;&#1076;&#1083;&#1077;&#1078;&#1080;&#1090; &#1085;&#1077;
&#1086;&#1076;&#1085;&#1072; &#1090;&#1088;&#1072;&#1085;&#1079;&#1072;&#1082;&#1094;&#1080;&#1103;, &#1072; &#1095;&#1072;&#1097;&#1077; &#1074;&#1089;&#1077;&#1075;&#1086; &#1085;&#1072;&#1076;&#1086; &#1087;&#1088;&#1077;&#1076;&#1089;&#1082;&#1072;&#1079;&#1099;&#1074;&#1072;&#1090;&#1100; &#1085;&#1077;&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077; &#1089;&#1091;&#1097;&#1085;&#1086;&#1089;&#1090;&#1080;
&#1076;&#1083;&#1103; &#1082;&#1083;&#1080;&#1077;&#1085;&#1090;&#1086;&#1074;. &#1058;&#1072;&#1082;&#1080;&#1084; &#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1084;, &#1085;&#1072;&#1076;&#1086; &#1087;&#1086;&#1083;&#1091;&#1095;&#1080;&#1090;&#1100; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1080; &#1076;&#1083;&#1103; &#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1077;&#1081;
&#1080;&#1079; &#1084;&#1085;&#1086;&#1078;&#1077;&#1089;&#1090;&#1074;&#1072; &#1080;&#1093; &#1090;&#1088;&#1072;&#1085;&#1079;&#1072;&#1082;&#1094;&#1080;&#1081;. &#1069;&#1090;&#1080;&#1084; &#1084;&#1099; &#1080; &#1079;&#1072;&#1081;&#1084;&#1105;&#1084;&#1089;&#1103;.

<p>
&#1044;&#1083;&#1103; &#1087;&#1088;&#1080;&#1084;&#1077;&#1088;&#1072; &#1074;&#1086;&#1079;&#1100;&#1084;&#1105;&#1084; &#1076;&#1072;&#1085;&#1085;&#1099;&#1077; <a href="https://www.kaggle.com/regivm/retailtransactiondata/" target="_self">&#1086;&#1090;&#1089;&#1102;&#1076;&#1072;</a>. &#1047;&#1072;&#1076;&#1072;&#1095;&#1072;
&#1076;&#1077;&#1090;&#1077;&#1082;&#1090;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103; &#1092;&#1088;&#1086;&#1076;&#1086;&#1074;&#1099;&#1093; &#1082;&#1083;&#1080;&#1077;&#1085;&#1090;&#1086;&#1074;.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>customers <span style="color: #666666">=</span> pd<span style="color: #666666">.</span>read_csv(<span style="color: #BA2121">&#39;Retail_Data_Response.csv&#39;</span>)
transactions <span style="color: #666666">=</span> pd<span style="color: #666666">.</span>read_csv(<span style="color: #BA2121">&#39;Retail_Data_Transactions.csv&#39;</span>)
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>customers<span style="color: #666666">.</span>head()
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>transactions<span style="color: #666666">.</span>head()
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>transactions<span style="color: #666666">.</span>trans_date <span style="color: #666666">=</span> transactions<span style="color: #666666">.</span>trans_date<span style="color: #666666">.</span>apply(
    <span style="color: #008000; font-weight: bold">lambda</span> x: datetime<span style="color: #666666">.</span>datetime<span style="color: #666666">.</span>strptime(x, <span style="color: #BA2121">&#39;</span><span style="color: #BB6688; font-weight: bold">%d</span><span style="color: #BA2121">-%b-%y&#39;</span>))
</pre></div>
<p>
&#1055;&#1086;&#1089;&#1084;&#1086;&#1090;&#1088;&#1080;&#1084; &#1085;&#1072; &#1088;&#1072;&#1089;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1080;&#1077; &#1094;&#1077;&#1083;&#1077;&#1074;&#1086;&#1081; &#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1086;&#1081;:
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>customers<span style="color: #666666">.</span>response<span style="color: #666666">.</span>mean()
</pre></div>
<p>
&#1055;&#1086;&#1083;&#1091;&#1095;&#1072;&#1077;&#1084; &#1087;&#1088;&#1080;&#1084;&#1077;&#1088;&#1085;&#1086; 1 &#1082; 9 &#1087;&#1086;&#1083;&#1086;&#1078;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1099;&#1093; &#1087;&#1088;&#1080;&#1084;&#1077;&#1088;&#1086;&#1074;. &#1045;&#1089;&#1083;&#1080; &#1090;&#1072;&#1082;&#1080;&#1077; &#1076;&#1072;&#1085;&#1085;&#1099;&#1077;
&#1088;&#1072;&#1079;&#1073;&#1080;&#1074;&#1072;&#1090;&#1100; &#1085;&#1072; &#1095;&#1072;&#1089;&#1090;&#1080; &#1076;&#1083;&#1103; &#1082;&#1088;&#1086;&#1089;&#1089; &#1074;&#1072;&#1083;&#1080;&#1076;&#1072;&#1094;&#1080;&#1080;, &#1090;&#1086; &#1084;&#1086;&#1078;&#1077;&#1090; &#1087;&#1086;&#1083;&#1091;&#1095;&#1080;&#1090;&#1100;&#1089;&#1103; &#1090;&#1072;&#1082;, &#1095;&#1090;&#1086; &#1074;
&#1086;&#1076;&#1085;&#1091; &#1080;&#1079; &#1095;&#1072;&#1089;&#1090;&#1077;&#1081; &#1087;&#1086;&#1087;&#1072;&#1076;&#1105;&#1090; &#1089;&#1083;&#1080;&#1096;&#1082;&#1086;&#1084; &#1084;&#1072;&#1083;&#1086; &#1087;&#1086;&#1083;&#1086;&#1078;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1099;&#1093; &#1087;&#1088;&#1080;&#1084;&#1077;&#1088;&#1086;&#1074;, &#1072; &#1074; &#1076;&#1088;&#1091;&#1075;&#1091;&#1102;
&#8212; &#1085;&#1072;&#1086;&#1073;&#1086;&#1088;&#1086;&#1090;. &#1053;&#1072; &#1089;&#1083;&#1091;&#1095;&#1072;&#1081; &#1090;&#1072;&#1082;&#1086;&#1075;&#1086; &#1085;&#1077;&#1088;&#1072;&#1074;&#1085;&#1086;&#1084;&#1077;&#1088;&#1085;&#1086;&#1075;&#1086; &#1073;&#1072;&#1083;&#1072;&#1085;&#1089;&#1072; &#1082;&#1083;&#1072;&#1089;&#1089;&#1086;&#1074; &#1077;&#1089;&#1090;&#1100;
<code>StratifiedKFold</code>, &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1081; &#1073;&#1100;&#1105;&#1090; &#1076;&#1072;&#1085;&#1085;&#1099;&#1077; &#1090;&#1072;&#1082;, &#1095;&#1090;&#1086;&#1073;&#1099; &#1073;&#1072;&#1083;&#1072;&#1085;&#1089; &#1082;&#1083;&#1072;&#1089;&#1089;&#1086;&#1074; &#1074;&#1086; &#1074;&#1089;&#1077;&#1093;
&#1095;&#1072;&#1089;&#1090;&#1103;&#1093; &#1073;&#1099;&#1083; &#1086;&#1076;&#1080;&#1085;&#1072;&#1082;&#1086;&#1074;&#1099;&#1084;.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.model_selection</span> <span style="color: #008000; font-weight: bold">import</span> StratifiedKFold
</pre></div>
<p>
&#1050;&#1086;&#1075;&#1076;&#1072; &#1089;&#1090;&#1088;&#1086;&#1082; &#1085;&#1072; &#1082;&#1072;&#1078;&#1076;&#1099;&#1081; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090; &#1084;&#1085;&#1086;&#1075;&#1086;, &#1084;&#1086;&#1078;&#1085;&#1086; &#1089;&#1095;&#1080;&#1090;&#1072;&#1090;&#1100; &#1088;&#1072;&#1079;&#1083;&#1080;&#1095;&#1085;&#1099;&#1077;
&#1089;&#1090;&#1072;&#1090;&#1080;&#1089;&#1090;&#1080;&#1082;&#1080;. &#1053;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;, &#1089;&#1088;&#1077;&#1076;&#1085;&#1080;&#1077;, &#1084;&#1080;&#1085;&#1080;&#1084;&#1072;&#1083;&#1100;&#1085;&#1099;&#1077; &#1080; &#1084;&#1072;&#1082;&#1089;&#1080;&#1084;&#1072;&#1083;&#1100;&#1085;&#1099;&#1077; &#1089;&#1091;&#1084;&#1084;&#1099;,
&#1087;&#1086;&#1090;&#1088;&#1072;&#1095;&#1077;&#1085;&#1085;&#1099;&#1077; &#1082;&#1083;&#1080;&#1077;&#1085;&#1090;&#1086;&#1084;, &#1082;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086; &#1090;&#1088;&#1072;&#1085;&#1079;&#1072;&#1082;&#1080;&#1081;, ...

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>agg_transactions <span style="color: #666666">=</span> transactions<span style="color: #666666">.</span>groupby(<span style="color: #BA2121">&#39;customer_id&#39;</span>)<span style="color: #666666">.</span>tran_amount<span style="color: #666666">.</span>agg(
    [<span style="color: #BA2121">&#39;mean&#39;</span>, <span style="color: #BA2121">&#39;std&#39;</span>, <span style="color: #BA2121">&#39;count&#39;</span>, <span style="color: #BA2121">&#39;min&#39;</span>, <span style="color: #BA2121">&#39;max&#39;</span>])<span style="color: #666666">.</span>reset_index()

data <span style="color: #666666">=</span> pd<span style="color: #666666">.</span>merge(customers, agg_transactions, how<span style="color: #666666">=</span><span style="color: #BA2121">&#39;left&#39;</span>, on<span style="color: #666666">=</span><span style="color: #BA2121">&#39;customer_id&#39;</span>)

data<span style="color: #666666">.</span>head()
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.linear_model</span> <span style="color: #008000; font-weight: bold">import</span> LogisticRegression

np<span style="color: #666666">.</span>mean(cross_val_score(
    LogisticRegression(),
    X<span style="color: #666666">=</span>data<span style="color: #666666">.</span>drop([<span style="color: #BA2121">&#39;customer_id&#39;</span>, <span style="color: #BA2121">&#39;response&#39;</span>], axis<span style="color: #666666">=1</span>),
    y<span style="color: #666666">=</span>data<span style="color: #666666">.</span>response,
    cv<span style="color: #666666">=</span>StratifiedKFold(n_splits<span style="color: #666666">=3</span>, random_state<span style="color: #666666">=123</span>),
    scoring<span style="color: #666666">=</span><span style="color: #BA2121">&#39;roc_auc&#39;</span>))
</pre></div>
<p>
&#1053;&#1086; &#1082;&#1072;&#1078;&#1076;&#1072;&#1103; &#1090;&#1088;&#1072;&#1085;&#1079;&#1072;&#1082;&#1094;&#1080;&#1103; &#1089;&#1085;&#1072;&#1073;&#1078;&#1077;&#1085;&#1072; &#1076;&#1072;&#1090;&#1086;&#1081;! &#1052;&#1086;&#1078;&#1085;&#1086; &#1087;&#1086;&#1089;&#1095;&#1080;&#1090;&#1072;&#1090;&#1100; &#1089;&#1090;&#1072;&#1090;&#1080;&#1089;&#1090;&#1080;&#1082;&#1080; &#1090;&#1086;&#1083;&#1100;&#1082;&#1086;
&#1087;&#1086; &#1089;&#1074;&#1077;&#1078;&#1080;&#1084; &#1090;&#1088;&#1072;&#1085;&#1079;&#1072;&#1082;&#1094;&#1080;&#1103;&#1084;. &#1044;&#1086;&#1073;&#1072;&#1074;&#1080;&#1084; &#1080;&#1093;.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>transactions<span style="color: #666666">.</span>trans_date<span style="color: #666666">.</span>min(), transactions<span style="color: #666666">.</span>trans_date<span style="color: #666666">.</span>max()
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>agg_transactions <span style="color: #666666">=</span> transactions<span style="color: #666666">.</span>loc[transactions<span style="color: #666666">.</span>trans_date<span style="color: #666666">.</span>apply(
    <span style="color: #008000; font-weight: bold">lambda</span> x: x<span style="color: #666666">.</span>year <span style="color: #666666">==</span> <span style="color: #666666">2014</span>)]<span style="color: #666666">.</span>groupby(<span style="color: #BA2121">&#39;customer_id&#39;</span>)<span style="color: #666666">.</span>tran_amount<span style="color: #666666">.</span>agg(
    [<span style="color: #BA2121">&#39;mean&#39;</span>, <span style="color: #BA2121">&#39;std&#39;</span>, <span style="color: #BA2121">&#39;count&#39;</span>, <span style="color: #BA2121">&#39;min&#39;</span>, <span style="color: #BA2121">&#39;max&#39;</span>])<span style="color: #666666">.</span>reset_index()
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>data <span style="color: #666666">=</span> pd<span style="color: #666666">.</span>merge(data, agg_transactions, how<span style="color: #666666">=</span><span style="color: #BA2121">&#39;left&#39;</span>, on<span style="color: #666666">=</span><span style="color: #BA2121">&#39;customer_id&#39;</span>, suffixes<span style="color: #666666">=</span>(<span style="color: #BA2121">&#39;&#39;</span>, <span style="color: #BA2121">&#39;_2014&#39;</span>))
data <span style="color: #666666">=</span> data<span style="color: #666666">.</span>fillna(<span style="color: #666666">0</span>)
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>np<span style="color: #666666">.</span>mean(cross_val_score(
    LogisticRegression(),
    X<span style="color: #666666">=</span>data<span style="color: #666666">.</span>drop([<span style="color: #BA2121">&#39;customer_id&#39;</span>, <span style="color: #BA2121">&#39;response&#39;</span>], axis<span style="color: #666666">=1</span>),
    y<span style="color: #666666">=</span>data<span style="color: #666666">.</span>response,
    cv<span style="color: #666666">=</span>StratifiedKFold(n_splits<span style="color: #666666">=3</span>, random_state<span style="color: #666666">=123</span>),
    scoring<span style="color: #666666">=</span><span style="color: #BA2121">&#39;roc_auc&#39;</span>))
</pre></div>
<p>
&#1052;&#1086;&#1078;&#1085;&#1086; &#1090;&#1072;&#1082;&#1078;&#1077; &#1089;&#1095;&#1080;&#1090;&#1072;&#1090;&#1100; &#1076;&#1072;&#1090;&#1091; &#1087;&#1077;&#1088;&#1074;&#1086;&#1081; &#1080; &#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1085;&#1077;&#1081; &#1090;&#1088;&#1072;&#1085;&#1079;&#1072;&#1082;&#1094;&#1080;&#1103;&#1084;&#1080;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1077;&#1081;, &#1089;&#1088;&#1077;&#1076;&#1085;&#1077;&#1077; &#1074;&#1088;&#1077;&#1084;&#1103; &#1084;&#1077;&#1078;&#1076;&#1091; &#1090;&#1088;&#1072;&#1085;&#1079;&#1072;&#1082;&#1094;&#1080;&#1103;&#1084;&#1080; &#1080; &#1087;&#1088;&#1086;&#1095;&#1077;&#1077;.

<p>
<!-- Local Variables: -->
<!-- doconce-chapter-nickname: "ml" -->
<!-- doconce-section-nickname: "features" -->
<!-- End: -->

<p>
<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">

  <li class="previous">
    <a href="._ml-flatly002.html">&larr; Prev</a>
  </li>

  <li class="next">
    <a href="._ml-flatly004.html">Next &rarr;</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


</body>
</html>
    

