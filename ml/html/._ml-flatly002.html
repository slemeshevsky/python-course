<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="Машинное обучиение с использованием библиотек Python">

<title>Машинное обучиение с использованием библиотек Python</title>

<!-- Bootstrap style: bootswatch_flatly -->
<link href="https://netdna.bootstrapcdn.com/bootswatch/3.1.1/flatly/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">

/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}

/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:60px;      /* fixed header height for style bootswatch_flatly */
  margin:-60px 0 0; /* negative fixed header height */
}

body { font-size:20px; }
</style>




<!-- Tools for embedded Bokeh plots -->
<link rel=stylesheet 
      href=https://cdn.pydata.org/bokeh/release/bokeh-0.12.4.min.css 
      type=text/css />
<script type=text/javascript 
        src=https://cdn.pydata.org/bokeh/release/bokeh-0.12.4.min.js>
</script>
<script type=text/javascript>
  Bokeh.set_log_level("info");
</script>

<style>
.bk-embeded {
    width: 100%;
    margin: auto;
    height: 500px;
    text-align: webkit-left;
}
</style>


</head>


<!-- tocinfo
{'highest level': 1,
 'sections': [('Содержание',
               1,
               'table_of_contents',
               'table_of_contents'),
              ('Основные определения и постановки задач машинного обучения',
               1,
               'ml:intro',
               'ml:intro'),
              ('Примеры задач машинного обучения',
               2,
               'ml:intro:examples',
               'ml:intro:examples'),
              ('Линейная регрессия',
               2,
               'ml:linear-regression',
               'ml:linear-regression'),
              ('Загрузка данных',
               2,
               'ml:linear-regression:load',
               'ml:linear-regression:load'),
              ('Первая модель',
               2,
               'ml:linear-regression:1st',
               'ml:linear-regression:1st'),
              ('Работа с категориальными признаками',
               2,
               'ml:linear-regression:categ',
               'ml:linear-regression:categ'),
              ('Предобработка данных', 1, 'ml:features', 'ml:features'),
              ('Работа с текстовыми данными',
               2,
               'ml:features:text-work',
               'ml:features:text-work'),
              ('Bag-of-words',
               3,
               'ml:features:bag-of-words',
               'ml:features:bag-of-words'),
              ('TF-IDF', 3, 'ml:features:tf-idf', 'ml:features:tf-idf'),
              ('Стемминг', 3, 'ml:features:stemming', 'ml:features:stemming'),
              ('Лематизация', 3, 'ml:features:lemma', 'ml:features:lemma'),
              ('Трансформация признаков и целевой переменной',
               2,
               'ml:features:trans',
               'ml:features:trans'),
              ('Логарифмирование', 3, 'ml:features:log', 'ml:features:log'),
              ('Бинаризация',
               2,
               'ml:features:binarize',
               'ml:features:binarize'),
              ('Транзакционные данные',
               2,
               'ml:features:transactions',
               'ml:features:transactions'),
              ('Простые модели классификации', 1, 'ml:class', 'ml:class'),
              ('Матрица ошибок', 2, 'ml:class:conf-matr', 'ml:class:conf-matr'),
              ('Линейная классификация',
               2,
               'ml:class:linear-class',
               'ml:class:linear-class'),
              ('Логистическая регрессия',
               3,
               'ml:class:linear-class:logistic',
               'ml:class:linear-class:logistic'),
              ('Задание', 1, 'ml:task', 'ml:task'),
              ('Задание по базе wine', 2, 'ml:task:1', 'ml:task:1')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="ml-flatly.html">Машинное обучиение с использованием библиотек Python</a>
  </div>

  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="._ml-flatly000.html#table_of_contents" style="font-size: 80%;"><b>Содержание</b></a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly001.html#ml:intro" style="font-size: 80%;"><b>Основные определения и постановки задач машинного обучения</b></a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly001.html#ml:intro:examples" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Примеры задач машинного обучения</a></li>
     <!-- navigation toc: --> <li><a href="#ml:linear-regression" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Линейная регрессия</a></li>
     <!-- navigation toc: --> <li><a href="#ml:linear-regression:load" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Загрузка данных</a></li>
     <!-- navigation toc: --> <li><a href="#ml:linear-regression:1st" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Первая модель</a></li>
     <!-- navigation toc: --> <li><a href="#ml:linear-regression:categ" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Работа с категориальными признаками</a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly003.html#ml:features" style="font-size: 80%;"><b>Предобработка данных</b></a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly003.html#ml:features:text-work" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Работа с текстовыми данными</a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly003.html#ml:features:bag-of-words" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Bag-of-words</a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly003.html#ml:features:tf-idf" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TF-IDF</a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly003.html#ml:features:stemming" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Стемминг</a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly003.html#ml:features:lemma" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Лематизация</a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly003.html#ml:features:trans" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Трансформация признаков и целевой переменной</a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly003.html#ml:features:log" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Логарифмирование</a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly003.html#ml:features:binarize" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Бинаризация</a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly003.html#ml:features:transactions" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Транзакционные данные</a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly004.html#ml:class" style="font-size: 80%;"><b>Простые модели классификации</b></a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly004.html#ml:class:conf-matr" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Матрица ошибок</a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly004.html#ml:class:linear-class" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Линейная классификация</a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly004.html#ml:class:linear-class:logistic" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Логистическая регрессия</a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly005.html#ml:task" style="font-size: 80%;"><b>Задание</b></a></li>
     <!-- navigation toc: --> <li><a href="._ml-flatly005.html#ml:task:1" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Задание по базе wine</a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<a name="part0002"></a>
<!-- !split -->

<h2 id="ml:linear-regression" class="anchor">&#1051;&#1080;&#1085;&#1077;&#1081;&#1085;&#1072;&#1103; &#1088;&#1077;&#1075;&#1088;&#1077;&#1089;&#1089;&#1080;&#1103;</h2>

<p>
&#1053;&#1072;&#1095;&#1085;&#1077;&#1084; &#1089; &#1087;&#1086;&#1076;&#1082;&#1083;&#1102;&#1095;&#1077;&#1085;&#1080;&#1103; &#1085;&#1077;&#1086;&#1073;&#1093;&#1086;&#1076;&#1080;&#1084;&#1099;&#1093; &#1073;&#1080;&#1073;&#1083;&#1080;&#1086;&#1090;&#1077;&#1082;
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">seaborn</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">sns</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">pandas</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">pd</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>
</pre></div>
<p>
<em>&#1051;&#1080;&#1085;&#1077;&#1081;&#1085;&#1072;&#1103; &#1088;&#1077;&#1075;&#1088;&#1077;&#1089;&#1089;&#1080;&#1103;</em> &#8212; &#1101;&#1090;&#1086; &#1084;&#1086;&#1076;&#1077;&#1083;&#1100; &#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1077;&#1075;&#1086; &#1074;&#1080;&#1076;&#1072;:
$$
\begin{equation}
\tag{1}
a(x) = \langle a, w \rangle + w_0 = \sum_{i = 1}^{d} w_i x_i + w_0,
\end{equation}
$$

&#1075;&#1076;&#1077; \( w \in \mathbb{R}^d \), \( w_0 \in \mathbb{R} \). &#1055;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1072;&#1084;&#1080; &#1084;&#1086;&#1076;&#1077;&#1083;&#1080;
&#1103;&#1074;&#1083;&#1103;&#1102;&#1090;&#1089;&#1103; <em>&#1074;&#1077;&#1089;&#1072;</em> &#1080;&#1083;&#1080; <em>&#1082;&#1086;&#1101;&#1092;&#1092;&#1080;&#1094;&#1080;&#1077;&#1085;&#1090;&#1099;</em> \( w_i \). &#1042;&#1077;&#1089; \( w_0 \) &#1090;&#1072;&#1082;&#1078;&#1077; &#1085;&#1072;&#1079;&#1099;&#1074;&#1072;&#1077;&#1090;&#1089;&#1103; 
<em>&#1089;&#1074;&#1086;&#1073;&#1086;&#1076;&#1085;&#1099;&#1084; &#1082;&#1086;&#1101;&#1092;&#1092;&#1080;&#1094;&#1080;&#1077;&#1085;&#1090;&#1086;&#1084;</em> &#1080;&#1083;&#1080; <em>&#1089;&#1076;&#1074;&#1080;&#1075;&#1086;&#1084;</em> (bias). &#1054;&#1073;&#1091;&#1095;&#1080;&#1090;&#1100; &#1083;&#1080;&#1085;&#1077;&#1081;&#1085;&#1091;&#1102;
&#1088;&#1077;&#1075;&#1088;&#1077;&#1089;&#1089;&#1080;&#1102; &#8212; &#1079;&#1085;&#1072;&#1095;&#1080;&#1090; &#1085;&#1072;&#1081;&#1090;&#1080; \( w \) &#1080; \( w_0 \).

<p>
&#1042; &#1084;&#1072;&#1096;&#1080;&#1085;&#1085;&#1086;&#1084; &#1086;&#1073;&#1091;&#1095;&#1077;&#1085;&#1080;&#1080; &#1095;&#1072;&#1089;&#1090;&#1086; &#1075;&#1086;&#1074;&#1086;&#1088;&#1103;&#1090; &#1086;&#1073; <em>&#1086;&#1073;&#1086;&#1073;&#1097;&#1072;&#1102;&#1097;&#1077;&#1081; &#1089;&#1087;&#1086;&#1089;&#1086;&#1073;&#1085;&#1086;&#1089;&#1090;&#1080; &#1084;&#1086;&#1076;&#1077;&#1083;&#1080;</em>,
&#1090;&#1086; &#1077;&#1089;&#1090;&#1100; &#1086; &#1089;&#1087;&#1086;&#1089;&#1086;&#1073;&#1085;&#1086;&#1089;&#1090;&#1080; &#1084;&#1086;&#1076;&#1077;&#1083;&#1080; &#1088;&#1072;&#1073;&#1086;&#1090;&#1072;&#1090;&#1100; &#1085;&#1072; &#1085;&#1086;&#1074;&#1099;&#1093;, &#1090;&#1077;&#1089;&#1090;&#1086;&#1074;&#1099;&#1093; &#1076;&#1072;&#1085;&#1085;&#1099;&#1093;
&#1093;&#1086;&#1088;&#1086;&#1096;&#1086;. &#1045;&#1089;&#1083;&#1080; &#1084;&#1086;&#1076;&#1077;&#1083;&#1100; &#1073;&#1091;&#1076;&#1077;&#1090; &#1080;&#1076;&#1077;&#1072;&#1083;&#1100;&#1085;&#1086; &#1087;&#1088;&#1077;&#1076;&#1089;&#1082;&#1072;&#1079;&#1099;&#1074;&#1072;&#1090;&#1100; &#1074;&#1099;&#1073;&#1086;&#1088;&#1082;&#1091;, &#1085;&#1072; &#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1081;
&#1086;&#1085;&#1072; &#1086;&#1073;&#1091;&#1095;&#1072;&#1083;&#1072;&#1089;&#1100;, &#1085;&#1086; &#1087;&#1088;&#1080; &#1101;&#1090;&#1086;&#1084; &#1087;&#1088;&#1086;&#1089;&#1090;&#1086; &#1077;&#1077; &#1079;&#1072;&#1087;&#1086;&#1084;&#1085;&#1080;&#1090;, &#1085;&#1077; &#171;&#1074;&#1099;&#1090;&#1072;&#1097;&#1080;&#1074;&#187; &#1080;&#1079; &#1076;&#1072;&#1085;&#1085;&#1099;&#1093;
&#1085;&#1080;&#1082;&#1072;&#1082;&#1086;&#1081; &#1079;&#1072;&#1082;&#1086;&#1085;&#1086;&#1084;&#1077;&#1088;&#1085;&#1086;&#1089;&#1090;&#1080;, &#1086;&#1090; &#1085;&#1077;&#1077; &#1073;&#1091;&#1076;&#1077;&#1090; &#1084;&#1072;&#1083;&#1086; &#1090;&#1086;&#1083;&#1082;&#1091;. &#1058;&#1072;&#1082;&#1091;&#1102; &#1084;&#1086;&#1076;&#1077;&#1083;&#1100;
&#1085;&#1072;&#1079;&#1099;&#1074;&#1072;&#1102;&#1090; <em>&#1087;&#1077;&#1088;&#1077;&#1086;&#1073;&#1091;&#1095;&#1077;&#1085;&#1085;&#1086;&#1081;</em>: &#1086;&#1085;&#1072; &#1089;&#1083;&#1080;&#1096;&#1082;&#1086;&#1084; &#1087;&#1086;&#1076;&#1089;&#1090;&#1088;&#1086;&#1080;&#1083;&#1072;&#1089;&#1100; &#1087;&#1086;&#1076; &#1086;&#1073;&#1091;&#1095;&#1072;&#1102;&#1097;&#1080;&#1077;
&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;&#1099;, &#1085;&#1077; &#1074;&#1099;&#1103;&#1074;&#1080;&#1074; &#1085;&#1080;&#1082;&#1072;&#1082;&#1086;&#1081; &#1087;&#1086;&#1083;&#1077;&#1079;&#1085;&#1086;&#1081; &#1079;&#1072;&#1082;&#1086;&#1085;&#1086;&#1084;&#1077;&#1088;&#1085;&#1086;&#1089;&#1090;&#1080;, &#1082;&#1086;&#1090;&#1086;&#1088;&#1072;&#1103; &#1087;&#1086;&#1079;&#1074;&#1086;&#1083;&#1080;&#1083;&#1072;
&#1073;&#1099; &#1077;&#1081; &#1089;&#1086;&#1074;&#1077;&#1088;&#1096;&#1072;&#1090;&#1100; &#1093;&#1086;&#1088;&#1086;&#1096;&#1080;&#1077; &#1087;&#1088;&#1077;&#1076;&#1089;&#1082;&#1072;&#1079;&#1072;&#1085;&#1080;&#1103; &#1085;&#1072; &#1076;&#1072;&#1085;&#1085;&#1099;&#1093;, &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077; &#1086;&#1085;&#1072; &#1088;&#1072;&#1085;&#1077;&#1077; &#1085;&#1077;
&#1074;&#1080;&#1076;&#1077;&#1083;&#1072;.

<p>
&#1056;&#1072;&#1089;&#1089;&#1084;&#1086;&#1090;&#1088;&#1080;&#1084; &#1089;&#1083;&#1077;&#1076;&#1091;&#1102;&#1097;&#1080;&#1081; &#1087;&#1088;&#1080;&#1084;&#1077;&#1088;, &#1085;&#1072; &#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1084; &#1073;&#1091;&#1076;&#1077;&#1090; &#1093;&#1086;&#1088;&#1086;&#1096;&#1086; &#1074;&#1080;&#1076;&#1085;&#1086;, &#1095;&#1090;&#1086; &#1079;&#1085;&#1072;&#1095;&#1080;&#1090;
&#1087;&#1077;&#1088;&#1077;&#1086;&#1073;&#1091;&#1095;&#1077;&#1085;&#1080;&#1077; &#1084;&#1086;&#1076;&#1077;&#1083;&#1080;. &#1044;&#1083;&#1103; &#1101;&#1090;&#1086;&#1075;&#1086; &#1085;&#1072;&#1084; &#1087;&#1086;&#1085;&#1072;&#1076;&#1086;&#1073;&#1080;&#1090;&#1089;&#1103; &#1089;&#1075;&#1077;&#1085;&#1077;&#1088;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100;
&#1089;&#1080;&#1085;&#1090;&#1077;&#1090;&#1080;&#1095;&#1077;&#1089;&#1082;&#1080;&#1077; &#1076;&#1072;&#1085;&#1085;&#1099;&#1077;. &#1056;&#1072;&#1089;&#1089;&#1084;&#1086;&#1090;&#1088;&#1080;&#1084; &#1079;&#1072;&#1074;&#1080;&#1089;&#1080;&#1084;&#1086;&#1089;&#1090;&#1100; \( y(x) = \cos(1.5\pi x) \),
\( y \) &#8212; &#1094;&#1077;&#1083;&#1077;&#1074;&#1072;&#1103; &#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1072;&#1103; (&#1090;&#1072;&#1088;&#1075;&#1077;&#1090;), &#1072; \( x \) &#8212; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090; (&#1087;&#1088;&#1086;&#1089;&#1090;&#1086; &#1095;&#1080;&#1089;&#1083;&#1086; &#1086;&#1090; \( 0 \) &#1076;&#1086;
\( 1 \)). &#1042; &#1078;&#1080;&#1079;&#1085;&#1080; &#1084;&#1099; &#1085;&#1072;&#1073;&#1083;&#1102;&#1076;&#1072;&#1077;&#1084; &#1082;&#1072;&#1082;&#1086;&#1077;-&#1090;&#1086; &#1082;&#1086;&#1085;&#1077;&#1095;&#1085;&#1086;&#1077; &#1082;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086; &#1087;&#1072;&#1088;
&#1086;&#1073;&#1098;&#1077;&#1082;&#1090;-&#1090;&#1072;&#1088;&#1075;&#1077;&#1090;, &#1087;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091; &#1089;&#1084;&#1086;&#1076;&#1077;&#1083;&#1080;&#1088;&#1091;&#1077;&#1084; &#1101;&#1090;&#1086;, &#1074;&#1079;&#1103;&#1074; \( 30 \) &#1089;&#1083;&#1091;&#1095;&#1072;&#1081;&#1085;&#1099;&#1093; &#1090;&#1086;&#1095;&#1077;&#1082; \( x_i \)
&#1074; &#1086;&#1090;&#1088;&#1077;&#1079;&#1082;&#1077; \( [0;1] \). &#1041;&#1086;&#1083;&#1077;&#1077; &#1090;&#1086;&#1075;&#1086;, &#1074; &#1088;&#1077;&#1072;&#1083;&#1100;&#1085;&#1086;&#1081; &#1078;&#1080;&#1079;&#1085;&#1080; &#1094;&#1077;&#1083;&#1077;&#1074;&#1072;&#1103; &#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1072;&#1103;
&#1084;&#1086;&#1078;&#1077;&#1090; &#1073;&#1099;&#1090;&#1100; &#1079;&#1072;&#1096;&#1091;&#1084;&#1083;&#1077;&#1085;&#1085;&#1086;&#1081; (&#1080;&#1079;&#1084;&#1077;&#1088;&#1077;&#1085;&#1080;&#1103; &#1074; &#1078;&#1080;&#1079;&#1085;&#1080; &#1085;&#1077; &#1074;&#1089;&#1077;&#1075;&#1076;&#1072; &#1090;&#1086;&#1095;&#1085;&#1099;),
&#1089;&#1084;&#1086;&#1076;&#1077;&#1083;&#1080;&#1088;&#1091;&#1077;&#1084; &#1101;&#1090;&#1086;, &#1079;&#1072;&#1096;&#1091;&#1084;&#1080;&#1074; &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; &#1085;&#1086;&#1088;&#1084;&#1072;&#1083;&#1100;&#1085;&#1099;&#1084; &#1096;&#1091;&#1084;&#1086;&#1084;:
\( \tilde{y}_i = y(x_i) + \mathcal{N}(0, 0.01) \):

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>np<span style="color: #666666">.</span>random<span style="color: #666666">.</span>seed(<span style="color: #666666">36</span>)
x <span style="color: #666666">=</span> np<span style="color: #666666">.</span>linspace(<span style="color: #666666">0</span>, <span style="color: #666666">1</span>, <span style="color: #666666">100</span>)
y <span style="color: #666666">=</span> np<span style="color: #666666">.</span>cos(<span style="color: #666666">1.5</span> <span style="color: #666666">*</span> np<span style="color: #666666">.</span>pi <span style="color: #666666">*</span> x)

x_objects <span style="color: #666666">=</span> np<span style="color: #666666">.</span>random<span style="color: #666666">.</span>uniform(<span style="color: #666666">0</span>, <span style="color: #666666">1</span>, size<span style="color: #666666">=30</span>)
y_objects <span style="color: #666666">=</span> np<span style="color: #666666">.</span>cos(<span style="color: #666666">1.5</span> <span style="color: #666666">*</span> np<span style="color: #666666">.</span>pi <span style="color: #666666">*</span> x_objects) <span style="color: #666666">+</span> np<span style="color: #666666">.</span>random<span style="color: #666666">.</span>normal(scale<span style="color: #666666">=0.1</span>, size<span style="color: #666666">=</span>x_objects<span style="color: #666666">.</span>shape)
</pre></div>
<p>
&#1055;&#1086;&#1087;&#1099;&#1090;&#1072;&#1077;&#1084;&#1089;&#1103; &#1086;&#1073;&#1091;&#1095;&#1080;&#1090;&#1100; &#1090;&#1088;&#1080; &#1088;&#1072;&#1079;&#1085;&#1099;&#1093; &#1083;&#1080;&#1085;&#1077;&#1081;&#1085;&#1099;&#1093; &#1084;&#1086;&#1076;&#1077;&#1083;&#1080;: &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1080; &#1076;&#1083;&#1103; &#1087;&#1077;&#1088;&#1074;&#1086;&#1081;
---  \( \{x\} \), &#1076;&#1083;&#1103; &#1074;&#1090;&#1086;&#1088;&#1086;&#1081; --- \( \{x, x^2, x^3, x^4\} \), &#1076;&#1083;&#1103;
&#1090;&#1088;&#1077;&#1090;&#1100;&#1077;&#1081; --- \( \{x, \dots, x^{20}\} \):
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.linear_model</span> <span style="color: #008000; font-weight: bold">import</span> LinearRegression
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.preprocessing</span> <span style="color: #008000; font-weight: bold">import</span> PolynomialFeatures


fig, axs <span style="color: #666666">=</span> plt<span style="color: #666666">.</span>subplots(figsize<span style="color: #666666">=</span>(<span style="color: #666666">16</span>, <span style="color: #666666">4</span>), ncols<span style="color: #666666">=3</span>)
<span style="color: #008000; font-weight: bold">for</span> i, degree <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">enumerate</span>([<span style="color: #666666">1</span>, <span style="color: #666666">4</span>, <span style="color: #666666">20</span>]):
    X_objects <span style="color: #666666">=</span> PolynomialFeatures(degree)<span style="color: #666666">.</span>fit_transform(x_objects[:, <span style="color: #008000; font-weight: bold">None</span>])
    X <span style="color: #666666">=</span> PolynomialFeatures(degree)<span style="color: #666666">.</span>fit_transform(x[:, <span style="color: #008000; font-weight: bold">None</span>])
    regr <span style="color: #666666">=</span> LinearRegression()<span style="color: #666666">.</span>fit(X_objects, y_objects)
    y_pred <span style="color: #666666">=</span> regr<span style="color: #666666">.</span>predict(X)
    axs[i]<span style="color: #666666">.</span>plot(x, y, label<span style="color: #666666">=</span><span style="color: #BA2121">&quot;Real function&quot;</span>)
    axs[i]<span style="color: #666666">.</span>scatter(x_objects, y_objects, label<span style="color: #666666">=</span><span style="color: #BA2121">&quot;Data&quot;</span>)
    axs[i]<span style="color: #666666">.</span>plot(x, y_pred, label<span style="color: #666666">=</span><span style="color: #BA2121">&quot;Prediction&quot;</span>)
    <span style="color: #008000; font-weight: bold">if</span> i <span style="color: #666666">==</span> <span style="color: #666666">0</span>:
        axs[i]<span style="color: #666666">.</span>legend()
    axs[i]<span style="color: #666666">.</span>set_title(<span style="color: #BA2121">&quot;Degree = </span><span style="color: #BB6688; font-weight: bold">%d</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> degree)
    axs[i]<span style="color: #666666">.</span>set_xlabel(<span style="color: #BA2121">&quot;$x$&quot;</span>)
    axs[i]<span style="color: #666666">.</span>set_ylabel(<span style="color: #BA2121">&quot;$f(x)$&quot;</span>)
    axs[i]<span style="color: #666666">.</span>set_ylim(<span style="color: #666666">-2</span>, <span style="color: #666666">2</span>)
</pre></div>
<p>
&#1063;&#1090;&#1086;&#1073;&#1099; &#1080;&#1079;&#1073;&#1077;&#1078;&#1072;&#1090;&#1100; &#1087;&#1077;&#1088;&#1077;&#1086;&#1073;&#1091;&#1095;&#1077;&#1085;&#1080;&#1103;, &#1084;&#1086;&#1076;&#1077;&#1083;&#1100; &#1088;&#1077;&#1075;&#1091;&#1083;&#1103;&#1088;&#1080;&#1079;&#1091;&#1102;&#1090;. &#1054;&#1073;&#1099;&#1095;&#1085;&#1086; &#1087;&#1077;&#1088;&#1077;&#1086;&#1073;&#1091;&#1095;&#1077;&#1085;&#1080;&#1103;
&#1074; &#1083;&#1080;&#1085;&#1077;&#1081;&#1085;&#1099;&#1093; &#1084;&#1086;&#1076;&#1077;&#1083;&#1103;&#1093; &#1089;&#1074;&#1103;&#1079;&#1072;&#1085;&#1099; &#1089; &#1073;&#1086;&#1083;&#1100;&#1096;&#1080;&#1084;&#1080; &#1074;&#1077;&#1089;&#1072;&#1084;&#1080;, &#1072; &#1087;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091; &#1084;&#1086;&#1076;&#1077;&#1083;&#1100; &#1095;&#1072;&#1089;&#1090;&#1086;
&#1096;&#1090;&#1088;&#1072;&#1092;&#1091;&#1102;&#1090; &#1079;&#1072; &#1073;&#1086;&#1083;&#1100;&#1096;&#1080;&#1077; &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1103; &#1074;&#1077;&#1089;&#1086;&#1074;, &#1076;&#1086;&#1073;&#1072;&#1074;&#1083;&#1103;&#1103; &#1082; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1086;&#1085;&#1072;&#1083;&#1091; &#1082;&#1072;&#1095;&#1077;&#1089;&#1090;&#1074;&#1072;,
&#1085;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;, &#1082;&#1074;&#1072;&#1076;&#1088;&#1072;&#1090; \( \ell^2 \)-&#1085;&#1086;&#1088;&#1084;&#1099; &#1074;&#1077;&#1082;&#1090;&#1086;&#1088;&#1072; \( w \): 

$$
\begin{equation*}
\tag{2}
Q_{reg}(X, y, a) = Q(X, y, a) + \lambda \|w\|_2^2
\end{equation*}
$$

<p>
&#1069;&#1090;&#1086; &#1089;&#1083;&#1072;&#1075;&#1072;&#1077;&#1084;&#1086;&#1077; &#1085;&#1072;&#1079;&#1099;&#1074;&#1072;&#1102;&#1090; \( \ell_2 \)-&#1088;&#1077;&#1075;&#1091;&#1083;&#1103;&#1088;&#1080;&#1079;&#1072;&#1090;&#1086;&#1088;&#1086;&#1084;, &#1072; &#1082;&#1086;&#1101;&#1092;&#1092;&#1080;&#1094;&#1080;&#1077;&#1085;&#1090;
\( \lambda \) --- &#1082;&#1086;&#1101;&#1092;&#1092;&#1080;&#1094;&#1080;&#1077;&#1085;&#1090;&#1086;&#1084; &#1088;&#1077;&#1075;&#1091;&#1083;&#1103;&#1088;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;.

<h2 id="ml:linear-regression:load" class="anchor">&#1047;&#1072;&#1075;&#1088;&#1091;&#1079;&#1082;&#1072; &#1076;&#1072;&#1085;&#1085;&#1099;&#1093;</h2>

<p>
&#1052;&#1099; &#1073;&#1091;&#1076;&#1077;&#1084; &#1088;&#1072;&#1073;&#1086;&#1090;&#1072;&#1090;&#1100; &#1089; &#1076;&#1072;&#1085;&#1085;&#1099;&#1084;&#1080; &#1080;&#1079; &#1089;&#1086;&#1088;&#1077;&#1074;&#1085;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103;
<a href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques/overview" target="_self">House Prices: Advanced Regression Techniques</a>,
&#1074; &#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1084; &#1090;&#1088;&#1077;&#1073;&#1086;&#1074;&#1072;&#1083;&#1086;&#1089;&#1100; &#1087;&#1088;&#1077;&#1076;&#1089;&#1082;&#1072;&#1079;&#1072;&#1090;&#1100; &#1089;&#1090;&#1086;&#1080;&#1084;&#1086;&#1089;&#1090;&#1100; &#1078;&#1080;&#1083;&#1100;&#1103;. &#1044;&#1072;&#1074;&#1072;&#1081;&#1090;&#1077; &#1089;&#1085;&#1072;&#1095;&#1072;&#1083;&#1072;
&#1079;&#1072;&#1075;&#1088;&#1091;&#1079;&#1080;&#1084; &#1080; &#1085;&#1077;&#1084;&#1085;&#1086;&#1075;&#1086; &#1080;&#1079;&#1091;&#1095;&#1080;&#1084; &#1076;&#1072;&#1085;&#1085;&#1099;&#1077; (<code>train.csv</code> &#1089;&#1086; &#1089;&#1090;&#1088;&#1072;&#1085;&#1080;&#1094;&#1099; &#1089;&#1086;&#1088;&#1077;&#1074;&#1085;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103;).

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>data <span style="color: #666666">=</span> pd<span style="color: #666666">.</span>read_csv(<span style="color: #BA2121">&quot;train.csv&quot;</span>)
data<span style="color: #666666">.</span>head()
</pre></div>
<p>
&#1055;&#1077;&#1088;&#1074;&#1086;&#1077;, &#1095;&#1090;&#1086; &#1089;&#1090;&#1086;&#1080;&#1090; &#1079;&#1072;&#1084;&#1077;&#1090;&#1080;&#1090;&#1100; &#8212; &#1091; &#1085;&#1072;&#1089; &#1074; &#1076;&#1072;&#1085;&#1085;&#1099;&#1093; &#1077;&#1089;&#1090;&#1100; &#1091;&#1085;&#1080;&#1082;&#1072;&#1083;&#1100;&#1085;&#1086;&#1077; &#1076;&#1083;&#1103;
&#1082;&#1072;&#1078;&#1076;&#1086;&#1075;&#1086; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1072; &#1087;&#1086;&#1083;&#1077; <code>id</code>. &#1054;&#1073;&#1099;&#1095;&#1085;&#1086; &#1090;&#1072;&#1082;&#1080;&#1077; &#1087;&#1086;&#1083;&#1103; &#1090;&#1086;&#1083;&#1100;&#1082;&#1086; &#1084;&#1077;&#1096;&#1072;&#1102;&#1090; &#1080;
&#1089;&#1087;&#1086;&#1089;&#1086;&#1073;&#1089;&#1090;&#1074;&#1091;&#1102;&#1090; &#1087;&#1077;&#1088;&#1077;&#1086;&#1073;&#1091;&#1095;&#1077;&#1085;&#1080;&#1102;. &#1059;&#1076;&#1072;&#1083;&#1080;&#1084; &#1101;&#1090;&#1086; &#1087;&#1086;&#1083;&#1077; &#1080;&#1079; &#1076;&#1072;&#1085;&#1085;&#1099;&#1093;:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>data <span style="color: #666666">=</span> data<span style="color: #666666">.</span>drop(columns<span style="color: #666666">=</span>[<span style="color: #BA2121">&quot;Id&quot;</span>])
</pre></div>
<p>
&#1056;&#1072;&#1079;&#1076;&#1077;&#1083;&#1080;&#1084; &#1076;&#1072;&#1085;&#1085;&#1099;&#1077; &#1085;&#1072; &#1086;&#1073;&#1091;&#1095;&#1072;&#1102;&#1097;&#1091;&#1102; &#1080; &#1090;&#1077;&#1089;&#1090;&#1086;&#1074;&#1091;&#1102; &#1074;&#1099;&#1073;&#1086;&#1088;&#1082;&#1080;. &#1044;&#1083;&#1103; &#1087;&#1088;&#1086;&#1089;&#1090;&#1086;&#1090;&#1099; &#1085;&#1077; &#1073;&#1091;&#1076;&#1077;&#1084;
&#1074;&#1099;&#1076;&#1077;&#1083;&#1103;&#1090;&#1100; &#1076;&#1086;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086; &#1074;&#1072;&#1083;&#1080;&#1076;&#1072;&#1094;&#1080;&#1086;&#1085;&#1085;&#1091;&#1102; &#1074;&#1099;&#1073;&#1086;&#1088;&#1082;&#1091; (&#1093;&#1086;&#1090;&#1103; &#1101;&#1090;&#1086; &#1086;&#1073;&#1099;&#1095;&#1085;&#1086; &#1089;&#1090;&#1086;&#1080;&#1090;
&#1076;&#1077;&#1083;&#1072;&#1090;&#1100;, &#1086;&#1085;&#1072; &#1085;&#1091;&#1078;&#1085;&#1072; &#1076;&#1083;&#1103; &#1087;&#1086;&#1076;&#1073;&#1086;&#1088;&#1072; &#1075;&#1080;&#1087;&#1077;&#1088;&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1086;&#1074; &#1084;&#1086;&#1076;&#1077;&#1083;&#1080;, &#1090;&#1086; &#1077;&#1089;&#1090;&#1100;
&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1086;&#1074;, &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077; &#1085;&#1077;&#1083;&#1100;&#1079;&#1103; &#1087;&#1086;&#1076;&#1073;&#1080;&#1088;&#1072;&#1090;&#1100; &#1087;&#1086; &#1086;&#1073;&#1091;&#1095;&#1072;&#1102;&#1097;&#1077;&#1081;
&#1074;&#1099;&#1073;&#1086;&#1088;&#1082;&#1077;). &#1044;&#1086;&#1087;&#1086;&#1083;&#1085;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086; &#1085;&#1072;&#1084; &#1087;&#1088;&#1080;&#1076;&#1077;&#1090;&#1089;&#1103; &#1086;&#1090;&#1076;&#1077;&#1083;&#1080;&#1090;&#1100; &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1103; &#1094;&#1077;&#1083;&#1077;&#1074;&#1086;&#1081;
&#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1086;&#1081; &#1086;&#1090; &#1076;&#1072;&#1085;&#1085;&#1099;&#1093;.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.model_selection</span> <span style="color: #008000; font-weight: bold">import</span> train_test_split

y <span style="color: #666666">=</span> data[<span style="color: #BA2121">&quot;SalePrice&quot;</span>]
X <span style="color: #666666">=</span> data<span style="color: #666666">.</span>drop(columns<span style="color: #666666">=</span>[<span style="color: #BA2121">&quot;SalePrice&quot;</span>])

X_train, X_test, y_train, y_test <span style="color: #666666">=</span> train_test_split(X, y, test_size<span style="color: #666666">=0.3</span>, random_state<span style="color: #666666">=10</span>)
</pre></div>
<p>
&#1055;&#1086;&#1089;&#1084;&#1086;&#1090;&#1088;&#1080;&#1084; &#1089;&#1085;&#1072;&#1095;&#1072;&#1083;&#1072; &#1085;&#1072; &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1103; &#1094;&#1077;&#1083;&#1077;&#1074;&#1086;&#1081; &#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1086;&#1081;:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>sns<span style="color: #666666">.</span>distplot(y_train)
</pre></div>
<p>
&#1057;&#1091;&#1076;&#1103; &#1087;&#1086; &#1075;&#1080;&#1089;&#1090;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1077;, &#1091; &#1085;&#1072;&#1089; &#1077;&#1089;&#1090;&#1100; &#1087;&#1088;&#1080;&#1084;&#1077;&#1088;&#1099; &#1089; &#1085;&#1077;&#1090;&#1080;&#1087;&#1080;&#1095;&#1085;&#1086; &#1073;&#1086;&#1083;&#1100;&#1096;&#1086;&#1081;
&#1089;&#1090;&#1086;&#1080;&#1084;&#1086;&#1089;&#1090;&#1100;&#1102;, &#1095;&#1090;&#1086; &#1084;&#1086;&#1078;&#1077;&#1090; &#1087;&#1086;&#1084;&#1077;&#1096;&#1072;&#1090;&#1100; &#1085;&#1072;&#1084;, &#1077;&#1089;&#1083;&#1080; &#1085;&#1072;&#1096;&#1072; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1103; &#1087;&#1086;&#1090;&#1077;&#1088;&#1100; &#1089;&#1083;&#1080;&#1096;&#1082;&#1086;&#1084;
&#1095;&#1091;&#1074;&#1089;&#1090;&#1074;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1072; &#1082; &#1074;&#1099;&#1073;&#1088;&#1086;&#1089;&#1072;&#1084;. &#1042; &#1076;&#1072;&#1083;&#1100;&#1085;&#1077;&#1081;&#1096;&#1077;&#1084; &#1084;&#1099; &#1088;&#1072;&#1089;&#1089;&#1084;&#1086;&#1090;&#1088;&#1080;&#1084; &#1089;&#1087;&#1086;&#1089;&#1086;&#1073;&#1099;, &#1082;&#1072;&#1082;
&#1084;&#1080;&#1085;&#1080;&#1084;&#1080;&#1079;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100; &#1091;&#1097;&#1077;&#1088;&#1073; &#1086;&#1090; &#1101;&#1090;&#1086;&#1075;&#1086;.

<p>
&#1058;&#1072;&#1082; &#1082;&#1072;&#1082; &#1076;&#1083;&#1103; &#1088;&#1077;&#1096;&#1077;&#1085;&#1080;&#1103; &#1085;&#1072;&#1096;&#1077;&#1081; &#1079;&#1072;&#1076;&#1072;&#1095;&#1080; &#1084;&#1099; &#1073;&#1099; &#1093;&#1086;&#1090;&#1077;&#1083;&#1080; &#1086;&#1073;&#1091;&#1095;&#1080;&#1090;&#1100; &#1083;&#1080;&#1085;&#1077;&#1081;&#1085;&#1091;&#1102;
&#1088;&#1077;&#1075;&#1088;&#1077;&#1089;&#1089;&#1080;&#1102;, &#1073;&#1099;&#1083;&#1086; &#1073;&#1099; &#1093;&#1086;&#1088;&#1086;&#1096;&#1086; &#1085;&#1072;&#1081;&#1090;&#1080; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1080;, &#171;&#1085;&#1072;&#1080;&#1073;&#1086;&#1083;&#1077;&#1077; &#1083;&#1080;&#1085;&#1077;&#1081;&#1085;&#1086;&#187; &#1089;&#1074;&#1103;&#1079;&#1072;&#1085;&#1085;&#1099;&#1077;
&#1089; &#1094;&#1077;&#1083;&#1077;&#1074;&#1086;&#1081; &#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1086;&#1081;, &#1080;&#1085;&#1072;&#1095;&#1077; &#1075;&#1086;&#1074;&#1086;&#1088;&#1103;, &#1087;&#1086;&#1089;&#1084;&#1086;&#1090;&#1088;&#1077;&#1090;&#1100; &#1085;&#1072; &#1082;&#1086;&#1101;&#1092;&#1092;&#1080;&#1094;&#1080;&#1077;&#1085;&#1090;
&#1082;&#1086;&#1088;&#1088;&#1077;&#1083;&#1103;&#1094;&#1080;&#1080; &#1055;&#1080;&#1088;&#1089;&#1086;&#1085;&#1072; &#1084;&#1077;&#1078;&#1076;&#1091; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1072;&#1084;&#1080; &#1080; &#1094;&#1077;&#1083;&#1077;&#1074;&#1086;&#1081; &#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1086;&#1081;. &#1047;&#1072;&#1084;&#1077;&#1090;&#1080;&#1084;, &#1095;&#1090;&#1086;
&#1085;&#1077; &#1074;&#1089;&#1077; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1080; &#1103;&#1074;&#1083;&#1103;&#1102;&#1090;&#1089;&#1103; &#1095;&#1080;&#1089;&#1083;&#1086;&#1074;&#1099;&#1084;&#1080;, &#1087;&#1086;&#1082;&#1072; &#1095;&#1090;&#1086; &#1084;&#1099; &#1085;&#1077; &#1073;&#1091;&#1076;&#1077;&#1084; &#1088;&#1072;&#1089;&#1089;&#1084;&#1072;&#1090;&#1088;&#1080;&#1074;&#1072;&#1090;&#1100;
&#1090;&#1072;&#1082;&#1080;&#1077; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1080;.

<p>
<div class="panel panel-primary">
  <div class="panel-heading">
  <h3 class="panel-title">&#1050;&#1086;&#1101;&#1092;&#1092;&#1080;&#1094;&#1080;&#1077;&#1085;&#1090; &#1082;&#1086;&#1088;&#1088;&#1077;&#1083;&#1103;&#1094;&#1080;&#1080; &#1055;&#1080;&#1088;&#1089;&#1086;&#1085;&#1072;</h3>
  </div>
<div class="panel-body">
<p> <!-- subsequent paragraphs come in larger fonts, so start with a paragraph -->
&#1050;&#1086;&#1101;&#1092;&#1092;&#1080;&#1094;&#1080;&#1077;&#1085;&#1090; &#1082;&#1086;&#1088;&#1088;&#1077;&#1083;&#1103;&#1094;&#1080;&#1080; &#1055;&#1080;&#1088;&#1089;&#1086;&#1085;&#1072; &#1093;&#1072;&#1088;&#1072;&#1082;&#1090;&#1077;&#1088;&#1080;&#1079;&#1091;&#1077;&#1090; &#1089;&#1091;&#1097;&#1077;&#1089;&#1090;&#1074;&#1086;&#1074;&#1072;&#1085;&#1080;&#1077; &#1083;&#1080;&#1085;&#1077;&#1081;&#1085;&#1086;&#1081;
&#1079;&#1072;&#1074;&#1080;&#1089;&#1080;&#1084;&#1086;&#1089;&#1090;&#1080; &#1084;&#1077;&#1078;&#1076;&#1091; &#1076;&#1074;&#1091;&#1084;&#1103; &#1074;&#1077;&#1083;&#1080;&#1095;&#1080;&#1085;&#1072;&#1084;&#1080;.

<p>
&#1055;&#1091;&#1089;&#1090;&#1100; &#1076;&#1072;&#1085;&#1099; &#1076;&#1074;&#1077; &#1074;&#1099;&#1073;&#1086;&#1088;&#1082;&#1080; \( x = (x_1, x_2, \ldots, x_m) \) &#1080; \( y = (y_1, y_2,
\ldots, y_m \); &#1082;&#1086;&#1101;&#1092;&#1092;&#1080;&#1094;&#1080;&#1077;&#1085;&#1090; &#1082;&#1086;&#1088;&#1088;&#1077;&#1083;&#1103;&#1094;&#1080;&#1080; &#1055;&#1080;&#1088;&#1089;&#1086;&#1085;&#1072; &#1087;&#1086; &#1092;&#1086;&#1088;&#1084;&#1091;&#1083;&#1077;:
$$
r_{xy} = \frac{\sum_{i=1}^{m}(x_i-\bar{x})(y_i -
\bar{y})}{\sqrt{\sum_{i=1}^{m}(x_i - \bar{x})^2 \sum_{i=1}^{m}(y_i -
\bar{y})^2}} = \frac{cov(x, y)}{\sqrt{s_x^2s_y^2}},
$$

&#1075;&#1076;&#1077; \( \bar{x} \), \( \bar{y} \) &#8212; &#1074;&#1099;&#1073;&#1086;&#1088;&#1086;&#1095;&#1085;&#1099;&#1077; &#1089;&#1088;&#1077;&#1076;&#1085;&#1080;&#1077;, \( s_x^2 \), \( s_y^2 \) &#8212;
&#1074;&#1099;&#1073;&#1086;&#1088;&#1086;&#1095;&#1085;&#1099;&#1077; &#1076;&#1080;&#1089;&#1087;&#1077;&#1088;&#1089;&#1080;&#1080;, \( r_{xy} \in [-1, 1] \).

<ul>
<li> \( |r_{xy}| = 1 \Rightarrow \) $x$, \( y \) &#8212; &#1083;&#1080;&#1085;&#1077;&#1081;&#1085;&#1086; &#1079;&#1072;&#1074;&#1080;&#1089;&#1080;&#1084;&#1099;,</li>
<li> \( |r_{xy}| = 0 \Rightarrow \) $x$, \( y \) &#8212; &#1083;&#1080;&#1085;&#1077;&#1081;&#1085;&#1086; &#1085;&#1077; &#1079;&#1072;&#1074;&#1080;&#1089;&#1080;&#1084;&#1099;.</li>
</ul>
</div>
</div>


<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>numeric_data <span style="color: #666666">=</span> X_train<span style="color: #666666">.</span>select_dtypes([np<span style="color: #666666">.</span>number])
numeric_data_mean <span style="color: #666666">=</span> numeric_data<span style="color: #666666">.</span>mean()
numeric_features <span style="color: #666666">=</span> numeric_data<span style="color: #666666">.</span>columns

X_train <span style="color: #666666">=</span> X_train<span style="color: #666666">.</span>fillna(numeric_data_mean)
X_test <span style="color: #666666">=</span> X_test<span style="color: #666666">.</span>fillna(numeric_data_mean)

correlations <span style="color: #666666">=</span> {
    feature: np<span style="color: #666666">.</span>corrcoef(X_train[feature], y_train)[<span style="color: #666666">0</span>][<span style="color: #666666">1</span>]
    <span style="color: #008000; font-weight: bold">for</span> feature <span style="color: #AA22FF; font-weight: bold">in</span> numeric_features
}
sorted_correlations <span style="color: #666666">=</span> <span style="color: #008000">sorted</span>(correlations<span style="color: #666666">.</span>items(), key<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">lambda</span> x: x[<span style="color: #666666">1</span>], reverse<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>)
features_order <span style="color: #666666">=</span> [x[<span style="color: #666666">0</span>] <span style="color: #008000; font-weight: bold">for</span> x <span style="color: #AA22FF; font-weight: bold">in</span> sorted_correlations]
correlations <span style="color: #666666">=</span> [x[<span style="color: #666666">1</span>] <span style="color: #008000; font-weight: bold">for</span> x <span style="color: #AA22FF; font-weight: bold">in</span> sorted_correlations]

plot <span style="color: #666666">=</span> sns<span style="color: #666666">.</span>barplot(y<span style="color: #666666">=</span>features_order, x<span style="color: #666666">=</span>correlations)
plot<span style="color: #666666">.</span>figure<span style="color: #666666">.</span>set_size_inches(<span style="color: #666666">15</span>, <span style="color: #666666">10</span>)
</pre></div>
<p>
&#1055;&#1086;&#1089;&#1084;&#1086;&#1090;&#1088;&#1080;&#1084; &#1085;&#1072; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1080; &#1080;&#1079; &#1085;&#1072;&#1095;&#1072;&#1083;&#1072; &#1089;&#1087;&#1080;&#1089;&#1082;&#1072;. &#1044;&#1083;&#1103; &#1101;&#1090;&#1086;&#1075;&#1086; &#1085;&#1072;&#1088;&#1080;&#1089;&#1091;&#1077;&#1084; &#1075;&#1088;&#1072;&#1092;&#1080;&#1082;
&#1079;&#1072;&#1074;&#1080;&#1089;&#1080;&#1084;&#1086;&#1089;&#1090;&#1080; &#1094;&#1077;&#1083;&#1077;&#1074;&#1086;&#1081; &#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1086;&#1081; &#1086;&#1090; &#1082;&#1072;&#1078;&#1076;&#1086;&#1075;&#1086; &#1080;&#1079; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1086;&#1074;. &#1053;&#1072; &#1101;&#1090;&#1086;&#1084;
&#1075;&#1088;&#1072;&#1092;&#1080;&#1082;&#1077; &#1082;&#1072;&#1078;&#1076;&#1072;&#1103; &#1090;&#1086;&#1095;&#1082;&#1072; &#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1077;&#1090; &#1087;&#1072;&#1088;&#1077; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;-&#1090;&#1072;&#1088;&#1075;&#1077;&#1090; (&#1090;&#1072;&#1082;&#1080;&#1077; &#1075;&#1088;&#1072;&#1092;&#1080;&#1082;&#1080;
&#1085;&#1072;&#1079;&#1099;&#1074;&#1072;&#1102;&#1090;&#1089;&#1103; <code>scatter-plot</code>).

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>fig, axs <span style="color: #666666">=</span> plt<span style="color: #666666">.</span>subplots(figsize<span style="color: #666666">=</span>(<span style="color: #666666">16</span>, <span style="color: #666666">5</span>), ncols<span style="color: #666666">=3</span>)
<span style="color: #008000; font-weight: bold">for</span> i, feature <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">enumerate</span>([<span style="color: #BA2121">&quot;GrLivArea&quot;</span>, <span style="color: #BA2121">&quot;GarageArea&quot;</span>, <span style="color: #BA2121">&quot;TotalBsmtSF&quot;</span>]):
    axs[i]<span style="color: #666666">.</span>scatter(X_train[feature], y_train, alpha<span style="color: #666666">=0.2</span>)
    axs[i]<span style="color: #666666">.</span>set_xlabel(feature)
    axs[i]<span style="color: #666666">.</span>set_ylabel(<span style="color: #BA2121">&quot;SalePrice&quot;</span>)
plt<span style="color: #666666">.</span>tight_layout()
</pre></div>
<p>
&#1042;&#1080;&#1076;&#1080;&#1084;, &#1095;&#1090;&#1086; &#1084;&#1077;&#1078;&#1076;&#1091; &#1101;&#1090;&#1080;&#1084;&#1080; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1072;&#1084;&#1080; &#1080; &#1094;&#1077;&#1083;&#1077;&#1074;&#1086;&#1081; &#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1086;&#1081; &#1076;&#1077;&#1081;&#1089;&#1090;&#1074;&#1080;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;
&#1085;&#1072;&#1073;&#1083;&#1102;&#1076;&#1072;&#1077;&#1090;&#1089;&#1103; &#1083;&#1080;&#1085;&#1077;&#1081;&#1085;&#1072;&#1103; &#1079;&#1072;&#1074;&#1080;&#1089;&#1080;&#1084;&#1086;&#1089;&#1090;&#1100;.

<h2 id="ml:linear-regression:1st" class="anchor">&#1055;&#1077;&#1088;&#1074;&#1072;&#1103; &#1084;&#1086;&#1076;&#1077;&#1083;&#1100;</h2>

<p>
&#1042; &#1072;&#1088;&#1089;&#1077;&#1085;&#1072;&#1083;&#1077; &#1076;&#1072;&#1090;&#1072;-&#1089;&#1072;&#1077;&#1085;&#1090;&#1080;&#1089;&#1090;&#1072; &#1082;&#1088;&#1086;&#1084;&#1077; <code>pandas</code> &#1080; <code>matplotlib</code> &#1076;&#1086;&#1083;&#1078;&#1085;&#1099; &#1073;&#1099;&#1090;&#1100;
&#1073;&#1080;&#1073;&#1083;&#1080;&#1086;&#1090;&#1077;&#1082;&#1080;, &#1087;&#1086;&#1079;&#1074;&#1086;&#1083;&#1103;&#1102;&#1097;&#1080;&#1077; &#1086;&#1073;&#1091;&#1095;&#1072;&#1090;&#1100; &#1084;&#1086;&#1076;&#1077;&#1083;&#1080;. &#1044;&#1083;&#1103; &#1087;&#1088;&#1086;&#1089;&#1090;&#1099;&#1093; &#1084;&#1086;&#1076;&#1077;&#1083;&#1077;&#1081; (&#1083;&#1080;&#1085;&#1077;&#1081;&#1085;&#1099;&#1077;
&#1084;&#1086;&#1076;&#1077;&#1083;&#1080;, &#1088;&#1077;&#1096;&#1072;&#1102;&#1097;&#1077;&#1077; &#1076;&#1077;&#1088;&#1077;&#1074;&#1086;, ...) &#1086;&#1090;&#1083;&#1080;&#1095;&#1085;&#1086; &#1087;&#1086;&#1076;&#1093;&#1086;&#1076;&#1080;&#1090; <code>sklearn</code>: &#1074; &#1085;&#1077;&#1084; &#1086;&#1095;&#1077;&#1085;&#1100;
&#1087;&#1086;&#1085;&#1103;&#1090;&#1085;&#1099;&#1081; &#1080; &#1087;&#1088;&#1086;&#1089;&#1090;&#1086;&#1081; &#1080;&#1085;&#1090;&#1077;&#1088;&#1092;&#1077;&#1081;&#1089;. &#1053;&#1077;&#1089;&#1084;&#1086;&#1090;&#1088;&#1103; &#1085;&#1072; &#1090;&#1086;, &#1095;&#1090;&#1086; &#1074; <code>sklearn</code> &#1077;&#1089;&#1090;&#1100;
&#1088;&#1077;&#1072;&#1083;&#1080;&#1079;&#1072;&#1094;&#1080;&#1103; &#1073;&#1091;&#1089;&#1090;&#1080;&#1085;&#1075;&#1072; &#1080; &#1087;&#1088;&#1086;&#1089;&#1090;&#1099;&#1093; &#1085;&#1077;&#1081;&#1088;&#1086;&#1085;&#1085;&#1099;&#1093; &#1089;&#1077;&#1090;&#1077;&#1081;, &#1080;&#1084;&#1080; &#1074;&#1089;&#1077; &#1078;&#1077; &#1085;&#1077;
&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1102;&#1090;&#1089;&#1103; &#1080; &#1087;&#1088;&#1077;&#1076;&#1087;&#1086;&#1095;&#1080;&#1090;&#1072;&#1102;&#1090; &#1089;&#1087;&#1077;&#1094;&#1080;&#1072;&#1083;&#1080;&#1079;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1085;&#1099;&#1077; &#1073;&#1080;&#1073;&#1083;&#1080;&#1086;&#1090;&#1077;&#1082;&#1080;: <code>XGBoost</code>,
<code>LightGBM</code> &#1080; &#1087;&#1088;. &#1076;&#1083;&#1103; &#1075;&#1088;&#1072;&#1076;&#1080;&#1077;&#1085;&#1090;&#1085;&#1086;&#1075;&#1086; &#1073;&#1091;&#1089;&#1090;&#1080;&#1085;&#1075;&#1072; &#1085;&#1072;&#1076; &#1076;&#1077;&#1088;&#1077;&#1074;&#1100;&#1103;&#1084;&#1080;, <code>PyTorch</code>,
<code>Tensorflow</code> &#1080; &#1087;&#1088;. &#1076;&#1083;&#1103; &#1085;&#1077;&#1081;&#1088;&#1086;&#1085;&#1085;&#1099;&#1093; &#1089;&#1077;&#1090;&#1077;&#1081;. &#1058;&#1072;&#1082; &#1082;&#1072;&#1082; &#1084;&#1099; &#1073;&#1091;&#1076;&#1077;&#1084; &#1086;&#1073;&#1091;&#1095;&#1072;&#1090;&#1100;
&#1083;&#1080;&#1085;&#1077;&#1081;&#1085;&#1091;&#1102; &#1088;&#1077;&#1075;&#1088;&#1077;&#1089;&#1089;&#1080;&#1102;, &#1085;&#1072;&#1084; &#1087;&#1086;&#1076;&#1086;&#1081;&#1076;&#1077;&#1090; &#1088;&#1077;&#1072;&#1083;&#1080;&#1079;&#1072;&#1094;&#1080;&#1103; &#1080;&#1079; <code>sklearn</code>.

<p>
&#1055;&#1086;&#1087;&#1088;&#1086;&#1073;&#1091;&#1077;&#1084; &#1086;&#1073;&#1091;&#1095;&#1080;&#1090;&#1100; &#1083;&#1080;&#1085;&#1077;&#1081;&#1085;&#1091;&#1102; &#1088;&#1077;&#1075;&#1088;&#1077;&#1089;&#1089;&#1080;&#1102; &#1085;&#1072; &#1095;&#1080;&#1089;&#1083;&#1086;&#1074;&#1099;&#1093; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1072;&#1093; &#1080;&#1079; &#1085;&#1072;&#1096;&#1077;&#1075;&#1086;
&#1076;&#1072;&#1090;&#1072;&#1089;&#1077;&#1090;&#1072;. &#1042; <code>sklearn</code> &#1077;&#1089;&#1090;&#1100; &#1085;&#1077;&#1089;&#1082;&#1086;&#1083;&#1100;&#1082;&#1086; &#1082;&#1083;&#1072;&#1089;&#1089;&#1086;&#1074;, &#1088;&#1077;&#1072;&#1083;&#1080;&#1079;&#1091;&#1102;&#1097;&#1080;&#1093; &#1083;&#1080;&#1085;&#1077;&#1081;&#1085;&#1091;&#1102;
&#1088;&#1077;&#1075;&#1088;&#1077;&#1089;&#1089;&#1080;&#1102;: 

<ul>
<li> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html" target="_self"><tt>LinearRegression</tt></a> &#8212; &#171;&#1082;&#1083;&#1072;&#1089;&#1089;&#1080;&#1095;&#1077;&#1089;&#1082;&#1072;&#1103;&#187; &#1083;&#1080;&#1085;&#1077;&#1081;&#1085;&#1072;&#1103; &#1088;&#1077;&#1075;&#1088;&#1077;&#1089;&#1089;&#1080;&#1103; &#1089; &#1086;&#1087;&#1090;&#1080;&#1084;&#1080;&#1079;&#1072;&#1094;&#1080;&#1077;&#1081; MSE. &#1042;&#1077;&#1089;&#1072; &#1085;&#1072;&#1093;&#1086;&#1076;&#1103;&#1090;&#1089;&#1103; &#1082;&#1072;&#1082; &#1090;&#1086;&#1095;&#1085;&#1086;&#1077; &#1088;&#1077;&#1096;&#1077;&#1085;&#1080;&#1077;: \( w^* = (X^TX)^{-1}X^Ty \)</li>
<li> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.Ridge.html" target="_self"><tt>Ridge</tt></a> &#8212; &#1083;&#1080;&#1085;&#1077;&#1081;&#1085;&#1072;&#1103; &#1088;&#1077;&#1075;&#1088;&#1077;&#1089;&#1089;&#1080;&#1103; &#1089; &#1086;&#1087;&#1090;&#1080;&#1084;&#1080;&#1079;&#1072;&#1094;&#1080;&#1077;&#1081; MSE &#1080; \( \ell_2 \)-&#1088;&#1077;&#1075;&#1091;&#1083;&#1103;&#1088;&#1080;&#1079;&#1072;&#1094;&#1080;&#1077;&#1081;</li>
<li> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.Lasso.html" target="_self"><tt>Lasso</tt></a> &#8212; &#1083;&#1080;&#1085;&#1077;&#1081;&#1085;&#1072;&#1103; &#1088;&#1077;&#1075;&#1088;&#1077;&#1089;&#1089;&#1080;&#1103; &#1089; &#1086;&#1087;&#1090;&#1080;&#1084;&#1080;&#1079;&#1072;&#1094;&#1080;&#1077;&#1081; MSE &#1080; \( \ell_1 \)-&#1088;&#1077;&#1075;&#1091;&#1083;&#1103;&#1088;&#1080;&#1079;&#1072;&#1094;&#1080;&#1077;&#1081;</li>
</ul>

&#1059; &#1084;&#1086;&#1076;&#1077;&#1083;&#1077;&#1081; &#1080;&#1079; <code>sklearn</code> &#1077;&#1089;&#1090;&#1100; &#1084;&#1077;&#1090;&#1086;&#1076;&#1099; <code>fit</code> &#1080; <code>predict</code>. &#1055;&#1077;&#1088;&#1074;&#1099;&#1081; &#1087;&#1088;&#1080;&#1085;&#1080;&#1084;&#1072;&#1077;&#1090;
&#1085;&#1072; &#1074;&#1093;&#1086;&#1076; &#1086;&#1073;&#1091;&#1095;&#1072;&#1102;&#1097;&#1091;&#1102; &#1074;&#1099;&#1073;&#1086;&#1088;&#1082;&#1091; &#1080; &#1074;&#1077;&#1082;&#1090;&#1086;&#1088; &#1094;&#1077;&#1083;&#1077;&#1074;&#1099;&#1093; &#1087;&#1077;&#1088;&#1077;&#1084;&#1077;&#1085;&#1085;&#1099;&#1093; &#1080; &#1086;&#1073;&#1091;&#1095;&#1072;&#1077;&#1090;
&#1084;&#1086;&#1076;&#1077;&#1083;&#1100;, &#1074;&#1090;&#1086;&#1088;&#1086;&#1081;, &#1073;&#1091;&#1076;&#1091;&#1095;&#1080; &#1074;&#1099;&#1079;&#1074;&#1072;&#1085;&#1085;&#1099;&#1084; &#1087;&#1086;&#1089;&#1083;&#1077; &#1086;&#1073;&#1091;&#1095;&#1077;&#1085;&#1080;&#1103; &#1084;&#1086;&#1076;&#1077;&#1083;&#1080;, &#1074;&#1086;&#1079;&#1074;&#1088;&#1072;&#1097;&#1072;&#1077;&#1090;
&#1087;&#1088;&#1077;&#1076;&#1089;&#1082;&#1072;&#1079;&#1072;&#1085;&#1080;&#1077; &#1085;&#1072; &#1074;&#1099;&#1073;&#1086;&#1088;&#1082;&#1077;. &#1055;&#1086;&#1087;&#1088;&#1086;&#1073;&#1091;&#1077;&#1084; &#1086;&#1073;&#1091;&#1095;&#1080;&#1090;&#1100; &#1085;&#1072;&#1096;&#1091; &#1087;&#1077;&#1088;&#1074;&#1091;&#1102; &#1084;&#1086;&#1076;&#1077;&#1083;&#1100; &#1085;&#1072;
&#1095;&#1080;&#1089;&#1083;&#1086;&#1074;&#1099;&#1093; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1072;&#1093;, &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077; &#1091; &#1085;&#1072;&#1089; &#1089;&#1077;&#1081;&#1095;&#1072;&#1089; &#1077;&#1089;&#1090;&#1100;:

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.linear_model</span> <span style="color: #008000; font-weight: bold">import</span> Ridge
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.metrics</span> <span style="color: #008000; font-weight: bold">import</span> mean_squared_error

model <span style="color: #666666">=</span> Ridge()
model<span style="color: #666666">.</span>fit(X_train[numeric_features], y_train)
y_pred <span style="color: #666666">=</span> model<span style="color: #666666">.</span>predict(X_test[numeric_features])
y_train_pred <span style="color: #666666">=</span> model<span style="color: #666666">.</span>predict(X_train[numeric_features])

<span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Test MSE = </span><span style="color: #BB6688; font-weight: bold">%.4f</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> mean_squared_error(y_test, y_pred))
<span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Train MSE = </span><span style="color: #BB6688; font-weight: bold">%.4f</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> mean_squared_error(y_train, y_train_pred))
</pre></div>
<p>
&#1052;&#1099; &#1086;&#1073;&#1091;&#1095;&#1080;&#1083;&#1080; &#1087;&#1077;&#1088;&#1074;&#1091;&#1102; &#1084;&#1086;&#1076;&#1077;&#1083;&#1100; &#1080; &#1076;&#1072;&#1078;&#1077; &#1087;&#1086;&#1089;&#1095;&#1080;&#1090;&#1072;&#1083;&#1080; &#1077;&#1077; &#1082;&#1072;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086; &#1085;&#1072; &#1086;&#1090;&#1083;&#1086;&#1078;&#1077;&#1085;&#1085;&#1086;&#1081;
&#1074;&#1099;&#1073;&#1086;&#1088;&#1082;&#1077;! &#1044;&#1072;&#1074;&#1072;&#1081;&#1090;&#1077; &#1090;&#1077;&#1087;&#1077;&#1088;&#1100; &#1087;&#1086;&#1089;&#1084;&#1086;&#1090;&#1088;&#1080;&#1084; &#1085;&#1072; &#1090;&#1086;, &#1082;&#1072;&#1082; &#1084;&#1086;&#1078;&#1085;&#1086; &#1086;&#1094;&#1077;&#1085;&#1080;&#1090;&#1100; &#1082;&#1072;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086;
&#1084;&#1086;&#1076;&#1077;&#1083;&#1080; &#1089; &#1087;&#1086;&#1084;&#1086;&#1097;&#1100;&#1102; &#1082;&#1088;&#1086;&#1089;&#1089;-&#1074;&#1072;&#1083;&#1080;&#1076;&#1072;&#1094;&#1080;&#1080;. &#1055;&#1088;&#1080;&#1085;&#1094;&#1080;&#1087; &#1082;&#1088;&#1086;&#1089;&#1089;-&#1074;&#1072;&#1083;&#1080;&#1076;&#1072;&#1094;&#1080;&#1080; &#1080;&#1079;&#1086;&#1073;&#1088;&#1072;&#1078;&#1077;&#1085; &#1085;&#1072;
&#1088;&#1080;&#1089;&#1091;&#1085;&#1082;&#1077;

<p>
<img src="https://docs.splunk.com/images/thumb/e/ee/Kfold_cv_diagram.png/1200px-Kfold_cv_diagram.png" width=50%>

<p>
&#1055;&#1088;&#1080; &#1082;&#1088;&#1086;&#1089;&#1089;-&#1074;&#1072;&#1083;&#1080;&#1076;&#1072;&#1094;&#1080;&#1080; &#1084;&#1099; &#1076;&#1077;&#1083;&#1080;&#1084; &#1086;&#1073;&#1091;&#1095;&#1072;&#1102;&#1097;&#1091;&#1102; &#1074;&#1099;&#1073;&#1086;&#1088;&#1082;&#1091; &#1085;&#1072; \( n \) &#1095;&#1072;&#1089;&#1090;&#1077;&#1081;
(fold). &#1047;&#1072;&#1090;&#1077;&#1084; &#1084;&#1099; &#1086;&#1073;&#1091;&#1095;&#1072;&#1077;&#1084; \( n \) &#1084;&#1086;&#1076;&#1077;&#1083;&#1077;&#1081;: &#1082;&#1072;&#1078;&#1076;&#1072;&#1103; &#1084;&#1086;&#1076;&#1077;&#1083;&#1100; &#1086;&#1073;&#1091;&#1095;&#1072;&#1077;&#1090;&#1089;&#1103; &#1087;&#1088;&#1080;
&#1086;&#1090;&#1089;&#1091;&#1090;&#1089;&#1090;&#1074;&#1080;&#1080; &#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1077;&#1075;&#1086; &#1092;&#1086;&#1083;&#1076;&#1072;, &#1090;&#1086; &#1077;&#1089;&#1090;&#1100; \( i \)-&#1072;&#1103; &#1084;&#1086;&#1076;&#1077;&#1083;&#1100; &#1086;&#1073;&#1091;&#1095;&#1072;&#1077;&#1090;&#1089;&#1103; &#1085;&#1072;
&#1074;&#1089;&#1077;&#1081; &#1086;&#1073;&#1091;&#1095;&#1072;&#1102;&#1097;&#1077;&#1081; &#1074;&#1099;&#1073;&#1086;&#1088;&#1082;&#1077;, &#1082;&#1088;&#1086;&#1084;&#1077; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1086;&#1074;, &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077; &#1087;&#1086;&#1087;&#1072;&#1083;&#1080; &#1074; \( i \)-&#1099;&#1081; &#1092;&#1086;&#1083;&#1076;
(out-of-fold). &#1047;&#1072;&#1090;&#1077;&#1084; &#1084;&#1099; &#1080;&#1079;&#1084;&#1077;&#1088;&#1103;&#1077;&#1084; &#1082;&#1072;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086; \( i \)-&#1086;&#1081; &#1084;&#1086;&#1076;&#1077;&#1083;&#1080; &#1085;&#1072; \( i \)-&#1086;&#1084;
&#1092;&#1086;&#1083;&#1076;&#1077;. &#1058;&#1072;&#1082; &#1082;&#1072;&#1082; &#1086;&#1085; &#1085;&#1077; &#1091;&#1095;&#1072;&#1089;&#1090;&#1074;&#1086;&#1074;&#1072;&#1083; &#1074; &#1086;&#1073;&#1091;&#1095;&#1077;&#1085;&#1080;&#1080; &#1101;&#1090;&#1086;&#1081; &#1084;&#1086;&#1076;&#1077;&#1083;&#1080;, &#1084;&#1099; &#1087;&#1086;&#1083;&#1091;&#1095;&#1080;&#1084;
&#171;&#1095;&#1077;&#1089;&#1090;&#1085;&#1099;&#1081; &#1088;&#1077;&#1079;&#1091;&#1083;&#1100;&#1090;&#1072;&#1090;&#187;. &#1055;&#1086;&#1089;&#1083;&#1077; &#1101;&#1090;&#1086;&#1075;&#1086;, &#1076;&#1083;&#1103; &#1087;&#1086;&#1083;&#1091;&#1095;&#1077;&#1085;&#1080;&#1103; &#1092;&#1080;&#1085;&#1072;&#1083;&#1100;&#1085;&#1086;&#1075;&#1086; &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1103;
&#1084;&#1077;&#1090;&#1088;&#1080;&#1082;&#1080; &#1082;&#1072;&#1095;&#1077;&#1089;&#1090;&#1074;&#1072;, &#1084;&#1099; &#1084;&#1086;&#1078;&#1077;&#1084; &#1091;&#1089;&#1088;&#1077;&#1076;&#1085;&#1080;&#1090;&#1100; &#1087;&#1086;&#1083;&#1091;&#1095;&#1077;&#1085;&#1085;&#1099;&#1077; &#1085;&#1072;&#1084;&#1080; \( n \) &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1081;.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.model_selection</span> <span style="color: #008000; font-weight: bold">import</span> cross_val_score

cv_scores <span style="color: #666666">=</span> cross_val_score(model, X_train[numeric_features], y_train, cv<span style="color: #666666">=10</span>, scoring<span style="color: #666666">=</span><span style="color: #BA2121">&quot;neg_mean_squared_error&quot;</span>)
<span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Cross validation scores:</span><span style="color: #BB6622; font-weight: bold">\n\t</span><span style="color: #BA2121">&quot;</span>, <span style="color: #BA2121">&quot;</span><span style="color: #BB6622; font-weight: bold">\n\t</span><span style="color: #BA2121">&quot;</span><span style="color: #666666">.</span>join(<span style="color: #BA2121">&quot;</span><span style="color: #BB6688; font-weight: bold">%.4f</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> x <span style="color: #008000; font-weight: bold">for</span> x <span style="color: #AA22FF; font-weight: bold">in</span> cv_scores))
<span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Mean CV MSE = </span><span style="color: #BB6688; font-weight: bold">%.4f</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> np<span style="color: #666666">.</span>mean(<span style="color: #666666">-</span>cv_scores))
</pre></div>
<p>
&#1054;&#1073;&#1088;&#1072;&#1090;&#1080;&#1090;&#1077; &#1074;&#1085;&#1080;&#1084;&#1072;&#1085;&#1080;&#1077; &#1085;&#1072; &#1090;&#1086;, &#1095;&#1090;&#1086; &#1088;&#1077;&#1079;&#1091;&#1083;&#1100;&#1090;&#1072;&#1090;&#1099; <code>cv_scores</code> &#1087;&#1086;&#1083;&#1091;&#1095;&#1080;&#1083;&#1080;&#1089;&#1100;
&#1086;&#1090;&#1088;&#1080;&#1094;&#1072;&#1090;&#1077;&#1083;&#1100;&#1085;&#1099;&#1084;&#1080;. &#1069;&#1090;&#1086; &#1089;&#1086;&#1075;&#1083;&#1072;&#1096;&#1077;&#1085;&#1080;&#1077; &#1074; <code>sklearn</code> (&#1089;&#1082;&#1086;&#1088;&#1080;&#1085;&#1075;&#1086;&#1074;&#1091;&#1102; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1102; &#1085;&#1091;&#1078;&#1085;&#1086;
&#1084;&#1072;&#1082;&#1089;&#1080;&#1084;&#1080;&#1079;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100;). &#1055;&#1086;&#1101;&#1090;&#1086;&#1084;&#1091; &#1074;&#1089;&#1077; &#1089;&#1090;&#1072;&#1085;&#1076;&#1072;&#1088;&#1090;&#1085;&#1099;&#1077; &#1089;&#1082;&#1086;&#1088;&#1077;&#1088;&#1099; &#1085;&#1072;&#1079;&#1099;&#1074;&#1072;&#1102;&#1090;&#1089;&#1103; <code>neg_*</code>,
&#1085;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;, <code>neg_mean_squared_error</code>.

<p>
&#1042; &#1082;&#1072;&#1095;&#1077;&#1089;&#1090;&#1074;&#1077; &#1084;&#1077;&#1090;&#1088;&#1080;&#1082;&#1080; &#1082;&#1072;&#1095;&#1077;&#1089;&#1090;&#1074;&#1072; &#1074; &#1089;&#1086;&#1088;&#1077;&#1074;&#1085;&#1086;&#1074;&#1072;&#1085;&#1080;&#1080; &#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1083;&#1086;&#1089;&#1100; RMSE (
Root Mean Squared Error), &#1072; &#1085;&#1077; MSE, &#1082;&#1086;&#1090;&#1086;&#1088;&#1086;&#1077; &#1084;&#1099; &#1089;&#1095;&#1080;&#1090;&#1072;&#1083;&#1080; &#1074;&#1099;&#1096;&#1077; (&#1080; &#1087;&#1086;
&#1086;&#1090;&#1083;&#1086;&#1078;&#1077;&#1085;&#1085;&#1086;&#1081; &#1074;&#1099;&#1073;&#1086;&#1088;&#1082;&#1077; &#1080; &#1087;&#1088;&#1080; &#1082;&#1088;&#1086;&#1089;&#1089;-&#1074;&#1072;&#1083;&#1080;&#1076;&#1072;&#1094;&#1080;&#1080;):
$$
\text{RMSE}(X, y, a) = \sqrt{\frac{1}{\ell}\sum_{i=1}^{\ell} (y_i -
a(x_i))^2}
$$

<p>
RMSE &#1074; &#1095;&#1080;&#1089;&#1090;&#1086;&#1084; &#1074;&#1080;&#1076;&#1077; &#1085;&#1077; &#1074;&#1093;&#1086;&#1076;&#1080;&#1090; &#1074; &#1089;&#1090;&#1072;&#1085;&#1076;&#1072;&#1088;&#1090;&#1085;&#1099;&#1077; &#1084;&#1077;&#1090;&#1088;&#1080;&#1082;&#1080; <code>sklearn</code>, &#1085;&#1086; &#1084;&#1099;
&#1074;&#1089;&#1077;&#1075;&#1076;&#1072; &#1084;&#1086;&#1078;&#1077;&#1084; &#1086;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1080;&#1090;&#1100; &#1089;&#1074;&#1086;&#1102; &#1084;&#1077;&#1090;&#1088;&#1080;&#1082;&#1091; &#1080; &#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100; &#1077;&#1077; &#1074; &#1085;&#1077;&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1093;
&#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1103;&#1093; <code>sklearn</code>, &#1085;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;, <code>cross_val_score</code>. &#1044;&#1083;&#1103; &#1101;&#1090;&#1086;&#1075;&#1086; &#1085;&#1091;&#1078;&#1085;&#1086;
&#1074;&#1086;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;&#1089;&#1103; <code>sklearn.metrics.make_scorer</code>.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.metrics</span> <span style="color: #008000; font-weight: bold">import</span> make_scorer

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">rmse</span>(y_true, y_pred):
    error <span style="color: #666666">=</span> (y_true <span style="color: #666666">-</span> y_pred) <span style="color: #666666">**</span> <span style="color: #666666">2</span>
    <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>sqrt(np<span style="color: #666666">.</span>mean(error))

rmse_scorer <span style="color: #666666">=</span> make_scorer(
    rmse,
    greater_is_better<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">False</span>
)
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.linear_model</span> <span style="color: #008000; font-weight: bold">import</span> Ridge

model <span style="color: #666666">=</span> Ridge()
model<span style="color: #666666">.</span>fit(X_train[numeric_features], y_train)
y_pred <span style="color: #666666">=</span> model<span style="color: #666666">.</span>predict(X_test[numeric_features])
y_train_pred <span style="color: #666666">=</span> model<span style="color: #666666">.</span>predict(X_train[numeric_features])

<span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Test RMSE = </span><span style="color: #BB6688; font-weight: bold">%.4f</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> rmse(y_test, y_pred))
<span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Train RMSE = </span><span style="color: #BB6688; font-weight: bold">%.4f</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> rmse(y_train, y_train_pred))
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.model_selection</span> <span style="color: #008000; font-weight: bold">import</span> cross_val_score

cv_scores <span style="color: #666666">=</span> cross_val_score(model, X_train[numeric_features], y_train, cv<span style="color: #666666">=10</span>, scoring<span style="color: #666666">=</span>rmse_scorer)
<span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Cross validation scores:</span><span style="color: #BB6622; font-weight: bold">\n\t</span><span style="color: #BA2121">&quot;</span>, <span style="color: #BA2121">&quot;</span><span style="color: #BB6622; font-weight: bold">\n\t</span><span style="color: #BA2121">&quot;</span><span style="color: #666666">.</span>join(<span style="color: #BA2121">&quot;</span><span style="color: #BB6688; font-weight: bold">%.4f</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> x <span style="color: #008000; font-weight: bold">for</span> x <span style="color: #AA22FF; font-weight: bold">in</span> cv_scores))
<span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Mean CV RMSE = </span><span style="color: #BB6688; font-weight: bold">%.4f</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> np<span style="color: #666666">.</span>mean(<span style="color: #666666">-</span>cv_scores))
</pre></div>
<p>
&#1044;&#1083;&#1103; &#1090;&#1086;&#1075;&#1086;, &#1095;&#1090;&#1086;&#1073;&#1099; &#1080;&#1084;&#1077;&#1090;&#1100; &#1085;&#1077;&#1082;&#1086;&#1090;&#1086;&#1088;&#1091;&#1102; &#1090;&#1086;&#1095;&#1082;&#1091; &#1086;&#1090;&#1089;&#1095;&#1077;&#1090;&#1072;, &#1091;&#1076;&#1086;&#1073;&#1085;&#1086; &#1087;&#1086;&#1089;&#1095;&#1080;&#1090;&#1072;&#1090;&#1100;
&#1086;&#1087;&#1090;&#1080;&#1084;&#1072;&#1083;&#1100;&#1085;&#1086;&#1077; &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077; &#1092;&#1091;&#1085;&#1082;&#1094;&#1080;&#1080; &#1087;&#1086;&#1090;&#1077;&#1088;&#1100; &#1087;&#1088;&#1080; &#1082;&#1086;&#1085;&#1089;&#1090;&#1072;&#1085;&#1090;&#1085;&#1086;&#1084; &#1087;&#1088;&#1077;&#1076;&#1089;&#1082;&#1072;&#1079;&#1072;&#1085;&#1080;&#1080;.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>best_constant <span style="color: #666666">=</span> y_train<span style="color: #666666">.</span>mean()
<span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Test RMSE with best constant = </span><span style="color: #BB6688; font-weight: bold">%.4f</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> rmse(y_test, best_constant))
<span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Train RMSE with best constant = </span><span style="color: #BB6688; font-weight: bold">%.4f</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> rmse(y_train, best_constant))
</pre></div>
<p>
&#1044;&#1072;&#1074;&#1072;&#1081;&#1090;&#1077; &#1087;&#1086;&#1089;&#1084;&#1086;&#1090;&#1088;&#1080;&#1084; &#1085;&#1072; &#1090;&#1086;, &#1082;&#1072;&#1082;&#1080;&#1077; &#1078;&#1077; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1080; &#1086;&#1082;&#1072;&#1079;&#1072;&#1083;&#1080;&#1089;&#1100; &#1089;&#1072;&#1084;&#1099;&#1084;&#1080;
&#171;&#1089;&#1080;&#1083;&#1100;&#1085;&#1099;&#1084;&#1080;&#187;. &#1044;&#1083;&#1103; &#1101;&#1090;&#1086;&#1075;&#1086; &#1074;&#1080;&#1079;&#1091;&#1072;&#1083;&#1080;&#1079;&#1080;&#1088;&#1091;&#1077;&#1084; &#1074;&#1077;&#1089;&#1072;, &#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1080;&#1077;
&#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1072;&#1084;. &#1063;&#1077;&#1084; &#1073;&#1086;&#1083;&#1100;&#1096;&#1077; &#1074;&#1077;&#1089; &#8212; &#1090;&#1077;&#1084; &#1073;&#1086;&#1083;&#1077;&#1077; &#1089;&#1080;&#1083;&#1100;&#1085;&#1099;&#1084; &#1103;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">show_weights</span>(features, weights, scales):
    fig, axs <span style="color: #666666">=</span> plt<span style="color: #666666">.</span>subplots(figsize<span style="color: #666666">=</span>(<span style="color: #666666">14</span>, <span style="color: #666666">10</span>), ncols<span style="color: #666666">=2</span>)
    sorted_weights <span style="color: #666666">=</span> <span style="color: #008000">sorted</span>(<span style="color: #008000">zip</span>(weights, features, scales), reverse<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>)
    weights <span style="color: #666666">=</span> [x[<span style="color: #666666">0</span>] <span style="color: #008000; font-weight: bold">for</span> x <span style="color: #AA22FF; font-weight: bold">in</span> sorted_weights]
    features <span style="color: #666666">=</span> [x[<span style="color: #666666">1</span>] <span style="color: #008000; font-weight: bold">for</span> x <span style="color: #AA22FF; font-weight: bold">in</span> sorted_weights]
    scales <span style="color: #666666">=</span> [x[<span style="color: #666666">2</span>] <span style="color: #008000; font-weight: bold">for</span> x <span style="color: #AA22FF; font-weight: bold">in</span> sorted_weights]
    sns<span style="color: #666666">.</span>barplot(y<span style="color: #666666">=</span>features, x<span style="color: #666666">=</span>weights, ax<span style="color: #666666">=</span>axs[<span style="color: #666666">0</span>])
    axs[<span style="color: #666666">0</span>]<span style="color: #666666">.</span>set_xlabel(<span style="color: #BA2121">&quot;Weight&quot;</span>)
    sns<span style="color: #666666">.</span>barplot(y<span style="color: #666666">=</span>features, x<span style="color: #666666">=</span>scales, ax<span style="color: #666666">=</span>axs[<span style="color: #666666">1</span>])
    axs[<span style="color: #666666">1</span>]<span style="color: #666666">.</span>set_xlabel(<span style="color: #BA2121">&quot;Scale&quot;</span>)
    plt<span style="color: #666666">.</span>tight_layout()
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>show_weights(numeric_features, model<span style="color: #666666">.</span>coef_, X_train[numeric_features]<span style="color: #666666">.</span>std())
</pre></div>
<p>
&#1041;&#1091;&#1076;&#1077;&#1084; &#1084;&#1072;&#1089;&#1096;&#1090;&#1072;&#1073;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100; &#1085;&#1072;&#1096;&#1080; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1080; &#1087;&#1077;&#1088;&#1077;&#1076; &#1086;&#1073;&#1091;&#1095;&#1077;&#1085;&#1080;&#1077;&#1084; &#1084;&#1086;&#1076;&#1077;&#1083;&#1080;. &#1069;&#1090;&#1086;, &#1089;&#1088;&#1077;&#1076;&#1080;,
&#1087;&#1088;&#1086;&#1095;&#1077;&#1075;&#1086;, &#1089;&#1076;&#1077;&#1083;&#1072;&#1077;&#1090; &#1085;&#1072;&#1096;&#1091; &#1088;&#1077;&#1075;&#1091;&#1083;&#1103;&#1088;&#1080;&#1079;&#1072;&#1094;&#1080;&#1102; &#1073;&#1086;&#1083;&#1077;&#1077; &#1095;&#1077;&#1089;&#1090;&#1085;&#1086;&#1081;: &#1090;&#1077;&#1087;&#1077;&#1088;&#1100; &#1074;&#1089;&#1077; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1080;
&#1073;&#1091;&#1076;&#1091;&#1090; &#1088;&#1077;&#1075;&#1091;&#1083;&#1103;&#1088;&#1080;&#1079;&#1086;&#1074;&#1072;&#1090;&#1100;&#1089;&#1103; &#1074; &#1088;&#1072;&#1074;&#1085;&#1086;&#1081; &#1089;&#1090;&#1077;&#1087;&#1077;&#1085;&#1080;.

<p>
&#1044;&#1083;&#1103; &#1101;&#1090;&#1086;&#1075;&#1086; &#1074;&#1086;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1077;&#1084;&#1089;&#1103; &#1090;&#1088;&#1072;&#1085;&#1089;&#1092;&#1086;&#1088;&#1084;&#1077;&#1088;&#1086;&#1084;
<a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html" target="_self"><tt>StandardScaler</tt></a>.
&#1058;&#1088;&#1072;&#1085;&#1089;&#1092;&#1086;&#1088;&#1084;&#1077;&#1088;&#1099; &#1074; <code>sklearn</code> &#1080;&#1084;&#1077;&#1102;&#1090; &#1084;&#1077;&#1090;&#1086;&#1076;&#1099; <code>fit</code> &#1080; <code>transform</code> (&#1072; &#1077;&#1097;&#1077;
<code>fit_transform</code>). &#1052;&#1077;&#1090;&#1086;&#1076; <code>fit</code> &#1087;&#1088;&#1080;&#1085;&#1080;&#1084;&#1072;&#1077;&#1090; &#1085;&#1072; &#1074;&#1093;&#1086;&#1076; &#1086;&#1073;&#1091;&#1095;&#1072;&#1102;&#1097;&#1091;&#1102; &#1074;&#1099;&#1073;&#1086;&#1088;&#1082;&#1091; &#1080;
&#1089;&#1095;&#1080;&#1090;&#1072;&#1077;&#1090; &#1087;&#1086; &#1085;&#1077;&#1081; &#1085;&#1077;&#1086;&#1073;&#1093;&#1086;&#1076;&#1080;&#1084;&#1099;&#1077; &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1103; (&#1085;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088; &#1089;&#1090;&#1072;&#1090;&#1080;&#1089;&#1090;&#1080;&#1082;&#1080;, &#1082;&#1072;&#1082;
<code>StandardScaler</code>: &#1089;&#1088;&#1077;&#1076;&#1085;&#1077;&#1077; &#1080; &#1089;&#1090;&#1072;&#1085;&#1076;&#1072;&#1088;&#1090;&#1085;&#1086;&#1077; &#1086;&#1090;&#1082;&#1083;&#1086;&#1085;&#1077;&#1085;&#1080;&#1077; &#1082;&#1072;&#1078;&#1076;&#1086;&#1075;&#1086; &#1080;&#1079;
&#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1086;&#1074;); <code>transform</code> &#1087;&#1088;&#1080;&#1084;&#1077;&#1085;&#1103;&#1077;&#1090; &#1087;&#1088;&#1077;&#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1074;&#1072;&#1085;&#1080;&#1077; &#1082; &#1087;&#1077;&#1088;&#1077;&#1076;&#1072;&#1085;&#1085;&#1086;&#1081;
&#1074;&#1099;&#1073;&#1086;&#1088;&#1082;&#1077;.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.preprocessing</span> <span style="color: #008000; font-weight: bold">import</span> StandardScaler

scaler <span style="color: #666666">=</span> StandardScaler()
X_train_scaled <span style="color: #666666">=</span> scaler<span style="color: #666666">.</span>fit_transform(X_train[numeric_features])
X_test_scaled <span style="color: #666666">=</span> scaler<span style="color: #666666">.</span>transform(X_test[numeric_features])

model <span style="color: #666666">=</span> Ridge()
model<span style="color: #666666">.</span>fit(X_train_scaled, y_train)
y_pred <span style="color: #666666">=</span> model<span style="color: #666666">.</span>predict(X_test_scaled)
y_train_pred <span style="color: #666666">=</span> model<span style="color: #666666">.</span>predict(X_train_scaled)

<span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Test RMSE = </span><span style="color: #BB6688; font-weight: bold">%.4f</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> rmse(y_test, y_pred))
<span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Train RMSE = </span><span style="color: #BB6688; font-weight: bold">%.4f</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> rmse(y_train, y_train_pred))
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>scales <span style="color: #666666">=</span> pd<span style="color: #666666">.</span>Series(data<span style="color: #666666">=</span>X_train_scaled<span style="color: #666666">.</span>std(axis<span style="color: #666666">=0</span>), index<span style="color: #666666">=</span>numeric_features)
show_weights(numeric_features, model<span style="color: #666666">.</span>coef_, scales)
</pre></div>
<p>
&#1053;&#1072;&#1088;&#1103;&#1076;&#1091; &#1089; &#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1072;&#1084;&#1080; (&#1074;&#1077;&#1089;&#1072; \( w \), \( w_0 \)), &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1077; &#1084;&#1086;&#1076;&#1077;&#1083;&#1100; &#1086;&#1087;&#1090;&#1080;&#1084;&#1080;&#1079;&#1080;&#1088;&#1091;&#1077;&#1090; &#1085;&#1072;
&#1101;&#1090;&#1072;&#1087;&#1077; &#1086;&#1073;&#1091;&#1095;&#1077;&#1085;&#1080;&#1103;, &#1091; &#1084;&#1086;&#1076;&#1077;&#1083;&#1080; &#1077;&#1089;&#1090;&#1100; &#1080; &#1075;&#1080;&#1087;&#1077;&#1088;&#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1099;. &#1059; &#1085;&#1072;&#1096;&#1077;&#1081; &#1084;&#1086;&#1076;&#1077;&#1083;&#1080; &#1101;&#1090;&#1086;
<code>alpha</code> &#8212; &#1082;&#1086;&#1101;&#1092;&#1092;&#1080;&#1094;&#1080;&#1077;&#1085;&#1090; &#1088;&#1077;&#1075;&#1091;&#1083;&#1103;&#1088;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;. &#1055;&#1086;&#1076;&#1073;&#1080;&#1088;&#1072;&#1102;&#1090; &#1077;&#1075;&#1086; &#1086;&#1073;&#1099;&#1095;&#1085;&#1086; &#1087;&#1086;
&#1089;&#1077;&#1090;&#1082;&#1077;, &#1080;&#1079;&#1084;&#1077;&#1088;&#1103;&#1103; &#1082;&#1072;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086; &#1085;&#1072; &#1074;&#1072;&#1083;&#1080;&#1076;&#1072;&#1094;&#1080;&#1086;&#1085;&#1085;&#1086;&#1081; (&#1085;&#1077; &#1090;&#1077;&#1089;&#1090;&#1086;&#1074;&#1086;&#1081;) &#1074;&#1099;&#1073;&#1086;&#1088;&#1082;&#1077; &#1080;&#1083;&#1080; &#1089;
&#1087;&#1086;&#1084;&#1086;&#1097;&#1100;&#1102; &#1082;&#1088;&#1086;&#1089;&#1089;-&#1074;&#1072;&#1083;&#1080;&#1076;&#1072;&#1094;&#1080;&#1080;. &#1055;&#1086;&#1089;&#1084;&#1086;&#1090;&#1088;&#1080;&#1084;, &#1082;&#1072;&#1082; &#1101;&#1090;&#1086; &#1084;&#1086;&#1078;&#1085;&#1086; &#1089;&#1076;&#1077;&#1083;&#1072;&#1090;&#1100; (&#1079;&#1072;&#1084;&#1077;&#1090;&#1100;&#1090;&#1077;,
&#1095;&#1090;&#1086; &#1084;&#1099; &#1087;&#1077;&#1088;&#1077;&#1073;&#1080;&#1088;&#1072;&#1077;&#1084; <code>alpha</code> &#1087;&#1086; &#1083;&#1086;&#1075;&#1072;&#1088;&#1080;&#1092;&#1084;&#1080;&#1095;&#1077;&#1089;&#1082;&#1086;&#1081; &#1089;&#1077;&#1090;&#1082;&#1077;, &#1095;&#1090;&#1086;&#1073;&#1099; &#1091;&#1079;&#1085;&#1072;&#1090;&#1100;
&#1086;&#1087;&#1090;&#1080;&#1084;&#1072;&#1083;&#1100;&#1085;&#1099;&#1081; &#1087;&#1086;&#1088;&#1103;&#1076;&#1086;&#1082; &#1074;&#1077;&#1083;&#1080;&#1095;&#1080;&#1085;&#1099;).

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.model_selection</span> <span style="color: #008000; font-weight: bold">import</span> GridSearchCV

alphas <span style="color: #666666">=</span> np<span style="color: #666666">.</span>logspace(<span style="color: #666666">-2</span>, <span style="color: #666666">3</span>, <span style="color: #666666">20</span>)
searcher <span style="color: #666666">=</span> GridSearchCV(Ridge(), [{<span style="color: #BA2121">&quot;alpha&quot;</span>: alphas}], scoring<span style="color: #666666">=</span>rmse_scorer, cv<span style="color: #666666">=10</span>)
searcher<span style="color: #666666">.</span>fit(X_train_scaled, y_train)

best_alpha <span style="color: #666666">=</span> searcher<span style="color: #666666">.</span>best_params_[<span style="color: #BA2121">&quot;alpha&quot;</span>]
<span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Best alpha = </span><span style="color: #BB6688; font-weight: bold">%.4f</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> best_alpha)

plt<span style="color: #666666">.</span>plot(alphas, <span style="color: #666666">-</span>searcher<span style="color: #666666">.</span>cv_results_[<span style="color: #BA2121">&quot;mean_test_score&quot;</span>])
plt<span style="color: #666666">.</span>xscale(<span style="color: #BA2121">&quot;log&quot;</span>)
plt<span style="color: #666666">.</span>xlabel(<span style="color: #BA2121">&quot;alpha&quot;</span>)
plt<span style="color: #666666">.</span>ylabel(<span style="color: #BA2121">&quot;CV score&quot;</span>)
</pre></div>
<p>
&#1055;&#1086;&#1087;&#1088;&#1086;&#1073;&#1091;&#1077;&#1084; &#1086;&#1073;&#1091;&#1095;&#1080;&#1090;&#1100; &#1084;&#1086;&#1076;&#1077;&#1083;&#1100; &#1089; &#1087;&#1086;&#1076;&#1086;&#1073;&#1088;&#1072;&#1085;&#1085;&#1099;&#1084; &#1082;&#1086;&#1101;&#1092;&#1092;&#1080;&#1094;&#1080;&#1077;&#1085;&#1090;&#1086;&#1084;
&#1088;&#1077;&#1075;&#1091;&#1083;&#1103;&#1088;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;. &#1047;&#1072;&#1086;&#1076;&#1085;&#1086; &#1074;&#1086;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1077;&#1084;&#1089;&#1103; &#1086;&#1095;&#1077;&#1085;&#1100; &#1091;&#1076;&#1086;&#1073;&#1085;&#1099;&#1084; &#1082;&#1083;&#1072;&#1089;&#1089;&#1086;&#1084;
<a href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html" target="_self"><tt>Pipeline</tt></a>:
&#1086;&#1073;&#1091;&#1095;&#1077;&#1085;&#1080;&#1077; &#1084;&#1086;&#1076;&#1077;&#1083;&#1080; &#1095;&#1072;&#1089;&#1090;&#1086; &#1087;&#1088;&#1077;&#1076;&#1089;&#1090;&#1072;&#1074;&#1083;&#1103;&#1077;&#1090;&#1089;&#1103; &#1082;&#1072;&#1082; &#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;&#1089;&#1090;&#1100; &#1085;&#1077;&#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1093;
&#1076;&#1077;&#1081;&#1089;&#1090;&#1074;&#1080;&#1081; &#1089; &#1086;&#1073;&#1091;&#1095;&#1072;&#1102;&#1097;&#1077;&#1081; &#1080; &#1090;&#1077;&#1089;&#1090;&#1086;&#1074;&#1086;&#1081; &#1074;&#1099;&#1073;&#1086;&#1088;&#1082;&#1072;&#1084;&#1080; (&#1085;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;, &#1089;&#1085;&#1072;&#1095;&#1072;&#1083;&#1072; &#1085;&#1091;&#1078;&#1085;&#1086;
&#1086;&#1090;&#1084;&#1072;&#1089;&#1096;&#1090;&#1072;&#1073;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100; &#1074;&#1099;&#1073;&#1086;&#1088;&#1082;&#1091; (&#1087;&#1088;&#1080;&#1095;&#1077;&#1084; &#1076;&#1083;&#1103; &#1086;&#1073;&#1091;&#1095;&#1072;&#1102;&#1097;&#1077;&#1081; &#1074;&#1099;&#1073;&#1086;&#1088;&#1082;&#1080; &#1085;&#1091;&#1078;&#1085;&#1086; &#1087;&#1088;&#1080;&#1084;&#1077;&#1085;&#1080;&#1090;&#1100;
&#1084;&#1077;&#1090;&#1086;&#1076; <code>fit</code>, &#1072; &#1076;&#1083;&#1103; &#1090;&#1077;&#1089;&#1090;&#1086;&#1074;&#1086;&#1081; --- <code>transform</code>), &#1072; &#1079;&#1072;&#1090;&#1077;&#1084;
&#1086;&#1073;&#1091;&#1095;&#1080;&#1090;&#1100;/&#1087;&#1088;&#1080;&#1084;&#1077;&#1085;&#1080;&#1090;&#1100; &#1084;&#1086;&#1076;&#1077;&#1083;&#1100; (&#1076;&#1083;&#1103; &#1086;&#1073;&#1091;&#1095;&#1072;&#1102;&#1097;&#1077;&#1081; <code>fit</code>, &#1072; &#1076;&#1083;&#1103; &#1090;&#1077;&#1089;&#1090;&#1086;&#1074;&#1086;&#1081; ---
<code>predict</code>). <code>Pipeline</code> &#1087;&#1086;&#1079;&#1074;&#1086;&#1083;&#1103;&#1077;&#1090; &#1093;&#1088;&#1072;&#1085;&#1080;&#1090;&#1100; &#1101;&#1090;&#1091; &#1087;&#1086;&#1089;&#1083;&#1077;&#1076;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1100;&#1085;&#1086;&#1089;&#1090;&#1100; &#1096;&#1072;&#1075;&#1086;&#1074;
&#1080; &#1082;&#1086;&#1088;&#1088;&#1077;&#1082;&#1090;&#1085;&#1086; &#1086;&#1073;&#1088;&#1072;&#1073;&#1072;&#1090;&#1099;&#1074;&#1072;&#1077;&#1090; &#1088;&#1072;&#1079;&#1085;&#1099;&#1077; &#1090;&#1080;&#1087;&#1099; &#1074;&#1099;&#1073;&#1086;&#1088;&#1086;&#1082;: &#1080; &#1086;&#1073;&#1091;&#1095;&#1072;&#1102;&#1097;&#1091;&#1102;, &#1080;
&#1090;&#1077;&#1089;&#1090;&#1086;&#1074;&#1091;&#1102;.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.pipeline</span> <span style="color: #008000; font-weight: bold">import</span> Pipeline

simple_pipeline <span style="color: #666666">=</span> Pipeline([
    (<span style="color: #BA2121">&#39;scaling&#39;</span>, StandardScaler()),
    (<span style="color: #BA2121">&#39;regression&#39;</span>, Ridge(best_alpha))
])

model <span style="color: #666666">=</span> simple_pipeline<span style="color: #666666">.</span>fit(X_train[numeric_features], y_train)
y_pred <span style="color: #666666">=</span> model<span style="color: #666666">.</span>predict(X_test[numeric_features])
<span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Test RMSE = </span><span style="color: #BB6688; font-weight: bold">%.4f</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> rmse(y_test, y_pred))
</pre></div>

<h2 id="ml:linear-regression:categ" class="anchor">&#1056;&#1072;&#1073;&#1086;&#1090;&#1072; &#1089; &#1082;&#1072;&#1090;&#1077;&#1075;&#1086;&#1088;&#1080;&#1072;&#1083;&#1100;&#1085;&#1099;&#1084;&#1080; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1072;&#1084;&#1080;</h2>

<p>
&#1057;&#1077;&#1081;&#1095;&#1072;&#1089; &#1084;&#1099; &#1103;&#1074;&#1085;&#1086; &#1074;&#1099;&#1090;&#1103;&#1075;&#1080;&#1074;&#1072;&#1077;&#1084; &#1080;&#1079; &#1076;&#1072;&#1085;&#1085;&#1099;&#1093; &#1085;&#1077; &#1074;&#1089;&#1102; &#1080;&#1085;&#1092;&#1086;&#1088;&#1084;&#1072;&#1094;&#1080;&#1102;, &#1095;&#1090;&#1086; &#1091; &#1085;&#1072;&#1089; &#1077;&#1089;&#1090;&#1100;,
&#1087;&#1088;&#1086;&#1089;&#1090;&#1086; &#1087;&#1086;&#1090;&#1086;&#1084;&#1091;, &#1095;&#1090;&#1086; &#1084;&#1099; &#1085;&#1077; &#1080;&#1089;&#1087;&#1086;&#1083;&#1100;&#1079;&#1091;&#1077;&#1084; &#1095;&#1072;&#1089;&#1090;&#1100; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1086;&#1074;. &#1069;&#1090;&#1080; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1080; &#1074;
&#1076;&#1072;&#1090;&#1072;&#1089;&#1077;&#1090;&#1077; &#1079;&#1072;&#1082;&#1086;&#1076;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1099; &#1089;&#1090;&#1088;&#1086;&#1082;&#1072;&#1084;&#1080;, &#1082;&#1072;&#1078;&#1076;&#1099;&#1081; &#1080;&#1079; &#1085;&#1080;&#1093; &#1086;&#1073;&#1086;&#1079;&#1085;&#1072;&#1095;&#1072;&#1077;&#1090; &#1085;&#1077;&#1082;&#1086;&#1090;&#1086;&#1088;&#1091;&#1102;
&#1082;&#1072;&#1090;&#1077;&#1075;&#1086;&#1088;&#1080;&#1102;. &#1058;&#1072;&#1082;&#1080;&#1077; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1080; &#1085;&#1072;&#1079;&#1099;&#1074;&#1072;&#1102;&#1090;&#1089;&#1103; &#1082;&#1072;&#1090;&#1077;&#1075;&#1086;&#1088;&#1080;&#1072;&#1083;&#1100;&#1085;&#1099;&#1084;&#1080;. &#1044;&#1072;&#1074;&#1072;&#1081;&#1090;&#1077; &#1074;&#1099;&#1076;&#1077;&#1083;&#1080;&#1084;
&#1090;&#1072;&#1082;&#1080;&#1077; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1080; &#1080; &#1089;&#1088;&#1072;&#1079;&#1091; &#1079;&#1072;&#1087;&#1086;&#1083;&#1085;&#1080;&#1084; &#1087;&#1088;&#1086;&#1087;&#1091;&#1089;&#1082;&#1080; &#1074; &#1085;&#1080;&#1093; &#1089;&#1087;&#1077;&#1094;&#1080;&#1072;&#1083;&#1100;&#1085;&#1099;&#1084; &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;&#1084;
(&#1090;&#1086;, &#1095;&#1090;&#1086; &#1091; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1072; &#1087;&#1088;&#1086;&#1087;&#1091;&#1097;&#1077;&#1085;&#1086; &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1077;, &#1089;&#1072;&#1084;&#1086; &#1087;&#1086; &#1089;&#1077;&#1073;&#1077; &#1084;&#1086;&#1078;&#1077;&#1090; &#1073;&#1099;&#1090;&#1100;
&#1093;&#1086;&#1088;&#1086;&#1096;&#1080;&#1084; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1086;&#1084;).

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>categorical <span style="color: #666666">=</span> <span style="color: #008000">list</span>(X_train<span style="color: #666666">.</span>dtypes[X_train<span style="color: #666666">.</span>dtypes <span style="color: #666666">==</span> <span style="color: #BA2121">&quot;object&quot;</span>]<span style="color: #666666">.</span>index)
X_train[categorical] <span style="color: #666666">=</span> X_train[categorical]<span style="color: #666666">.</span>fillna(<span style="color: #BA2121">&quot;NotGiven&quot;</span>)
X_test[categorical] <span style="color: #666666">=</span> X_test[categorical]<span style="color: #666666">.</span>fillna(<span style="color: #BA2121">&quot;NotGiven&quot;</span>)
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>X_train[categorical]<span style="color: #666666">.</span>sample(<span style="color: #666666">5</span>)
</pre></div>
<p>
&#1057;&#1077;&#1081;&#1095;&#1072;&#1089; &#1085;&#1072;&#1084; &#1085;&#1091;&#1078;&#1085;&#1086; &#1082;&#1072;&#1082;-&#1090;&#1086; &#1079;&#1072;&#1082;&#1086;&#1076;&#1080;&#1088;&#1086;&#1074;&#1072;&#1090;&#1100; &#1101;&#1090;&#1080; &#1082;&#1072;&#1090;&#1077;&#1075;&#1086;&#1088;&#1080;&#1072;&#1083;&#1100;&#1085;&#1099;&#1077; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1080;
&#1095;&#1080;&#1089;&#1083;&#1072;&#1084;&#1080;, &#1074;&#1077;&#1076;&#1100; &#1083;&#1080;&#1085;&#1077;&#1081;&#1085;&#1072;&#1103; &#1084;&#1086;&#1076;&#1077;&#1083;&#1100; &#1085;&#1077; &#1084;&#1086;&#1078;&#1077;&#1090; &#1088;&#1072;&#1073;&#1086;&#1090;&#1072;&#1090;&#1100; &#1089; &#1090;&#1072;&#1082;&#1080;&#1084;&#1080;
&#1072;&#1073;&#1089;&#1090;&#1088;&#1072;&#1082;&#1094;&#1080;&#1103;&#1084;&#1080;. &#1044;&#1074;&#1072; &#1089;&#1090;&#1072;&#1085;&#1076;&#1072;&#1088;&#1090;&#1085;&#1099;&#1093; &#1090;&#1088;&#1072;&#1085;&#1089;&#1092;&#1086;&#1088;&#1084;&#1077;&#1088;&#1072; &#1080;&#1079; <code>sklearn</code> &#1076;&#1083;&#1103; &#1088;&#1072;&#1073;&#1086;&#1090;&#1099; &#1089;
&#1082;&#1072;&#1090;&#1077;&#1075;&#1086;&#1088;&#1080;&#1072;&#1083;&#1100;&#1085;&#1099;&#1084;&#1080; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1072;&#1084;&#1080;

<ul>
<li> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html" target="_self"><tt>LabelEncoder</tt></a> &#1087;&#1088;&#1086;&#1089;&#1090;&#1086; &#1087;&#1077;&#1088;&#1077;&#1085;&#1091;&#1084;&#1077;&#1088;&#1086;&#1074;&#1099;&#1074;&#1072;&#1077;&#1090; &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1103; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1072; &#1085;&#1072;&#1090;&#1091;&#1088;&#1072;&#1083;&#1100;&#1085;&#1099;&#1084;&#1080; &#1095;&#1080;&#1089;&#1083;&#1072;&#1084;&#1080;</li>
<li> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html" target="_self"><tt>OneHotEncoder</tt></a> &#1089;&#1090;&#1072;&#1074;&#1080;&#1090; &#1074; &#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1080;&#1077; &#1082;&#1072;&#1078;&#1076;&#1086;&#1084;&#1091; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1091; &#1094;&#1077;&#1083;&#1099;&#1081; &#1074;&#1077;&#1082;&#1090;&#1086;&#1088;, &#1089;&#1086;&#1089;&#1090;&#1086;&#1103;&#1097;&#1080;&#1081; &#1080;&#1079; &#1085;&#1091;&#1083;&#1077;&#1081; &#1080; &#1086;&#1076;&#1085;&#1086;&#1081; &#1077;&#1076;&#1080;&#1085;&#1080;&#1094;&#1099; (&#1082;&#1086;&#1090;&#1086;&#1088;&#1072;&#1103; &#1089;&#1090;&#1086;&#1080;&#1090; &#1085;&#1072; &#1084;&#1077;&#1089;&#1090;&#1077;, &#1089;&#1086;&#1086;&#1090;&#1074;&#1077;&#1090;&#1089;&#1090;&#1074;&#1091;&#1102;&#1097;&#1077;&#1084; &#1087;&#1088;&#1080;&#1085;&#1080;&#1084;&#1072;&#1077;&#1084;&#1086;&#1084;&#1091; &#1079;&#1085;&#1072;&#1095;&#1077;&#1085;&#1080;&#1102;, &#1090;&#1072;&#1082;&#1080;&#1084; &#1086;&#1073;&#1088;&#1072;&#1079;&#1086;&#1084; &#1082;&#1086;&#1076;&#1080;&#1088;&#1091;&#1103; &#1077;&#1075;&#1086;).</li>
</ul>

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.preprocessing</span> <span style="color: #008000; font-weight: bold">import</span> OneHotEncoder
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.compose</span> <span style="color: #008000; font-weight: bold">import</span> ColumnTransformer

column_transformer <span style="color: #666666">=</span> ColumnTransformer([
    (<span style="color: #BA2121">&#39;ohe&#39;</span>, OneHotEncoder(handle_unknown<span style="color: #666666">=</span><span style="color: #BA2121">&quot;ignore&quot;</span>), categorical),
    (<span style="color: #BA2121">&#39;scaling&#39;</span>, StandardScaler(), numeric_features)
])

pipeline <span style="color: #666666">=</span> Pipeline(steps<span style="color: #666666">=</span>[
    (<span style="color: #BA2121">&#39;ohe_and_scaling&#39;</span>, column_transformer),
    (<span style="color: #BA2121">&#39;regression&#39;</span>, Ridge())
])

model <span style="color: #666666">=</span> pipeline<span style="color: #666666">.</span>fit(X_train, y_train)
y_pred <span style="color: #666666">=</span> model<span style="color: #666666">.</span>predict(X_test)
<span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Test RMSE = </span><span style="color: #BB6688; font-weight: bold">%.4f</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> rmse(y_test, y_pred))
</pre></div>
<p>
&#1055;&#1086;&#1089;&#1084;&#1086;&#1090;&#1088;&#1080;&#1084; &#1085;&#1072; &#1088;&#1072;&#1079;&#1084;&#1077;&#1088;&#1099; &#1084;&#1072;&#1090;&#1088;&#1080;&#1094;&#1099; &#1087;&#1086;&#1089;&#1083;&#1077; OneHot-&#1082;&#1086;&#1076;&#1080;&#1088;&#1086;&#1074;&#1072;&#1085;&#1080;&#1103;:
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Size before OneHot:&quot;</span>, X_train<span style="color: #666666">.</span>shape)
<span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Size after OneHot:&quot;</span>, column_transformer<span style="color: #666666">.</span>transform(X_train)<span style="color: #666666">.</span>shape)
</pre></div>
<p>
&#1050;&#1072;&#1082; &#1074;&#1080;&#1076;&#1080;&#1084;, &#1082;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1086;&#1074; &#1091;&#1074;&#1077;&#1083;&#1080;&#1095;&#1080;&#1083;&#1086;&#1089;&#1100; &#1073;&#1086;&#1083;&#1077;&#1077;, &#1095;&#1077;&#1084; &#1074; 3 &#1088;&#1072;&#1079;&#1072;. &#1069;&#1090;&#1086;
&#1084;&#1086;&#1078;&#1077;&#1090; &#1087;&#1086;&#1074;&#1099;&#1089;&#1080;&#1090;&#1100; &#1088;&#1080;&#1089;&#1082;&#1080; &#1087;&#1077;&#1088;&#1077;&#1086;&#1073;&#1091;&#1095;&#1080;&#1090;&#1100;&#1089;&#1103;: &#1089;&#1086;&#1086;&#1090;&#1085;&#1086;&#1096;&#1077;&#1085;&#1080;&#1077; &#1082;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1072; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1086;&#1074; &#1082;
&#1082;&#1086;&#1083;&#1080;&#1095;&#1077;&#1089;&#1090;&#1074;&#1091; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1086;&#1074; &#1089;&#1080;&#1083;&#1100;&#1085;&#1086; &#1089;&#1086;&#1082;&#1088;&#1072;&#1090;&#1080;&#1083;&#1086;&#1089;&#1100;.

<p>
&#1055;&#1086;&#1087;&#1099;&#1090;&#1072;&#1077;&#1084;&#1089;&#1103; &#1086;&#1073;&#1091;&#1095;&#1080;&#1090;&#1100; &#1083;&#1080;&#1085;&#1077;&#1081;&#1085;&#1091;&#1102; &#1088;&#1077;&#1075;&#1088;&#1077;&#1089;&#1089;&#1080;&#1102; &#1089; \( \ell_1 \)-&#1088;&#1077;&#1075;&#1091;&#1083;&#1103;&#1088;&#1080;&#1079;&#1072;&#1090;&#1086;&#1088;&#1086;&#1084;. &#1053;&#1072;
&#1083;&#1077;&#1082;&#1094;&#1080;&#1103;&#1093; &#1074;&#1099; &#1091;&#1079;&#1085;&#1072;&#1077;&#1090;&#1077;, &#1095;&#1090;&#1086; \( \ell_1 \)-&#1088;&#1077;&#1075;&#1091;&#1083;&#1103;&#1088;&#1080;&#1079;&#1072;&#1090;&#1086;&#1088; &#1088;&#1072;&#1079;&#1088;&#1077;&#1078;&#1080;&#1074;&#1072;&#1077;&#1090; &#1087;&#1088;&#1080;&#1079;&#1085;&#1072;&#1082;&#1086;&#1074;&#1086;&#1077;
&#1087;&#1088;&#1086;&#1089;&#1090;&#1088;&#1072;&#1085;&#1089;&#1090;&#1074;&#1086;, &#1080;&#1085;&#1099;&#1084;&#1080; &#1089;&#1083;&#1086;&#1074;&#1072;&#1084;&#1080;, &#1090;&#1072;&#1082;&#1072;&#1103; &#1084;&#1086;&#1076;&#1077;&#1083;&#1100; &#1079;&#1072;&#1085;&#1091;&#1083;&#1103;&#1077;&#1090; &#1095;&#1072;&#1089;&#1090;&#1100; &#1074;&#1077;&#1089;&#1086;&#1074;.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">sklearn.linear_model</span> <span style="color: #008000; font-weight: bold">import</span> Lasso

column_transformer <span style="color: #666666">=</span> ColumnTransformer([
    (<span style="color: #BA2121">&#39;ohe&#39;</span>, OneHotEncoder(handle_unknown<span style="color: #666666">=</span><span style="color: #BA2121">&quot;ignore&quot;</span>), categorical),
    (<span style="color: #BA2121">&#39;scaling&#39;</span>, StandardScaler(), numeric_features)
])

lasso_pipeline <span style="color: #666666">=</span> Pipeline(steps<span style="color: #666666">=</span>[
    (<span style="color: #BA2121">&#39;ohe_and_scaling&#39;</span>, column_transformer),
    (<span style="color: #BA2121">&#39;regression&#39;</span>, Lasso())
])

model <span style="color: #666666">=</span> lasso_pipeline<span style="color: #666666">.</span>fit(X_train, y_train)
y_pred <span style="color: #666666">=</span> model<span style="color: #666666">.</span>predict(X_test)
<span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;RMSE = </span><span style="color: #BB6688; font-weight: bold">%.4f</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> rmse(y_test, y_pred))
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>ridge_zeros <span style="color: #666666">=</span> np<span style="color: #666666">.</span>sum(pipeline<span style="color: #666666">.</span>steps[<span style="color: #666666">-1</span>][<span style="color: #666666">-1</span>]<span style="color: #666666">.</span>coef_ <span style="color: #666666">==</span> <span style="color: #666666">0</span>)
lasso_zeros <span style="color: #666666">=</span> np<span style="color: #666666">.</span>sum(lasso_pipeline<span style="color: #666666">.</span>steps[<span style="color: #666666">-1</span>][<span style="color: #666666">-1</span>]<span style="color: #666666">.</span>coef_ <span style="color: #666666">==</span> <span style="color: #666666">0</span>)
<span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Zero weights in Ridge:&quot;</span>, ridge_zeros)
<span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Zero weights in Lasso:&quot;</span>, lasso_zeros)
</pre></div>
<p>
&#1055;&#1086;&#1076;&#1073;&#1077;&#1088;&#1077;&#1084; &#1076;&#1083;&#1103; &#1085;&#1072;&#1096;&#1077;&#1081; &#1084;&#1086;&#1076;&#1077;&#1083;&#1080; &#1086;&#1087;&#1090;&#1080;&#1084;&#1072;&#1083;&#1100;&#1085;&#1099;&#1081; &#1082;&#1086;&#1101;&#1092;&#1092;&#1080;&#1094;&#1080;&#1077;&#1085;&#1090;
&#1088;&#1077;&#1075;&#1091;&#1083;&#1103;&#1088;&#1080;&#1079;&#1072;&#1094;&#1080;&#1080;. &#1054;&#1073;&#1088;&#1072;&#1090;&#1080;&#1090;&#1077; &#1074;&#1085;&#1080;&#1084;&#1072;&#1085;&#1080;&#1077;, &#1082;&#1072;&#1082; &#1087;&#1077;&#1088;&#1077;&#1073;&#1080;&#1088;&#1072;&#1102;&#1090;&#1089;&#1103; &#1087;&#1072;&#1088;&#1072;&#1084;&#1077;&#1090;&#1088;&#1099; &#1091;
<code>Pipeline</code>.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>alphas <span style="color: #666666">=</span> np<span style="color: #666666">.</span>logspace(<span style="color: #666666">-2</span>, <span style="color: #666666">4</span>, <span style="color: #666666">20</span>)
searcher <span style="color: #666666">=</span> GridSearchCV(lasso_pipeline, [{<span style="color: #BA2121">&quot;regression__alpha&quot;</span>: alphas}], scoring<span style="color: #666666">=</span>rmse_scorer, cv<span style="color: #666666">=10</span>)
searcher<span style="color: #666666">.</span>fit(X_train, y_train)

best_alpha <span style="color: #666666">=</span> searcher<span style="color: #666666">.</span>best_params_[<span style="color: #BA2121">&quot;regression__alpha&quot;</span>]
<span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Best alpha = </span><span style="color: #BB6688; font-weight: bold">%.4f</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> best_alpha)

plt<span style="color: #666666">.</span>plot(alphas, <span style="color: #666666">-</span>searcher<span style="color: #666666">.</span>cv_results_[<span style="color: #BA2121">&quot;mean_test_score&quot;</span>])
plt<span style="color: #666666">.</span>xscale(<span style="color: #BA2121">&quot;log&quot;</span>)
plt<span style="color: #666666">.</span>xlabel(<span style="color: #BA2121">&quot;alpha&quot;</span>)
plt<span style="color: #666666">.</span>ylabel(<span style="color: #BA2121">&quot;CV score&quot;</span>)
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>column_transformer <span style="color: #666666">=</span> ColumnTransformer([
    (<span style="color: #BA2121">&#39;ohe&#39;</span>, OneHotEncoder(handle_unknown<span style="color: #666666">=</span><span style="color: #BA2121">&quot;ignore&quot;</span>), categorical),
    (<span style="color: #BA2121">&#39;scaling&#39;</span>, StandardScaler(), numeric_features)
])

pipeline <span style="color: #666666">=</span> Pipeline(steps<span style="color: #666666">=</span>[
    (<span style="color: #BA2121">&#39;ohe_and_scaling&#39;</span>, column_transformer),
    (<span style="color: #BA2121">&#39;regression&#39;</span>, Lasso(best_alpha))
])

model <span style="color: #666666">=</span> pipeline<span style="color: #666666">.</span>fit(X_train, y_train)
y_pred <span style="color: #666666">=</span> model<span style="color: #666666">.</span>predict(X_test)
<span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Test RMSE = </span><span style="color: #BB6688; font-weight: bold">%.4f</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> rmse(y_test, y_pred))
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>lasso_zeros <span style="color: #666666">=</span> np<span style="color: #666666">.</span>sum(pipeline<span style="color: #666666">.</span>steps[<span style="color: #666666">-1</span>][<span style="color: #666666">-1</span>]<span style="color: #666666">.</span>coef_ <span style="color: #666666">==</span> <span style="color: #666666">0</span>)
<span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Zero weights in Lasso:&quot;</span>, lasso_zeros)
</pre></div>
<p>
&#1048;&#1085;&#1086;&#1075;&#1076;&#1072; &#1086;&#1095;&#1077;&#1085;&#1100; &#1087;&#1086;&#1083;&#1077;&#1079;&#1085;&#1086; &#1087;&#1086;&#1089;&#1084;&#1086;&#1090;&#1088;&#1077;&#1090;&#1100; &#1085;&#1072; &#1088;&#1072;&#1089;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1080;&#1077; &#1086;&#1089;&#1090;&#1072;&#1090;&#1082;&#1086;&#1074;. &#1053;&#1072;&#1088;&#1080;&#1089;&#1091;&#1077;&#1084;
&#1075;&#1080;&#1089;&#1090;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1091; &#1088;&#1072;&#1089;&#1087;&#1088;&#1077;&#1076;&#1077;&#1083;&#1077;&#1085;&#1080;&#1103; &#1082;&#1074;&#1072;&#1076;&#1088;&#1072;&#1090;&#1080;&#1095;&#1085;&#1086;&#1081; &#1086;&#1096;&#1080;&#1073;&#1082;&#1080; &#1085;&#1072; &#1086;&#1073;&#1091;&#1095;&#1072;&#1102;&#1097;&#1080;&#1093; &#1086;&#1073;&#1098;&#1077;&#1082;&#1090;&#1072;&#1093;:
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>error <span style="color: #666666">=</span> (y_train <span style="color: #666666">-</span> model<span style="color: #666666">.</span>predict(X_train)) <span style="color: #666666">**</span> <span style="color: #666666">2</span>
sns<span style="color: #666666">.</span>distplot(error)
</pre></div>
<p>
&#1050;&#1072;&#1082; &#1074;&#1080;&#1076;&#1085;&#1086; &#1080;&#1079; &#1075;&#1080;&#1089;&#1090;&#1086;&#1075;&#1088;&#1072;&#1084;&#1084;&#1099;, &#1077;&#1089;&#1090;&#1100; &#1087;&#1088;&#1080;&#1084;&#1077;&#1088;&#1099; &#1089; &#1086;&#1095;&#1077;&#1085;&#1100; &#1073;&#1086;&#1083;&#1100;&#1096;&#1080;&#1084;&#1080;
&#1086;&#1089;&#1090;&#1072;&#1090;&#1082;&#1072;&#1084;&#1080;. &#1055;&#1086;&#1087;&#1088;&#1086;&#1073;&#1091;&#1077;&#1084; &#1080;&#1093; &#1074;&#1099;&#1073;&#1088;&#1086;&#1089;&#1080;&#1090;&#1100; &#1080;&#1079; &#1086;&#1073;&#1091;&#1095;&#1072;&#1102;&#1097;&#1077;&#1081; &#1074;&#1099;&#1073;&#1086;&#1088;&#1082;&#1080;. &#1053;&#1072;&#1087;&#1088;&#1080;&#1084;&#1077;&#1088;,
&#1074;&#1099;&#1073;&#1088;&#1086;&#1089;&#1080;&#1084; &#1087;&#1088;&#1080;&#1084;&#1077;&#1088;&#1099;, &#1086;&#1089;&#1090;&#1072;&#1090;&#1086;&#1082; &#1091; &#1082;&#1086;&#1090;&#1086;&#1088;&#1099;&#1093; &#1073;&#1086;&#1083;&#1100;&#1096;&#1077; 0.95-&#1082;&#1074;&#1072;&#1085;&#1090;&#1080;&#1083;&#1080;.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>mask <span style="color: #666666">=</span> (error <span style="color: #666666">&lt;</span> np<span style="color: #666666">.</span>quantile(error, <span style="color: #666666">0.95</span>))
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>column_transformer <span style="color: #666666">=</span> ColumnTransformer([
    (<span style="color: #BA2121">&#39;ohe&#39;</span>, OneHotEncoder(handle_unknown<span style="color: #666666">=</span><span style="color: #BA2121">&quot;ignore&quot;</span>), categorical),
    (<span style="color: #BA2121">&#39;scaling&#39;</span>, StandardScaler(), numeric_features)
])

pipeline <span style="color: #666666">=</span> Pipeline(steps<span style="color: #666666">=</span>[
    (<span style="color: #BA2121">&#39;ohe_and_scaling&#39;</span>, column_transformer),
    (<span style="color: #BA2121">&#39;regression&#39;</span>, Lasso(best_alpha))
])

model <span style="color: #666666">=</span> pipeline<span style="color: #666666">.</span>fit(X_train[mask], y_train[mask])
y_pred <span style="color: #666666">=</span> model<span style="color: #666666">.</span>predict(X_test)
<span style="color: #008000">print</span>(<span style="color: #BA2121">&quot;Test RMSE = </span><span style="color: #BB6688; font-weight: bold">%.4f</span><span style="color: #BA2121">&quot;</span> <span style="color: #666666">%</span> rmse(y_test, y_pred))
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>X_train <span style="color: #666666">=</span> X_train[mask]
y_train <span style="color: #666666">=</span> y_train[mask]
</pre></div>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>error <span style="color: #666666">=</span> (y_train <span style="color: #666666">-</span> model<span style="color: #666666">.</span>predict(X_train)) <span style="color: #666666">**</span> <span style="color: #666666">2</span>
sns<span style="color: #666666">.</span>distplot(error)
</pre></div>
<p>
&#1042;&#1080;&#1076;&#1080;&#1084;, &#1095;&#1090;&#1086; &#1082;&#1072;&#1095;&#1077;&#1089;&#1090;&#1074;&#1086; &#1084;&#1086;&#1076;&#1077;&#1083;&#1080; &#1079;&#1072;&#1084;&#1077;&#1090;&#1085;&#1086; &#1091;&#1083;&#1091;&#1095;&#1096;&#1080;&#1083;&#1086;&#1089;&#1100;! &#1058;&#1072;&#1082;&#1078;&#1077; &#1073;&#1099;&#1074;&#1072;&#1077;&#1090; &#1086;&#1095;&#1077;&#1085;&#1100;
&#1087;&#1086;&#1083;&#1077;&#1079;&#1085;&#1086; &#1087;&#1086;&#1089;&#1084;&#1086;&#1090;&#1088;&#1077;&#1090;&#1100; &#1085;&#1072; &#1087;&#1088;&#1080;&#1084;&#1077;&#1088;&#1099; &#1089; &#1073;&#1086;&#1083;&#1100;&#1096;&#1080;&#1084;&#1080; &#1086;&#1089;&#1090;&#1072;&#1090;&#1082;&#1072;&#1084;&#1080; &#1080; &#1087;&#1086;&#1087;&#1099;&#1090;&#1072;&#1090;&#1100;&#1089;&#1103;
&#1087;&#1086;&#1085;&#1103;&#1090;&#1100;, &#1087;&#1086;&#1095;&#1077;&#1084;&#1091; &#1078;&#1077; &#1084;&#1086;&#1076;&#1077;&#1083;&#1100; &#1085;&#1072; &#1085;&#1080;&#1093; &#1090;&#1072;&#1082; &#1089;&#1080;&#1083;&#1100;&#1085;&#1086; &#1086;&#1096;&#1080;&#1073;&#1072;&#1077;&#1090;&#1089;&#1103;: &#1101;&#1090;&#1086; &#1084;&#1086;&#1078;&#1077;&#1090; &#1076;&#1072;&#1090;&#1100;
&#1087;&#1086;&#1085;&#1080;&#1084;&#1072;&#1085;&#1080;&#1077;, &#1082;&#1072;&#1082; &#1084;&#1086;&#1076;&#1077;&#1083;&#1100; &#1084;&#1086;&#1078;&#1085;&#1086; &#1091;&#1083;&#1091;&#1095;&#1096;&#1080;&#1090;&#1100;.

<p>
<!-- Local Variables: -->
<!-- doconce-chapter-nickname: "ml" -->
<!-- doconce-section-nickname: "linear-regression" -->
<!-- End: -->

<p>
<p>
<!-- navigation buttons at the bottom of the page -->
<ul class="pager">

  <li class="previous">
    <a href="._ml-flatly001.html">&larr; Prev</a>
  </li>

  <li class="next">
    <a href="._ml-flatly003.html">Next &rarr;</a>
  </li>
</ul>
<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="http://..."><img width="250" align=right src="http://..."></a>
</footer>
-->


</body>
</html>
    

